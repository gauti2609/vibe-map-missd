(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function TE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vv={exports:{}},$u={},Lv={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fl=Symbol.for("react.element"),SE=Symbol.for("react.portal"),kE=Symbol.for("react.fragment"),CE=Symbol.for("react.strict_mode"),AE=Symbol.for("react.profiler"),jE=Symbol.for("react.provider"),RE=Symbol.for("react.context"),PE=Symbol.for("react.forward_ref"),DE=Symbol.for("react.suspense"),ME=Symbol.for("react.memo"),OE=Symbol.for("react.lazy"),h0=Symbol.iterator;function VE(t){return t===null||typeof t!="object"?null:(t=h0&&t[h0]||t["@@iterator"],typeof t=="function"?t:null)}var Fv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uv=Object.assign,$v={};function So(t,e,n){this.props=t,this.context=e,this.refs=$v,this.updater=n||Fv}So.prototype.isReactComponent={};So.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};So.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zv(){}zv.prototype=So.prototype;function pm(t,e,n){this.props=t,this.context=e,this.refs=$v,this.updater=n||Fv}var gm=pm.prototype=new zv;gm.constructor=pm;Uv(gm,So.prototype);gm.isPureReactComponent=!0;var f0=Array.isArray,Bv=Object.prototype.hasOwnProperty,xm={current:null},qv={key:!0,ref:!0,__self:!0,__source:!0};function Hv(t,e,n){var s,r={},i=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Bv.call(e,s)&&!qv.hasOwnProperty(s)&&(r[s]=e[s]);var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}if(t&&t.defaultProps)for(s in c=t.defaultProps,c)r[s]===void 0&&(r[s]=c[s]);return{$$typeof:fl,type:t,key:i,ref:a,props:r,_owner:xm.current}}function LE(t,e){return{$$typeof:fl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ym(t){return typeof t=="object"&&t!==null&&t.$$typeof===fl}function FE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var m0=/\/+/g;function Qd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?FE(""+t.key):e.toString(36)}function _c(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case fl:case SE:a=!0}}if(a)return a=t,r=r(a),t=s===""?"."+Qd(a,0):s,f0(r)?(n="",t!=null&&(n=t.replace(m0,"$&/")+"/"),_c(r,e,n,"",function(d){return d})):r!=null&&(ym(r)&&(r=LE(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(m0,"$&/")+"/")+t)),e.push(r)),1;if(a=0,s=s===""?".":s+":",f0(t))for(var c=0;c<t.length;c++){i=t[c];var u=s+Qd(i,c);a+=_c(i,e,n,u,r)}else if(u=VE(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=s+Qd(i,c++),a+=_c(i,e,n,u,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Yl(t,e,n){if(t==null)return t;var s=[],r=0;return _c(t,s,"","",function(i){return e.call(n,i,r++)}),s}function UE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wt={current:null},Nc={transition:null},$E={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:Nc,ReactCurrentOwner:xm};function Gv(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Yl,forEach:function(t,e,n){Yl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Yl(t,function(){e++}),e},toArray:function(t){return Yl(t,function(e){return e})||[]},only:function(t){if(!ym(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=So;Ie.Fragment=kE;Ie.Profiler=AE;Ie.PureComponent=pm;Ie.StrictMode=CE;Ie.Suspense=DE;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$E;Ie.act=Gv;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=Uv({},t.props),r=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=xm.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Bv.call(e,u)&&!qv.hasOwnProperty(u)&&(s[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];s.children=c}return{$$typeof:fl,type:t.type,key:r,ref:i,props:s,_owner:a}};Ie.createContext=function(t){return t={$$typeof:RE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jE,_context:t},t.Consumer=t};Ie.createElement=Hv;Ie.createFactory=function(t){var e=Hv.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:PE,render:t}};Ie.isValidElement=ym;Ie.lazy=function(t){return{$$typeof:OE,_payload:{_status:-1,_result:t},_init:UE}};Ie.memo=function(t,e){return{$$typeof:ME,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=Nc.transition;Nc.transition={};try{t()}finally{Nc.transition=e}};Ie.unstable_act=Gv;Ie.useCallback=function(t,e){return Wt.current.useCallback(t,e)};Ie.useContext=function(t){return Wt.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return Wt.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return Wt.current.useEffect(t,e)};Ie.useId=function(){return Wt.current.useId()};Ie.useImperativeHandle=function(t,e,n){return Wt.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return Wt.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return Wt.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return Wt.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return Wt.current.useReducer(t,e,n)};Ie.useRef=function(t){return Wt.current.useRef(t)};Ie.useState=function(t){return Wt.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return Wt.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return Wt.current.useTransition()};Ie.version="18.3.1";Lv.exports=Ie;var A=Lv.exports;const ml=TE(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zE=A,BE=Symbol.for("react.element"),qE=Symbol.for("react.fragment"),HE=Object.prototype.hasOwnProperty,GE=zE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WE={key:!0,ref:!0,__self:!0,__source:!0};function Wv(t,e,n){var s,r={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)HE.call(e,s)&&!WE.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:BE,type:t,key:i,ref:a,props:r,_owner:GE.current}}$u.Fragment=qE;$u.jsx=Wv;$u.jsxs=Wv;Vv.exports=$u;var o=Vv.exports,$h={},Kv={exports:{}},pn={},Qv={exports:{}},Yv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,J){var H=$.length;$.push(J);e:for(;0<H;){var ue=H-1>>>1,me=$[ue];if(0<r(me,J))$[ue]=J,$[H]=me,H=ue;else break e}}function n($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var J=$[0],H=$.pop();if(H!==J){$[0]=H;e:for(var ue=0,me=$.length,je=me>>>1;ue<je;){var Te=2*(ue+1)-1,ae=$[Te],O=Te+1,K=$[O];if(0>r(ae,H))O<me&&0>r(K,ae)?($[ue]=K,$[O]=H,ue=O):($[ue]=ae,$[Te]=H,ue=Te);else if(O<me&&0>r(K,H))$[ue]=K,$[O]=H,ue=O;else break e}}return J}function r($,J){var H=$.sortIndex-J.sortIndex;return H!==0?H:$.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],f=1,m=null,p=3,y=!1,T=!1,C=!1,P=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S($){for(var J=n(d);J!==null;){if(J.callback===null)s(d);else if(J.startTime<=$)s(d),J.sortIndex=J.expirationTime,e(u,J);else break;J=n(d)}}function R($){if(C=!1,S($),!T)if(n(u)!==null)T=!0,Ne(L);else{var J=n(d);J!==null&&de(R,J.startTime-$)}}function L($,J){T=!1,C&&(C=!1,b(x),x=-1),y=!0;var H=p;try{for(S(J),m=n(u);m!==null&&(!(m.expirationTime>J)||$&&!k());){var ue=m.callback;if(typeof ue=="function"){m.callback=null,p=m.priorityLevel;var me=ue(m.expirationTime<=J);J=t.unstable_now(),typeof me=="function"?m.callback=me:m===n(u)&&s(u),S(J)}else s(u);m=n(u)}if(m!==null)var je=!0;else{var Te=n(d);Te!==null&&de(R,Te.startTime-J),je=!1}return je}finally{m=null,p=H,y=!1}}var U=!1,N=null,x=-1,v=5,_=-1;function k(){return!(t.unstable_now()-_<v)}function j(){if(N!==null){var $=t.unstable_now();_=$;var J=!0;try{J=N(!0,$)}finally{J?I():(U=!1,N=null)}}else U=!1}var I;if(typeof E=="function")I=function(){E(j)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ne=ee.port2;ee.port1.onmessage=j,I=function(){ne.postMessage(null)}}else I=function(){P(j,0)};function Ne($){N=$,U||(U=!0,I())}function de($,J){x=P(function(){$(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){T||y||(T=!0,Ne(L))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(p){case 1:case 2:case 3:var J=3;break;default:J=p}var H=p;p=J;try{return $()}finally{p=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,J){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var H=p;p=$;try{return J()}finally{p=H}},t.unstable_scheduleCallback=function($,J,H){var ue=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ue+H:ue):H=ue,$){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=H+me,$={id:f++,callback:J,priorityLevel:$,startTime:H,expirationTime:me,sortIndex:-1},H>ue?($.sortIndex=H,e(d,$),n(u)===null&&$===n(d)&&(C?(b(x),x=-1):C=!0,de(R,H-ue))):($.sortIndex=me,e(u,$),T||y||(T=!0,Ne(L))),$},t.unstable_shouldYield=k,t.unstable_wrapCallback=function($){var J=p;return function(){var H=p;p=J;try{return $.apply(this,arguments)}finally{p=H}}}})(Yv);Qv.exports=Yv;var KE=Qv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QE=A,mn=KE;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xv=new Set,Oa={};function ui(t,e){ro(t,e),ro(t+"Capture",e)}function ro(t,e){for(Oa[t]=e,t=0;t<e.length;t++)Xv.add(e[t])}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zh=Object.prototype.hasOwnProperty,YE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p0={},g0={};function XE(t){return zh.call(g0,t)?!0:zh.call(p0,t)?!1:YE.test(t)?g0[t]=!0:(p0[t]=!0,!1)}function JE(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ZE(t,e,n,s){if(e===null||typeof e>"u"||JE(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kt(t,e,n,s,r,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){At[t]=new Kt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];At[e]=new Kt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){At[t]=new Kt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){At[t]=new Kt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){At[t]=new Kt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){At[t]=new Kt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){At[t]=new Kt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){At[t]=new Kt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){At[t]=new Kt(t,5,!1,t.toLowerCase(),null,!1,!1)});var vm=/[\-:]([a-z])/g;function wm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vm,wm);At[e]=new Kt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vm,wm);At[e]=new Kt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vm,wm);At[e]=new Kt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){At[t]=new Kt(t,1,!1,t.toLowerCase(),null,!1,!1)});At.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){At[t]=new Kt(t,1,!1,t.toLowerCase(),null,!0,!0)});function bm(t,e,n,s){var r=At.hasOwnProperty(e)?At[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ZE(e,n,r,s)&&(n=null),s||r===null?XE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ks=QE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xl=Symbol.for("react.element"),ji=Symbol.for("react.portal"),Ri=Symbol.for("react.fragment"),_m=Symbol.for("react.strict_mode"),Bh=Symbol.for("react.profiler"),Jv=Symbol.for("react.provider"),Zv=Symbol.for("react.context"),Nm=Symbol.for("react.forward_ref"),qh=Symbol.for("react.suspense"),Hh=Symbol.for("react.suspense_list"),Em=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),ew=Symbol.for("react.offscreen"),x0=Symbol.iterator;function ea(t){return t===null||typeof t!="object"?null:(t=x0&&t[x0]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,Yd;function ua(t){if(Yd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Yd=e&&e[1]||""}return`
`+Yd+t}var Xd=!1;function Jd(t,e){if(!t||Xd)return"";Xd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=s.stack.split(`
`),a=r.length-1,c=i.length-1;1<=a&&0<=c&&r[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(r[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||r[a]!==i[c]){var u=`
`+r[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{Xd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ua(t):""}function e2(t){switch(t.tag){case 5:return ua(t.type);case 16:return ua("Lazy");case 13:return ua("Suspense");case 19:return ua("SuspenseList");case 0:case 2:case 15:return t=Jd(t.type,!1),t;case 11:return t=Jd(t.type.render,!1),t;case 1:return t=Jd(t.type,!0),t;default:return""}}function Gh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ri:return"Fragment";case ji:return"Portal";case Bh:return"Profiler";case _m:return"StrictMode";case qh:return"Suspense";case Hh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Zv:return(t.displayName||"Context")+".Consumer";case Jv:return(t._context.displayName||"Context")+".Provider";case Nm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Em:return e=t.displayName||null,e!==null?e:Gh(t.type)||"Memo";case Us:e=t._payload,t=t._init;try{return Gh(t(e))}catch{}}return null}function t2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gh(e);case 8:return e===_m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function tw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function n2(t){var e=tw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){s=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jl(t){t._valueTracker||(t._valueTracker=n2(t))}function nw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=tw(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Wc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wh(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function y0(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=hr(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sw(t,e){e=e.checked,e!=null&&bm(t,"checked",e,!1)}function Kh(t,e){sw(t,e);var n=hr(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Qh(t,e.type,hr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function v0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Qh(t,e,n){(e!=="number"||Wc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var da=Array.isArray;function qi(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+hr(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Yh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function w0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(da(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hr(n)}}function rw(t,e){var n=hr(e.value),s=hr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function b0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function iw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?iw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zl,ow=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zl=Zl||document.createElement("div"),Zl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Va(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var va={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},s2=["Webkit","ms","Moz","O"];Object.keys(va).forEach(function(t){s2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),va[e]=va[t]})});function aw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||va.hasOwnProperty(t)&&va[t]?(""+e).trim():e+"px"}function lw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=aw(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var r2=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jh(t,e){if(e){if(r2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Zh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ef=null;function Im(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tf=null,Hi=null,Gi=null;function _0(t){if(t=xl(t)){if(typeof tf!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Gu(e),tf(t.stateNode,t.type,e))}}function cw(t){Hi?Gi?Gi.push(t):Gi=[t]:Hi=t}function uw(){if(Hi){var t=Hi,e=Gi;if(Gi=Hi=null,_0(t),e)for(t=0;t<e.length;t++)_0(e[t])}}function dw(t,e){return t(e)}function hw(){}var Zd=!1;function fw(t,e,n){if(Zd)return t(e,n);Zd=!0;try{return dw(t,e,n)}finally{Zd=!1,(Hi!==null||Gi!==null)&&(hw(),uw())}}function La(t,e){var n=t.stateNode;if(n===null)return null;var s=Gu(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var nf=!1;if(vs)try{var ta={};Object.defineProperty(ta,"passive",{get:function(){nf=!0}}),window.addEventListener("test",ta,ta),window.removeEventListener("test",ta,ta)}catch{nf=!1}function i2(t,e,n,s,r,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var wa=!1,Kc=null,Qc=!1,sf=null,o2={onError:function(t){wa=!0,Kc=t}};function a2(t,e,n,s,r,i,a,c,u){wa=!1,Kc=null,i2.apply(o2,arguments)}function l2(t,e,n,s,r,i,a,c,u){if(a2.apply(this,arguments),wa){if(wa){var d=Kc;wa=!1,Kc=null}else throw Error(W(198));Qc||(Qc=!0,sf=d)}}function di(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function N0(t){if(di(t)!==t)throw Error(W(188))}function c2(t){var e=t.alternate;if(!e){if(e=di(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return N0(r),t;if(i===s)return N0(r),e;i=i.sibling}throw Error(W(188))}if(n.return!==s.return)n=r,s=i;else{for(var a=!1,c=r.child;c;){if(c===n){a=!0,n=r,s=i;break}if(c===s){a=!0,s=r,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,s=r;break}if(c===s){a=!0,s=i,n=r;break}c=c.sibling}if(!a)throw Error(W(189))}}if(n.alternate!==s)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function pw(t){return t=c2(t),t!==null?gw(t):null}function gw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gw(t);if(e!==null)return e;t=t.sibling}return null}var xw=mn.unstable_scheduleCallback,E0=mn.unstable_cancelCallback,u2=mn.unstable_shouldYield,d2=mn.unstable_requestPaint,ut=mn.unstable_now,h2=mn.unstable_getCurrentPriorityLevel,Tm=mn.unstable_ImmediatePriority,yw=mn.unstable_UserBlockingPriority,Yc=mn.unstable_NormalPriority,f2=mn.unstable_LowPriority,vw=mn.unstable_IdlePriority,zu=null,Qn=null;function m2(t){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(zu,t,void 0,(t.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:x2,p2=Math.log,g2=Math.LN2;function x2(t){return t>>>=0,t===0?32:31-(p2(t)/g2|0)|0}var ec=64,tc=4194304;function ha(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xc(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~r;c!==0?s=ha(c):(i&=a,i!==0&&(s=ha(i)))}else a=n&~r,a!==0?s=ha(a):i!==0&&(s=ha(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Pn(e),r=1<<n,s|=t[n],e&=~r;return s}function y2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v2(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Pn(i),c=1<<a,u=r[a];u===-1?(!(c&n)||c&s)&&(r[a]=y2(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function rf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ww(){var t=ec;return ec<<=1,!(ec&4194240)&&(ec=64),t}function eh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pn(e),t[e]=n}function w2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Pn(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function Sm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Pn(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Fe=0;function bw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _w,km,Nw,Ew,Iw,of=!1,nc=[],Xs=null,Js=null,Zs=null,Fa=new Map,Ua=new Map,Bs=[],b2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function I0(t,e){switch(t){case"focusin":case"focusout":Xs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Fa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ua.delete(e.pointerId)}}function na(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=xl(e),e!==null&&km(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function _2(t,e,n,s,r){switch(e){case"focusin":return Xs=na(Xs,t,e,n,s,r),!0;case"dragenter":return Js=na(Js,t,e,n,s,r),!0;case"mouseover":return Zs=na(Zs,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return Fa.set(i,na(Fa.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Ua.set(i,na(Ua.get(i)||null,t,e,n,s,r)),!0}return!1}function Tw(t){var e=Fr(t.target);if(e!==null){var n=di(e);if(n!==null){if(e=n.tag,e===13){if(e=mw(n),e!==null){t.blockedOn=e,Iw(t.priority,function(){Nw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ec(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=af(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);ef=s,n.target.dispatchEvent(s),ef=null}else return e=xl(n),e!==null&&km(e),t.blockedOn=n,!1;e.shift()}return!0}function T0(t,e,n){Ec(t)&&n.delete(e)}function N2(){of=!1,Xs!==null&&Ec(Xs)&&(Xs=null),Js!==null&&Ec(Js)&&(Js=null),Zs!==null&&Ec(Zs)&&(Zs=null),Fa.forEach(T0),Ua.forEach(T0)}function sa(t,e){t.blockedOn===e&&(t.blockedOn=null,of||(of=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,N2)))}function $a(t){function e(r){return sa(r,t)}if(0<nc.length){sa(nc[0],t);for(var n=1;n<nc.length;n++){var s=nc[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Xs!==null&&sa(Xs,t),Js!==null&&sa(Js,t),Zs!==null&&sa(Zs,t),Fa.forEach(e),Ua.forEach(e),n=0;n<Bs.length;n++)s=Bs[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Bs.length&&(n=Bs[0],n.blockedOn===null);)Tw(n),n.blockedOn===null&&Bs.shift()}var Wi=ks.ReactCurrentBatchConfig,Jc=!0;function E2(t,e,n,s){var r=Fe,i=Wi.transition;Wi.transition=null;try{Fe=1,Cm(t,e,n,s)}finally{Fe=r,Wi.transition=i}}function I2(t,e,n,s){var r=Fe,i=Wi.transition;Wi.transition=null;try{Fe=4,Cm(t,e,n,s)}finally{Fe=r,Wi.transition=i}}function Cm(t,e,n,s){if(Jc){var r=af(t,e,n,s);if(r===null)uh(t,e,s,Zc,n),I0(t,s);else if(_2(r,t,e,n,s))s.stopPropagation();else if(I0(t,s),e&4&&-1<b2.indexOf(t)){for(;r!==null;){var i=xl(r);if(i!==null&&_w(i),i=af(t,e,n,s),i===null&&uh(t,e,s,Zc,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else uh(t,e,s,null,n)}}var Zc=null;function af(t,e,n,s){if(Zc=null,t=Im(s),t=Fr(t),t!==null)if(e=di(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zc=t,null}function Sw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h2()){case Tm:return 1;case yw:return 4;case Yc:case f2:return 16;case vw:return 536870912;default:return 16}default:return 16}}var Ks=null,Am=null,Ic=null;function kw(){if(Ic)return Ic;var t,e=Am,n=e.length,s,r="value"in Ks?Ks.value:Ks.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===r[i-s];s++);return Ic=r.slice(t,1<s?1-s:void 0)}function Tc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function sc(){return!0}function S0(){return!1}function gn(t){function e(n,s,r,i,a){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sc:S0,this.isPropagationStopped=S0,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sc)},persist:function(){},isPersistent:sc}),e}var ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jm=gn(ko),gl=st({},ko,{view:0,detail:0}),T2=gn(gl),th,nh,ra,Bu=st({},gl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ra&&(ra&&t.type==="mousemove"?(th=t.screenX-ra.screenX,nh=t.screenY-ra.screenY):nh=th=0,ra=t),th)},movementY:function(t){return"movementY"in t?t.movementY:nh}}),k0=gn(Bu),S2=st({},Bu,{dataTransfer:0}),k2=gn(S2),C2=st({},gl,{relatedTarget:0}),sh=gn(C2),A2=st({},ko,{animationName:0,elapsedTime:0,pseudoElement:0}),j2=gn(A2),R2=st({},ko,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),P2=gn(R2),D2=st({},ko,{data:0}),C0=gn(D2),M2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=V2[t])?!!e[t]:!1}function Rm(){return L2}var F2=st({},gl,{key:function(t){if(t.key){var e=M2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?O2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rm,charCode:function(t){return t.type==="keypress"?Tc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),U2=gn(F2),$2=st({},Bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A0=gn($2),z2=st({},gl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rm}),B2=gn(z2),q2=st({},ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),H2=gn(q2),G2=st({},Bu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),W2=gn(G2),K2=[9,13,27,32],Pm=vs&&"CompositionEvent"in window,ba=null;vs&&"documentMode"in document&&(ba=document.documentMode);var Q2=vs&&"TextEvent"in window&&!ba,Cw=vs&&(!Pm||ba&&8<ba&&11>=ba),j0=" ",R0=!1;function Aw(t,e){switch(t){case"keyup":return K2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pi=!1;function Y2(t,e){switch(t){case"compositionend":return jw(e);case"keypress":return e.which!==32?null:(R0=!0,j0);case"textInput":return t=e.data,t===j0&&R0?null:t;default:return null}}function X2(t,e){if(Pi)return t==="compositionend"||!Pm&&Aw(t,e)?(t=kw(),Ic=Am=Ks=null,Pi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cw&&e.locale!=="ko"?null:e.data;default:return null}}var J2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!J2[t.type]:e==="textarea"}function Rw(t,e,n,s){cw(s),e=eu(e,"onChange"),0<e.length&&(n=new jm("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var _a=null,za=null;function Z2(t){Bw(t,0)}function qu(t){var e=Oi(t);if(nw(e))return t}function eI(t,e){if(t==="change")return e}var Pw=!1;if(vs){var rh;if(vs){var ih="oninput"in document;if(!ih){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),ih=typeof D0.oninput=="function"}rh=ih}else rh=!1;Pw=rh&&(!document.documentMode||9<document.documentMode)}function M0(){_a&&(_a.detachEvent("onpropertychange",Dw),za=_a=null)}function Dw(t){if(t.propertyName==="value"&&qu(za)){var e=[];Rw(e,za,t,Im(t)),fw(Z2,e)}}function tI(t,e,n){t==="focusin"?(M0(),_a=e,za=n,_a.attachEvent("onpropertychange",Dw)):t==="focusout"&&M0()}function nI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qu(za)}function sI(t,e){if(t==="click")return qu(e)}function rI(t,e){if(t==="input"||t==="change")return qu(e)}function iI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var On=typeof Object.is=="function"?Object.is:iI;function Ba(t,e){if(On(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!zh.call(e,r)||!On(t[r],e[r]))return!1}return!0}function O0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function V0(t,e){var n=O0(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=O0(n)}}function Mw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Mw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ow(){for(var t=window,e=Wc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wc(t.document)}return e}function Dm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oI(t){var e=Ow(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Mw(n.ownerDocument.documentElement,n)){if(s!==null&&Dm(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=V0(n,i);var a=V0(n,s);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aI=vs&&"documentMode"in document&&11>=document.documentMode,Di=null,lf=null,Na=null,cf=!1;function L0(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cf||Di==null||Di!==Wc(s)||(s=Di,"selectionStart"in s&&Dm(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Na&&Ba(Na,s)||(Na=s,s=eu(lf,"onSelect"),0<s.length&&(e=new jm("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Di)))}function rc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Mi={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionend:rc("Transition","TransitionEnd")},oh={},Vw={};vs&&(Vw=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Hu(t){if(oh[t])return oh[t];if(!Mi[t])return t;var e=Mi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Vw)return oh[t]=e[n];return t}var Lw=Hu("animationend"),Fw=Hu("animationiteration"),Uw=Hu("animationstart"),$w=Hu("transitionend"),zw=new Map,F0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Er(t,e){zw.set(t,e),ui(e,[t])}for(var ah=0;ah<F0.length;ah++){var lh=F0[ah],lI=lh.toLowerCase(),cI=lh[0].toUpperCase()+lh.slice(1);Er(lI,"on"+cI)}Er(Lw,"onAnimationEnd");Er(Fw,"onAnimationIteration");Er(Uw,"onAnimationStart");Er("dblclick","onDoubleClick");Er("focusin","onFocus");Er("focusout","onBlur");Er($w,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uI=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function U0(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,l2(s,e,void 0,t),t.currentTarget=null}function Bw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var a=s.length-1;0<=a;a--){var c=s[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&r.isPropagationStopped())break e;U0(r,c,d),i=u}else for(a=0;a<s.length;a++){if(c=s[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&r.isPropagationStopped())break e;U0(r,c,d),i=u}}}if(Qc)throw t=sf,Qc=!1,sf=null,t}function Qe(t,e){var n=e[mf];n===void 0&&(n=e[mf]=new Set);var s=t+"__bubble";n.has(s)||(qw(e,t,2,!1),n.add(s))}function ch(t,e,n){var s=0;e&&(s|=4),qw(n,t,s,e)}var ic="_reactListening"+Math.random().toString(36).slice(2);function qa(t){if(!t[ic]){t[ic]=!0,Xv.forEach(function(n){n!=="selectionchange"&&(uI.has(n)||ch(n,!1,t),ch(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ic]||(e[ic]=!0,ch("selectionchange",!1,e))}}function qw(t,e,n,s){switch(Sw(e)){case 1:var r=E2;break;case 4:r=I2;break;default:r=Cm}n=r.bind(null,e,n,t),r=void 0,!nf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function uh(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var c=s.stateNode.containerInfo;if(c===r||c.nodeType===8&&c.parentNode===r)break;if(a===4)for(a=s.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===r||u.nodeType===8&&u.parentNode===r))return;a=a.return}for(;c!==null;){if(a=Fr(c),a===null)return;if(u=a.tag,u===5||u===6){s=i=a;continue e}c=c.parentNode}}s=s.return}fw(function(){var d=i,f=Im(n),m=[];e:{var p=zw.get(t);if(p!==void 0){var y=jm,T=t;switch(t){case"keypress":if(Tc(n)===0)break e;case"keydown":case"keyup":y=U2;break;case"focusin":T="focus",y=sh;break;case"focusout":T="blur",y=sh;break;case"beforeblur":case"afterblur":y=sh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=k0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=k2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=B2;break;case Lw:case Fw:case Uw:y=j2;break;case $w:y=H2;break;case"scroll":y=T2;break;case"wheel":y=W2;break;case"copy":case"cut":case"paste":y=P2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=A0}var C=(e&4)!==0,P=!C&&t==="scroll",b=C?p!==null?p+"Capture":null:p;C=[];for(var E=d,S;E!==null;){S=E;var R=S.stateNode;if(S.tag===5&&R!==null&&(S=R,b!==null&&(R=La(E,b),R!=null&&C.push(Ha(E,R,S)))),P)break;E=E.return}0<C.length&&(p=new y(p,T,null,n,f),m.push({event:p,listeners:C}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",p&&n!==ef&&(T=n.relatedTarget||n.fromElement)&&(Fr(T)||T[ws]))break e;if((y||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,y?(T=n.relatedTarget||n.toElement,y=d,T=T?Fr(T):null,T!==null&&(P=di(T),T!==P||T.tag!==5&&T.tag!==6)&&(T=null)):(y=null,T=d),y!==T)){if(C=k0,R="onMouseLeave",b="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(C=A0,R="onPointerLeave",b="onPointerEnter",E="pointer"),P=y==null?p:Oi(y),S=T==null?p:Oi(T),p=new C(R,E+"leave",y,n,f),p.target=P,p.relatedTarget=S,R=null,Fr(f)===d&&(C=new C(b,E+"enter",T,n,f),C.target=S,C.relatedTarget=P,R=C),P=R,y&&T)t:{for(C=y,b=T,E=0,S=C;S;S=Ei(S))E++;for(S=0,R=b;R;R=Ei(R))S++;for(;0<E-S;)C=Ei(C),E--;for(;0<S-E;)b=Ei(b),S--;for(;E--;){if(C===b||b!==null&&C===b.alternate)break t;C=Ei(C),b=Ei(b)}C=null}else C=null;y!==null&&$0(m,p,y,C,!1),T!==null&&P!==null&&$0(m,P,T,C,!0)}}e:{if(p=d?Oi(d):window,y=p.nodeName&&p.nodeName.toLowerCase(),y==="select"||y==="input"&&p.type==="file")var L=eI;else if(P0(p))if(Pw)L=rI;else{L=nI;var U=tI}else(y=p.nodeName)&&y.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=sI);if(L&&(L=L(t,d))){Rw(m,L,n,f);break e}U&&U(t,p,d),t==="focusout"&&(U=p._wrapperState)&&U.controlled&&p.type==="number"&&Qh(p,"number",p.value)}switch(U=d?Oi(d):window,t){case"focusin":(P0(U)||U.contentEditable==="true")&&(Di=U,lf=d,Na=null);break;case"focusout":Na=lf=Di=null;break;case"mousedown":cf=!0;break;case"contextmenu":case"mouseup":case"dragend":cf=!1,L0(m,n,f);break;case"selectionchange":if(aI)break;case"keydown":case"keyup":L0(m,n,f)}var N;if(Pm)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Pi?Aw(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(Cw&&n.locale!=="ko"&&(Pi||x!=="onCompositionStart"?x==="onCompositionEnd"&&Pi&&(N=kw()):(Ks=f,Am="value"in Ks?Ks.value:Ks.textContent,Pi=!0)),U=eu(d,x),0<U.length&&(x=new C0(x,t,null,n,f),m.push({event:x,listeners:U}),N?x.data=N:(N=jw(n),N!==null&&(x.data=N)))),(N=Q2?Y2(t,n):X2(t,n))&&(d=eu(d,"onBeforeInput"),0<d.length&&(f=new C0("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=N))}Bw(m,e)})}function Ha(t,e,n){return{instance:t,listener:e,currentTarget:n}}function eu(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=La(t,n),i!=null&&s.unshift(Ha(t,i,r)),i=La(t,e),i!=null&&s.push(Ha(t,i,r))),t=t.return}return s}function Ei(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $0(t,e,n,s,r){for(var i=e._reactName,a=[];n!==null&&n!==s;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===s)break;c.tag===5&&d!==null&&(c=d,r?(u=La(n,i),u!=null&&a.unshift(Ha(n,u,c))):r||(u=La(n,i),u!=null&&a.push(Ha(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var dI=/\r\n?/g,hI=/\u0000|\uFFFD/g;function z0(t){return(typeof t=="string"?t:""+t).replace(dI,`
`).replace(hI,"")}function oc(t,e,n){if(e=z0(e),z0(t)!==e&&n)throw Error(W(425))}function tu(){}var uf=null,df=null;function hf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ff=typeof setTimeout=="function"?setTimeout:void 0,fI=typeof clearTimeout=="function"?clearTimeout:void 0,B0=typeof Promise=="function"?Promise:void 0,mI=typeof queueMicrotask=="function"?queueMicrotask:typeof B0<"u"?function(t){return B0.resolve(null).then(t).catch(pI)}:ff;function pI(t){setTimeout(function(){throw t})}function dh(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),$a(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);$a(e)}function er(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function q0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Co=Math.random().toString(36).slice(2),Wn="__reactFiber$"+Co,Ga="__reactProps$"+Co,ws="__reactContainer$"+Co,mf="__reactEvents$"+Co,gI="__reactListeners$"+Co,xI="__reactHandles$"+Co;function Fr(t){var e=t[Wn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ws]||n[Wn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=q0(t);t!==null;){if(n=t[Wn])return n;t=q0(t)}return e}t=n,n=t.parentNode}return null}function xl(t){return t=t[Wn]||t[ws],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Oi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Gu(t){return t[Ga]||null}var pf=[],Vi=-1;function Ir(t){return{current:t}}function Xe(t){0>Vi||(t.current=pf[Vi],pf[Vi]=null,Vi--)}function We(t,e){Vi++,pf[Vi]=t.current,t.current=e}var fr={},Ft=Ir(fr),nn=Ir(!1),Yr=fr;function io(t,e){var n=t.type.contextTypes;if(!n)return fr;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function sn(t){return t=t.childContextTypes,t!=null}function nu(){Xe(nn),Xe(Ft)}function H0(t,e,n){if(Ft.current!==fr)throw Error(W(168));We(Ft,e),We(nn,n)}function Hw(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(W(108,t2(t)||"Unknown",r));return st({},n,s)}function su(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fr,Yr=Ft.current,We(Ft,t),We(nn,nn.current),!0}function G0(t,e,n){var s=t.stateNode;if(!s)throw Error(W(169));n?(t=Hw(t,e,Yr),s.__reactInternalMemoizedMergedChildContext=t,Xe(nn),Xe(Ft),We(Ft,t)):Xe(nn),We(nn,n)}var ds=null,Wu=!1,hh=!1;function Gw(t){ds===null?ds=[t]:ds.push(t)}function yI(t){Wu=!0,Gw(t)}function Tr(){if(!hh&&ds!==null){hh=!0;var t=0,e=Fe;try{var n=ds;for(Fe=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}ds=null,Wu=!1}catch(r){throw ds!==null&&(ds=ds.slice(t+1)),xw(Tm,Tr),r}finally{Fe=e,hh=!1}}return null}var Li=[],Fi=0,ru=null,iu=0,xn=[],yn=0,Xr=null,fs=1,ms="";function Or(t,e){Li[Fi++]=iu,Li[Fi++]=ru,ru=t,iu=e}function Ww(t,e,n){xn[yn++]=fs,xn[yn++]=ms,xn[yn++]=Xr,Xr=t;var s=fs;t=ms;var r=32-Pn(s)-1;s&=~(1<<r),n+=1;var i=32-Pn(e)+r;if(30<i){var a=r-r%5;i=(s&(1<<a)-1).toString(32),s>>=a,r-=a,fs=1<<32-Pn(e)+r|n<<r|s,ms=i+t}else fs=1<<i|n<<r|s,ms=t}function Mm(t){t.return!==null&&(Or(t,1),Ww(t,1,0))}function Om(t){for(;t===ru;)ru=Li[--Fi],Li[Fi]=null,iu=Li[--Fi],Li[Fi]=null;for(;t===Xr;)Xr=xn[--yn],xn[yn]=null,ms=xn[--yn],xn[yn]=null,fs=xn[--yn],xn[yn]=null}var dn=null,ln=null,Je=!1,jn=null;function Kw(t,e){var n=bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function W0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,ln=er(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,ln=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xr!==null?{id:fs,overflow:ms}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,ln=null,!0):!1;default:return!1}}function gf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xf(t){if(Je){var e=ln;if(e){var n=e;if(!W0(t,e)){if(gf(t))throw Error(W(418));e=er(n.nextSibling);var s=dn;e&&W0(t,e)?Kw(s,n):(t.flags=t.flags&-4097|2,Je=!1,dn=t)}}else{if(gf(t))throw Error(W(418));t.flags=t.flags&-4097|2,Je=!1,dn=t}}}function K0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function ac(t){if(t!==dn)return!1;if(!Je)return K0(t),Je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hf(t.type,t.memoizedProps)),e&&(e=ln)){if(gf(t))throw Qw(),Error(W(418));for(;e;)Kw(t,e),e=er(e.nextSibling)}if(K0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ln=er(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ln=null}}else ln=dn?er(t.stateNode.nextSibling):null;return!0}function Qw(){for(var t=ln;t;)t=er(t.nextSibling)}function oo(){ln=dn=null,Je=!1}function Vm(t){jn===null?jn=[t]:jn.push(t)}var vI=ks.ReactCurrentBatchConfig;function ia(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var s=n.stateNode}if(!s)throw Error(W(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=r.refs;a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function lc(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Q0(t){var e=t._init;return e(t._payload)}function Yw(t){function e(b,E){if(t){var S=b.deletions;S===null?(b.deletions=[E],b.flags|=16):S.push(E)}}function n(b,E){if(!t)return null;for(;E!==null;)e(b,E),E=E.sibling;return null}function s(b,E){for(b=new Map;E!==null;)E.key!==null?b.set(E.key,E):b.set(E.index,E),E=E.sibling;return b}function r(b,E){return b=rr(b,E),b.index=0,b.sibling=null,b}function i(b,E,S){return b.index=S,t?(S=b.alternate,S!==null?(S=S.index,S<E?(b.flags|=2,E):S):(b.flags|=2,E)):(b.flags|=1048576,E)}function a(b){return t&&b.alternate===null&&(b.flags|=2),b}function c(b,E,S,R){return E===null||E.tag!==6?(E=vh(S,b.mode,R),E.return=b,E):(E=r(E,S),E.return=b,E)}function u(b,E,S,R){var L=S.type;return L===Ri?f(b,E,S.props.children,R,S.key):E!==null&&(E.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Us&&Q0(L)===E.type)?(R=r(E,S.props),R.ref=ia(b,E,S),R.return=b,R):(R=Pc(S.type,S.key,S.props,null,b.mode,R),R.ref=ia(b,E,S),R.return=b,R)}function d(b,E,S,R){return E===null||E.tag!==4||E.stateNode.containerInfo!==S.containerInfo||E.stateNode.implementation!==S.implementation?(E=wh(S,b.mode,R),E.return=b,E):(E=r(E,S.children||[]),E.return=b,E)}function f(b,E,S,R,L){return E===null||E.tag!==7?(E=Gr(S,b.mode,R,L),E.return=b,E):(E=r(E,S),E.return=b,E)}function m(b,E,S){if(typeof E=="string"&&E!==""||typeof E=="number")return E=vh(""+E,b.mode,S),E.return=b,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Xl:return S=Pc(E.type,E.key,E.props,null,b.mode,S),S.ref=ia(b,null,E),S.return=b,S;case ji:return E=wh(E,b.mode,S),E.return=b,E;case Us:var R=E._init;return m(b,R(E._payload),S)}if(da(E)||ea(E))return E=Gr(E,b.mode,S,null),E.return=b,E;lc(b,E)}return null}function p(b,E,S,R){var L=E!==null?E.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return L!==null?null:c(b,E,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Xl:return S.key===L?u(b,E,S,R):null;case ji:return S.key===L?d(b,E,S,R):null;case Us:return L=S._init,p(b,E,L(S._payload),R)}if(da(S)||ea(S))return L!==null?null:f(b,E,S,R,null);lc(b,S)}return null}function y(b,E,S,R,L){if(typeof R=="string"&&R!==""||typeof R=="number")return b=b.get(S)||null,c(E,b,""+R,L);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Xl:return b=b.get(R.key===null?S:R.key)||null,u(E,b,R,L);case ji:return b=b.get(R.key===null?S:R.key)||null,d(E,b,R,L);case Us:var U=R._init;return y(b,E,S,U(R._payload),L)}if(da(R)||ea(R))return b=b.get(S)||null,f(E,b,R,L,null);lc(E,R)}return null}function T(b,E,S,R){for(var L=null,U=null,N=E,x=E=0,v=null;N!==null&&x<S.length;x++){N.index>x?(v=N,N=null):v=N.sibling;var _=p(b,N,S[x],R);if(_===null){N===null&&(N=v);break}t&&N&&_.alternate===null&&e(b,N),E=i(_,E,x),U===null?L=_:U.sibling=_,U=_,N=v}if(x===S.length)return n(b,N),Je&&Or(b,x),L;if(N===null){for(;x<S.length;x++)N=m(b,S[x],R),N!==null&&(E=i(N,E,x),U===null?L=N:U.sibling=N,U=N);return Je&&Or(b,x),L}for(N=s(b,N);x<S.length;x++)v=y(N,b,x,S[x],R),v!==null&&(t&&v.alternate!==null&&N.delete(v.key===null?x:v.key),E=i(v,E,x),U===null?L=v:U.sibling=v,U=v);return t&&N.forEach(function(k){return e(b,k)}),Je&&Or(b,x),L}function C(b,E,S,R){var L=ea(S);if(typeof L!="function")throw Error(W(150));if(S=L.call(S),S==null)throw Error(W(151));for(var U=L=null,N=E,x=E=0,v=null,_=S.next();N!==null&&!_.done;x++,_=S.next()){N.index>x?(v=N,N=null):v=N.sibling;var k=p(b,N,_.value,R);if(k===null){N===null&&(N=v);break}t&&N&&k.alternate===null&&e(b,N),E=i(k,E,x),U===null?L=k:U.sibling=k,U=k,N=v}if(_.done)return n(b,N),Je&&Or(b,x),L;if(N===null){for(;!_.done;x++,_=S.next())_=m(b,_.value,R),_!==null&&(E=i(_,E,x),U===null?L=_:U.sibling=_,U=_);return Je&&Or(b,x),L}for(N=s(b,N);!_.done;x++,_=S.next())_=y(N,b,x,_.value,R),_!==null&&(t&&_.alternate!==null&&N.delete(_.key===null?x:_.key),E=i(_,E,x),U===null?L=_:U.sibling=_,U=_);return t&&N.forEach(function(j){return e(b,j)}),Je&&Or(b,x),L}function P(b,E,S,R){if(typeof S=="object"&&S!==null&&S.type===Ri&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Xl:e:{for(var L=S.key,U=E;U!==null;){if(U.key===L){if(L=S.type,L===Ri){if(U.tag===7){n(b,U.sibling),E=r(U,S.props.children),E.return=b,b=E;break e}}else if(U.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Us&&Q0(L)===U.type){n(b,U.sibling),E=r(U,S.props),E.ref=ia(b,U,S),E.return=b,b=E;break e}n(b,U);break}else e(b,U);U=U.sibling}S.type===Ri?(E=Gr(S.props.children,b.mode,R,S.key),E.return=b,b=E):(R=Pc(S.type,S.key,S.props,null,b.mode,R),R.ref=ia(b,E,S),R.return=b,b=R)}return a(b);case ji:e:{for(U=S.key;E!==null;){if(E.key===U)if(E.tag===4&&E.stateNode.containerInfo===S.containerInfo&&E.stateNode.implementation===S.implementation){n(b,E.sibling),E=r(E,S.children||[]),E.return=b,b=E;break e}else{n(b,E);break}else e(b,E);E=E.sibling}E=wh(S,b.mode,R),E.return=b,b=E}return a(b);case Us:return U=S._init,P(b,E,U(S._payload),R)}if(da(S))return T(b,E,S,R);if(ea(S))return C(b,E,S,R);lc(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,E!==null&&E.tag===6?(n(b,E.sibling),E=r(E,S),E.return=b,b=E):(n(b,E),E=vh(S,b.mode,R),E.return=b,b=E),a(b)):n(b,E)}return P}var ao=Yw(!0),Xw=Yw(!1),ou=Ir(null),au=null,Ui=null,Lm=null;function Fm(){Lm=Ui=au=null}function Um(t){var e=ou.current;Xe(ou),t._currentValue=e}function yf(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Ki(t,e){au=t,Lm=Ui=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zt=!0),t.firstContext=null)}function En(t){var e=t._currentValue;if(Lm!==t)if(t={context:t,memoizedValue:e,next:null},Ui===null){if(au===null)throw Error(W(308));Ui=t,au.dependencies={lanes:0,firstContext:t}}else Ui=Ui.next=t;return e}var Ur=null;function $m(t){Ur===null?Ur=[t]:Ur.push(t)}function Jw(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,$m(e)):(n.next=r.next,r.next=n),e.interleaved=n,bs(t,s)}function bs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $s=!1;function zm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tr(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,De&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,bs(t,n)}return r=s.interleaved,r===null?(e.next=e,$m(s)):(e.next=r.next,r.next=e),s.interleaved=e,bs(t,n)}function Sc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Sm(t,n)}}function Y0(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function lu(t,e,n,s){var r=t.updateQueue;$s=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,c=r.shared.pending;if(c!==null){r.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==a&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=r.baseState;a=0,f=d=u=null,c=i;do{var p=c.lane,y=c.eventTime;if((s&p)===p){f!==null&&(f=f.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var T=t,C=c;switch(p=e,y=n,C.tag){case 1:if(T=C.payload,typeof T=="function"){m=T.call(y,m,p);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=C.payload,p=typeof T=="function"?T.call(y,m,p):T,p==null)break e;m=st({},m,p);break e;case 2:$s=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=r.effects,p===null?r.effects=[c]:p.push(c))}else y={eventTime:y,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=y,u=m):f=f.next=y,a|=p;if(c=c.next,c===null){if(c=r.shared.pending,c===null)break;p=c,c=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(f===null&&(u=m),r.baseState=u,r.firstBaseUpdate=d,r.lastBaseUpdate=f,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Zr|=a,t.lanes=a,t.memoizedState=m}}function X0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(W(191,r));r.call(s)}}}var yl={},Yn=Ir(yl),Wa=Ir(yl),Ka=Ir(yl);function $r(t){if(t===yl)throw Error(W(174));return t}function Bm(t,e){switch(We(Ka,e),We(Wa,t),We(Yn,yl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xh(e,t)}Xe(Yn),We(Yn,e)}function lo(){Xe(Yn),Xe(Wa),Xe(Ka)}function eb(t){$r(Ka.current);var e=$r(Yn.current),n=Xh(e,t.type);e!==n&&(We(Wa,t),We(Yn,n))}function qm(t){Wa.current===t&&(Xe(Yn),Xe(Wa))}var et=Ir(0);function cu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fh=[];function Hm(){for(var t=0;t<fh.length;t++)fh[t]._workInProgressVersionPrimary=null;fh.length=0}var kc=ks.ReactCurrentDispatcher,mh=ks.ReactCurrentBatchConfig,Jr=0,nt=null,vt=null,Et=null,uu=!1,Ea=!1,Qa=0,wI=0;function Rt(){throw Error(W(321))}function Gm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!On(t[n],e[n]))return!1;return!0}function Wm(t,e,n,s,r,i){if(Jr=i,nt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kc.current=t===null||t.memoizedState===null?EI:II,t=n(s,r),Ea){i=0;do{if(Ea=!1,Qa=0,25<=i)throw Error(W(301));i+=1,Et=vt=null,e.updateQueue=null,kc.current=TI,t=n(s,r)}while(Ea)}if(kc.current=du,e=vt!==null&&vt.next!==null,Jr=0,Et=vt=nt=null,uu=!1,e)throw Error(W(300));return t}function Km(){var t=Qa!==0;return Qa=0,t}function Hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?nt.memoizedState=Et=t:Et=Et.next=t,Et}function In(){if(vt===null){var t=nt.alternate;t=t!==null?t.memoizedState:null}else t=vt.next;var e=Et===null?nt.memoizedState:Et.next;if(e!==null)Et=e,vt=t;else{if(t===null)throw Error(W(310));vt=t,t={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Et===null?nt.memoizedState=Et=t:Et=Et.next=t}return Et}function Ya(t,e){return typeof e=="function"?e(t):e}function ph(t){var e=In(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var s=vt,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var a=r.next;r.next=i.next,i.next=a}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var c=a=null,u=null,d=i;do{var f=d.lane;if((Jr&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=m,a=s):u=u.next=m,nt.lanes|=f,Zr|=f}d=d.next}while(d!==null&&d!==i);u===null?a=s:u.next=c,On(s,e.memoizedState)||(Zt=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=u,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,nt.lanes|=i,Zr|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gh(t){var e=In(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do i=t(i,a.action),a=a.next;while(a!==r);On(i,e.memoizedState)||(Zt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function tb(){}function nb(t,e){var n=nt,s=In(),r=e(),i=!On(s.memoizedState,r);if(i&&(s.memoizedState=r,Zt=!0),s=s.queue,Qm(ib.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Xa(9,rb.bind(null,n,s,r,e),void 0,null),It===null)throw Error(W(349));Jr&30||sb(n,e,r)}return r}function sb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=nt.updateQueue,e===null?(e={lastEffect:null,stores:null},nt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function rb(t,e,n,s){e.value=n,e.getSnapshot=s,ob(e)&&ab(t)}function ib(t,e,n){return n(function(){ob(e)&&ab(t)})}function ob(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!On(t,n)}catch{return!0}}function ab(t){var e=bs(t,1);e!==null&&Dn(e,t,1,-1)}function J0(t){var e=Hn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:t},e.queue=t,t=t.dispatch=NI.bind(null,nt,t),[e.memoizedState,t]}function Xa(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=nt.updateQueue,e===null?(e={lastEffect:null,stores:null},nt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function lb(){return In().memoizedState}function Cc(t,e,n,s){var r=Hn();nt.flags|=t,r.memoizedState=Xa(1|e,n,void 0,s===void 0?null:s)}function Ku(t,e,n,s){var r=In();s=s===void 0?null:s;var i=void 0;if(vt!==null){var a=vt.memoizedState;if(i=a.destroy,s!==null&&Gm(s,a.deps)){r.memoizedState=Xa(e,n,i,s);return}}nt.flags|=t,r.memoizedState=Xa(1|e,n,i,s)}function Z0(t,e){return Cc(8390656,8,t,e)}function Qm(t,e){return Ku(2048,8,t,e)}function cb(t,e){return Ku(4,2,t,e)}function ub(t,e){return Ku(4,4,t,e)}function db(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hb(t,e,n){return n=n!=null?n.concat([t]):null,Ku(4,4,db.bind(null,e,t),n)}function Ym(){}function fb(t,e){var n=In();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Gm(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function mb(t,e){var n=In();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Gm(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function pb(t,e,n){return Jr&21?(On(n,e)||(n=ww(),nt.lanes|=n,Zr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zt=!0),t.memoizedState=n)}function bI(t,e){var n=Fe;Fe=n!==0&&4>n?n:4,t(!0);var s=mh.transition;mh.transition={};try{t(!1),e()}finally{Fe=n,mh.transition=s}}function gb(){return In().memoizedState}function _I(t,e,n){var s=sr(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},xb(t))yb(e,n);else if(n=Jw(t,e,n,s),n!==null){var r=Bt();Dn(n,t,s,r),vb(n,e,s)}}function NI(t,e,n){var s=sr(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(xb(t))yb(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,n);if(r.hasEagerState=!0,r.eagerState=c,On(c,a)){var u=e.interleaved;u===null?(r.next=r,$m(e)):(r.next=u.next,u.next=r),e.interleaved=r;return}}catch{}finally{}n=Jw(t,e,r,s),n!==null&&(r=Bt(),Dn(n,t,s,r),vb(n,e,s))}}function xb(t){var e=t.alternate;return t===nt||e!==null&&e===nt}function yb(t,e){Ea=uu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function vb(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Sm(t,n)}}var du={readContext:En,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},EI={readContext:En,useCallback:function(t,e){return Hn().memoizedState=[t,e===void 0?null:e],t},useContext:En,useEffect:Z0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Cc(4194308,4,db.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Cc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Cc(4,2,t,e)},useMemo:function(t,e){var n=Hn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Hn();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=_I.bind(null,nt,t),[s.memoizedState,t]},useRef:function(t){var e=Hn();return t={current:t},e.memoizedState=t},useState:J0,useDebugValue:Ym,useDeferredValue:function(t){return Hn().memoizedState=t},useTransition:function(){var t=J0(!1),e=t[0];return t=bI.bind(null,t[1]),Hn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=nt,r=Hn();if(Je){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),It===null)throw Error(W(349));Jr&30||sb(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,Z0(ib.bind(null,s,i,t),[t]),s.flags|=2048,Xa(9,rb.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Hn(),e=It.identifierPrefix;if(Je){var n=ms,s=fs;n=(s&~(1<<32-Pn(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Qa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},II={readContext:En,useCallback:fb,useContext:En,useEffect:Qm,useImperativeHandle:hb,useInsertionEffect:cb,useLayoutEffect:ub,useMemo:mb,useReducer:ph,useRef:lb,useState:function(){return ph(Ya)},useDebugValue:Ym,useDeferredValue:function(t){var e=In();return pb(e,vt.memoizedState,t)},useTransition:function(){var t=ph(Ya)[0],e=In().memoizedState;return[t,e]},useMutableSource:tb,useSyncExternalStore:nb,useId:gb,unstable_isNewReconciler:!1},TI={readContext:En,useCallback:fb,useContext:En,useEffect:Qm,useImperativeHandle:hb,useInsertionEffect:cb,useLayoutEffect:ub,useMemo:mb,useReducer:gh,useRef:lb,useState:function(){return gh(Ya)},useDebugValue:Ym,useDeferredValue:function(t){var e=In();return vt===null?e.memoizedState=t:pb(e,vt.memoizedState,t)},useTransition:function(){var t=gh(Ya)[0],e=In().memoizedState;return[t,e]},useMutableSource:tb,useSyncExternalStore:nb,useId:gb,unstable_isNewReconciler:!1};function Cn(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vf(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qu={isMounted:function(t){return(t=t._reactInternals)?di(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Bt(),r=sr(t),i=xs(s,r);i.payload=e,n!=null&&(i.callback=n),e=tr(t,i,r),e!==null&&(Dn(e,t,r,s),Sc(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Bt(),r=sr(t),i=xs(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=tr(t,i,r),e!==null&&(Dn(e,t,r,s),Sc(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bt(),s=sr(t),r=xs(n,s);r.tag=2,e!=null&&(r.callback=e),e=tr(t,r,s),e!==null&&(Dn(e,t,s,n),Sc(e,t,s))}};function ex(t,e,n,s,r,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,a):e.prototype&&e.prototype.isPureReactComponent?!Ba(n,s)||!Ba(r,i):!0}function wb(t,e,n){var s=!1,r=fr,i=e.contextType;return typeof i=="object"&&i!==null?i=En(i):(r=sn(e)?Yr:Ft.current,s=e.contextTypes,i=(s=s!=null)?io(t,r):fr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qu,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function tx(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Qu.enqueueReplaceState(e,e.state,null)}function wf(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},zm(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=En(i):(i=sn(e)?Yr:Ft.current,r.context=io(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vf(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Qu.enqueueReplaceState(r,r.state,null),lu(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function co(t,e){try{var n="",s=e;do n+=e2(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function xh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function bf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var SI=typeof WeakMap=="function"?WeakMap:Map;function bb(t,e,n){n=xs(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){fu||(fu=!0,jf=s),bf(t,e)},n}function _b(t,e,n){n=xs(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){bf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){bf(t,e),typeof s!="function"&&(nr===null?nr=new Set([this]):nr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function nx(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new SI;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=$I.bind(null,t,e,n),e.then(t,t))}function sx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rx(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xs(-1,1),e.tag=2,tr(n,e,1))),n.lanes|=1),t)}var kI=ks.ReactCurrentOwner,Zt=!1;function zt(t,e,n,s){e.child=t===null?Xw(e,null,n,s):ao(e,t.child,n,s)}function ix(t,e,n,s,r){n=n.render;var i=e.ref;return Ki(e,r),s=Wm(t,e,n,s,i,r),n=Km(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,_s(t,e,r)):(Je&&n&&Mm(e),e.flags|=1,zt(t,e,s,r),e.child)}function ox(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!rp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Nb(t,e,i,s,r)):(t=Pc(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ba,n(a,s)&&t.ref===e.ref)return _s(t,e,r)}return e.flags|=1,t=rr(i,s),t.ref=e.ref,t.return=e,e.child=t}function Nb(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Ba(i,s)&&t.ref===e.ref)if(Zt=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Zt=!0);else return e.lanes=t.lanes,_s(t,e,r)}return _f(t,e,n,s,r)}function Eb(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(zi,an),an|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(zi,an),an|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,We(zi,an),an|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,We(zi,an),an|=s;return zt(t,e,r,n),e.child}function Ib(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _f(t,e,n,s,r){var i=sn(n)?Yr:Ft.current;return i=io(e,i),Ki(e,r),n=Wm(t,e,n,s,i,r),s=Km(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,_s(t,e,r)):(Je&&s&&Mm(e),e.flags|=1,zt(t,e,n,r),e.child)}function ax(t,e,n,s,r){if(sn(n)){var i=!0;su(e)}else i=!1;if(Ki(e,r),e.stateNode===null)Ac(t,e),wb(e,n,s),wf(e,n,s,r),s=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=En(d):(d=sn(n)?Yr:Ft.current,d=io(e,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==s||u!==d)&&tx(e,a,s,d),$s=!1;var p=e.memoizedState;a.state=p,lu(e,s,a,r),u=e.memoizedState,c!==s||p!==u||nn.current||$s?(typeof f=="function"&&(vf(e,n,f,s),u=e.memoizedState),(c=$s||ex(e,n,c,s,p,u,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),a.props=s,a.state=u,a.context=d,s=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Zw(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Cn(e.type,c),a.props=d,m=e.pendingProps,p=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=En(u):(u=sn(n)?Yr:Ft.current,u=io(e,u));var y=n.getDerivedStateFromProps;(f=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==m||p!==u)&&tx(e,a,s,u),$s=!1,p=e.memoizedState,a.state=p,lu(e,s,a,r);var T=e.memoizedState;c!==m||p!==T||nn.current||$s?(typeof y=="function"&&(vf(e,n,y,s),T=e.memoizedState),(d=$s||ex(e,n,d,s,p,T,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,T,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,T,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=T),a.props=s,a.state=T,a.context=u,s=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),s=!1)}return Nf(t,e,n,s,i,r)}function Nf(t,e,n,s,r,i){Ib(t,e);var a=(e.flags&128)!==0;if(!s&&!a)return r&&G0(e,n,!1),_s(t,e,i);s=e.stateNode,kI.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&a?(e.child=ao(e,t.child,null,i),e.child=ao(e,null,c,i)):zt(t,e,c,i),e.memoizedState=s.state,r&&G0(e,n,!0),e.child}function Tb(t){var e=t.stateNode;e.pendingContext?H0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H0(t,e.context,!1),Bm(t,e.containerInfo)}function lx(t,e,n,s,r){return oo(),Vm(r),e.flags|=256,zt(t,e,n,s),e.child}var Ef={dehydrated:null,treeContext:null,retryLane:0};function If(t){return{baseLanes:t,cachePool:null,transitions:null}}function Sb(t,e,n){var s=e.pendingProps,r=et.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(r&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),We(et,r&1),t===null)return xf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,t=s.fallback,i?(s=e.mode,i=e.child,a={mode:"hidden",children:a},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Ju(a,s,0,null),t=Gr(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=If(n),e.memoizedState=Ef,t):Xm(e,a));if(r=t.memoizedState,r!==null&&(c=r.dehydrated,c!==null))return CI(t,e,a,s,c,r,n);if(i){i=s.fallback,a=e.mode,r=t.child,c=r.sibling;var u={mode:"hidden",children:s.children};return!(a&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=u,e.deletions=null):(s=rr(r,u),s.subtreeFlags=r.subtreeFlags&14680064),c!==null?i=rr(c,i):(i=Gr(i,a,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,a=t.child.memoizedState,a=a===null?If(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Ef,s}return i=t.child,t=i.sibling,s=rr(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Xm(t,e){return e=Ju({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cc(t,e,n,s){return s!==null&&Vm(s),ao(e,t.child,null,n),t=Xm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function CI(t,e,n,s,r,i,a){if(n)return e.flags&256?(e.flags&=-257,s=xh(Error(W(422))),cc(t,e,a,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Ju({mode:"visible",children:s.children},r,0,null),i=Gr(i,r,a,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&ao(e,t.child,null,a),e.child.memoizedState=If(a),e.memoizedState=Ef,i);if(!(e.mode&1))return cc(t,e,a,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var c=s.dgst;return s=c,i=Error(W(419)),s=xh(i,s,void 0),cc(t,e,a,s)}if(c=(a&t.childLanes)!==0,Zt||c){if(s=It,s!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|a)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,bs(t,r),Dn(s,t,r,-1))}return sp(),s=xh(Error(W(421))),cc(t,e,a,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=zI.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,ln=er(r.nextSibling),dn=e,Je=!0,jn=null,t!==null&&(xn[yn++]=fs,xn[yn++]=ms,xn[yn++]=Xr,fs=t.id,ms=t.overflow,Xr=e),e=Xm(e,s.children),e.flags|=4096,e)}function cx(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),yf(t.return,e,n)}function yh(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function kb(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(zt(t,e,s.children,n),s=et.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cx(t,n,e);else if(t.tag===19)cx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(We(et,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&cu(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),yh(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&cu(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}yh(e,!0,n,null,i);break;case"together":yh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ac(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _s(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=rr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=rr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function AI(t,e,n){switch(e.tag){case 3:Tb(e),oo();break;case 5:eb(e);break;case 1:sn(e.type)&&su(e);break;case 4:Bm(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;We(ou,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(We(et,et.current&1),e.flags|=128,null):n&e.child.childLanes?Sb(t,e,n):(We(et,et.current&1),t=_s(t,e,n),t!==null?t.sibling:null);We(et,et.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return kb(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),We(et,et.current),s)break;return null;case 22:case 23:return e.lanes=0,Eb(t,e,n)}return _s(t,e,n)}var Cb,Tf,Ab,jb;Cb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tf=function(){};Ab=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,$r(Yn.current);var i=null;switch(n){case"input":r=Wh(t,r),s=Wh(t,s),i=[];break;case"select":r=st({},r,{value:void 0}),s=st({},s,{value:void 0}),i=[];break;case"textarea":r=Yh(t,r),s=Yh(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=tu)}Jh(n,s);var a;n=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var c=r[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Oa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var u=s[d];if(c=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Oa.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Qe("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};jb=function(t,e,n,s){n!==s&&(e.flags|=4)};function oa(t,e){if(!Je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Pt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function jI(t,e,n){var s=e.pendingProps;switch(Om(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(e),null;case 1:return sn(e.type)&&nu(),Pt(e),null;case 3:return s=e.stateNode,lo(),Xe(nn),Xe(Ft),Hm(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(ac(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jn!==null&&(Df(jn),jn=null))),Tf(t,e),Pt(e),null;case 5:qm(e);var r=$r(Ka.current);if(n=e.type,t!==null&&e.stateNode!=null)Ab(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(W(166));return Pt(e),null}if(t=$r(Yn.current),ac(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Wn]=e,s[Ga]=i,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",s),Qe("close",s);break;case"iframe":case"object":case"embed":Qe("load",s);break;case"video":case"audio":for(r=0;r<fa.length;r++)Qe(fa[r],s);break;case"source":Qe("error",s);break;case"img":case"image":case"link":Qe("error",s),Qe("load",s);break;case"details":Qe("toggle",s);break;case"input":y0(s,i),Qe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Qe("invalid",s);break;case"textarea":w0(s,i),Qe("invalid",s)}Jh(n,i),r=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?s.textContent!==c&&(i.suppressHydrationWarning!==!0&&oc(s.textContent,c,t),r=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&oc(s.textContent,c,t),r=["children",""+c]):Oa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Qe("scroll",s)}switch(n){case"input":Jl(s),v0(s,i,!0);break;case"textarea":Jl(s),b0(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=tu)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=iw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=a.createElement(n,{is:s.is}):(t=a.createElement(n),n==="select"&&(a=t,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):t=a.createElementNS(t,n),t[Wn]=e,t[Ga]=s,Cb(t,e,!1,!1),e.stateNode=t;e:{switch(a=Zh(n,s),n){case"dialog":Qe("cancel",t),Qe("close",t),r=s;break;case"iframe":case"object":case"embed":Qe("load",t),r=s;break;case"video":case"audio":for(r=0;r<fa.length;r++)Qe(fa[r],t);r=s;break;case"source":Qe("error",t),r=s;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),r=s;break;case"details":Qe("toggle",t),r=s;break;case"input":y0(t,s),r=Wh(t,s),Qe("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=st({},s,{value:void 0}),Qe("invalid",t);break;case"textarea":w0(t,s),r=Yh(t,s),Qe("invalid",t);break;default:r=s}Jh(n,r),c=r;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?lw(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&ow(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Va(t,u):typeof u=="number"&&Va(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Qe("scroll",t):u!=null&&bm(t,i,u,a))}switch(n){case"input":Jl(t),v0(t,s,!1);break;case"textarea":Jl(t),b0(t);break;case"option":s.value!=null&&t.setAttribute("value",""+hr(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?qi(t,!!s.multiple,i,!1):s.defaultValue!=null&&qi(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=tu)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pt(e),null;case 6:if(t&&e.stateNode!=null)jb(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(W(166));if(n=$r(Ka.current),$r(Yn.current),ac(e)){if(s=e.stateNode,n=e.memoizedProps,s[Wn]=e,(i=s.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:oc(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&oc(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Wn]=e,e.stateNode=s}return Pt(e),null;case 13:if(Xe(et),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Je&&ln!==null&&e.mode&1&&!(e.flags&128))Qw(),oo(),e.flags|=98560,i=!1;else if(i=ac(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Wn]=e}else oo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pt(e),i=!1}else jn!==null&&(Df(jn),jn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||et.current&1?wt===0&&(wt=3):sp())),e.updateQueue!==null&&(e.flags|=4),Pt(e),null);case 4:return lo(),Tf(t,e),t===null&&qa(e.stateNode.containerInfo),Pt(e),null;case 10:return Um(e.type._context),Pt(e),null;case 17:return sn(e.type)&&nu(),Pt(e),null;case 19:if(Xe(et),i=e.memoizedState,i===null)return Pt(e),null;if(s=(e.flags&128)!==0,a=i.rendering,a===null)if(s)oa(i,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=cu(t),a!==null){for(e.flags|=128,oa(i,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return We(et,et.current&1|2),e.child}t=t.sibling}i.tail!==null&&ut()>uo&&(e.flags|=128,s=!0,oa(i,!1),e.lanes=4194304)}else{if(!s)if(t=cu(a),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),oa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Je)return Pt(e),null}else 2*ut()-i.renderingStartTime>uo&&n!==1073741824&&(e.flags|=128,s=!0,oa(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ut(),e.sibling=null,n=et.current,We(et,s?n&1|2:n&1),e):(Pt(e),null);case 22:case 23:return np(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?an&1073741824&&(Pt(e),e.subtreeFlags&6&&(e.flags|=8192)):Pt(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function RI(t,e){switch(Om(e),e.tag){case 1:return sn(e.type)&&nu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return lo(),Xe(nn),Xe(Ft),Hm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qm(e),null;case 13:if(Xe(et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));oo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Xe(et),null;case 4:return lo(),null;case 10:return Um(e.type._context),null;case 22:case 23:return np(),null;case 24:return null;default:return null}}var uc=!1,Ot=!1,PI=typeof WeakSet=="function"?WeakSet:Set,oe=null;function $i(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){ot(t,e,s)}else n.current=null}function Sf(t,e,n){try{n()}catch(s){ot(t,e,s)}}var ux=!1;function DI(t,e){if(uf=Jc,t=Ow(),Dm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,f=0,m=t,p=null;t:for(;;){for(var y;m!==n||r!==0&&m.nodeType!==3||(c=a+r),m!==i||s!==0&&m.nodeType!==3||(u=a+s),m.nodeType===3&&(a+=m.nodeValue.length),(y=m.firstChild)!==null;)p=m,m=y;for(;;){if(m===t)break t;if(p===n&&++d===r&&(c=a),p===i&&++f===s&&(u=a),(y=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=y}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(df={focusedElem:t,selectionRange:n},Jc=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var C=T.memoizedProps,P=T.memoizedState,b=e.stateNode,E=b.getSnapshotBeforeUpdate(e.elementType===e.type?C:Cn(e.type,C),P);b.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(R){ot(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return T=ux,ux=!1,T}function Ia(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Sf(e,n,i)}r=r.next}while(r!==s)}}function Yu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function kf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Rb(t){var e=t.alternate;e!==null&&(t.alternate=null,Rb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Wn],delete e[Ga],delete e[mf],delete e[gI],delete e[xI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Pb(t){return t.tag===5||t.tag===3||t.tag===4}function dx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Pb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Cf(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=tu));else if(s!==4&&(t=t.child,t!==null))for(Cf(t,e,n),t=t.sibling;t!==null;)Cf(t,e,n),t=t.sibling}function Af(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Af(t,e,n),t=t.sibling;t!==null;)Af(t,e,n),t=t.sibling}var Tt=null,An=!1;function Vs(t,e,n){for(n=n.child;n!==null;)Db(t,e,n),n=n.sibling}function Db(t,e,n){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(zu,n)}catch{}switch(n.tag){case 5:Ot||$i(n,e);case 6:var s=Tt,r=An;Tt=null,Vs(t,e,n),Tt=s,An=r,Tt!==null&&(An?(t=Tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(An?(t=Tt,n=n.stateNode,t.nodeType===8?dh(t.parentNode,n):t.nodeType===1&&dh(t,n),$a(t)):dh(Tt,n.stateNode));break;case 4:s=Tt,r=An,Tt=n.stateNode.containerInfo,An=!0,Vs(t,e,n),Tt=s,An=r;break;case 0:case 11:case 14:case 15:if(!Ot&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Sf(n,e,a),r=r.next}while(r!==s)}Vs(t,e,n);break;case 1:if(!Ot&&($i(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(c){ot(n,e,c)}Vs(t,e,n);break;case 21:Vs(t,e,n);break;case 22:n.mode&1?(Ot=(s=Ot)||n.memoizedState!==null,Vs(t,e,n),Ot=s):Vs(t,e,n);break;default:Vs(t,e,n)}}function hx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new PI),e.forEach(function(s){var r=BI.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function kn(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:Tt=c.stateNode,An=!1;break e;case 3:Tt=c.stateNode.containerInfo,An=!0;break e;case 4:Tt=c.stateNode.containerInfo,An=!0;break e}c=c.return}if(Tt===null)throw Error(W(160));Db(i,a,r),Tt=null,An=!1;var u=r.alternate;u!==null&&(u.return=null),r.return=null}catch(d){ot(r,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Mb(e,t),e=e.sibling}function Mb(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(kn(e,t),qn(t),s&4){try{Ia(3,t,t.return),Yu(3,t)}catch(C){ot(t,t.return,C)}try{Ia(5,t,t.return)}catch(C){ot(t,t.return,C)}}break;case 1:kn(e,t),qn(t),s&512&&n!==null&&$i(n,n.return);break;case 5:if(kn(e,t),qn(t),s&512&&n!==null&&$i(n,n.return),t.flags&32){var r=t.stateNode;try{Va(r,"")}catch(C){ot(t,t.return,C)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&sw(r,i),Zh(c,a);var d=Zh(c,i);for(a=0;a<u.length;a+=2){var f=u[a],m=u[a+1];f==="style"?lw(r,m):f==="dangerouslySetInnerHTML"?ow(r,m):f==="children"?Va(r,m):bm(r,f,m,d)}switch(c){case"input":Kh(r,i);break;case"textarea":rw(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?qi(r,!!i.multiple,y,!1):p!==!!i.multiple&&(i.defaultValue!=null?qi(r,!!i.multiple,i.defaultValue,!0):qi(r,!!i.multiple,i.multiple?[]:"",!1))}r[Ga]=i}catch(C){ot(t,t.return,C)}}break;case 6:if(kn(e,t),qn(t),s&4){if(t.stateNode===null)throw Error(W(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(C){ot(t,t.return,C)}}break;case 3:if(kn(e,t),qn(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{$a(e.containerInfo)}catch(C){ot(t,t.return,C)}break;case 4:kn(e,t),qn(t);break;case 13:kn(e,t),qn(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(ep=ut())),s&4&&hx(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Ot=(d=Ot)||f,kn(e,t),Ot=d):kn(e,t),qn(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(oe=t,f=t.child;f!==null;){for(m=oe=f;oe!==null;){switch(p=oe,y=p.child,p.tag){case 0:case 11:case 14:case 15:Ia(4,p,p.return);break;case 1:$i(p,p.return);var T=p.stateNode;if(typeof T.componentWillUnmount=="function"){s=p,n=p.return;try{e=s,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(C){ot(s,n,C)}}break;case 5:$i(p,p.return);break;case 22:if(p.memoizedState!==null){mx(m);continue}}y!==null?(y.return=p,oe=y):mx(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{r=m.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=aw("display",a))}catch(C){ot(t,t.return,C)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(C){ot(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:kn(e,t),qn(t),s&4&&hx(t);break;case 21:break;default:kn(e,t),qn(t)}}function qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Pb(n)){var s=n;break e}n=n.return}throw Error(W(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Va(r,""),s.flags&=-33);var i=dx(t);Af(t,i,r);break;case 3:case 4:var a=s.stateNode.containerInfo,c=dx(t);Cf(t,c,a);break;default:throw Error(W(161))}}catch(u){ot(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function MI(t,e,n){oe=t,Ob(t)}function Ob(t,e,n){for(var s=(t.mode&1)!==0;oe!==null;){var r=oe,i=r.child;if(r.tag===22&&s){var a=r.memoizedState!==null||uc;if(!a){var c=r.alternate,u=c!==null&&c.memoizedState!==null||Ot;c=uc;var d=Ot;if(uc=a,(Ot=u)&&!d)for(oe=r;oe!==null;)a=oe,u=a.child,a.tag===22&&a.memoizedState!==null?px(r):u!==null?(u.return=a,oe=u):px(r);for(;i!==null;)oe=i,Ob(i),i=i.sibling;oe=r,uc=c,Ot=d}fx(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,oe=i):fx(t)}}function fx(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||Yu(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ot)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Cn(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&X0(e,i,s);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}X0(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&$a(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Ot||e.flags&512&&kf(e)}catch(p){ot(e,e.return,p)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function mx(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function px(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yu(4,e)}catch(u){ot(e,n,u)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(u){ot(e,r,u)}}var i=e.return;try{kf(e)}catch(u){ot(e,i,u)}break;case 5:var a=e.return;try{kf(e)}catch(u){ot(e,a,u)}}}catch(u){ot(e,e.return,u)}if(e===t){oe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,oe=c;break}oe=e.return}}var OI=Math.ceil,hu=ks.ReactCurrentDispatcher,Jm=ks.ReactCurrentOwner,_n=ks.ReactCurrentBatchConfig,De=0,It=null,pt=null,Ct=0,an=0,zi=Ir(0),wt=0,Ja=null,Zr=0,Xu=0,Zm=0,Ta=null,Yt=null,ep=0,uo=1/0,us=null,fu=!1,jf=null,nr=null,dc=!1,Qs=null,mu=0,Sa=0,Rf=null,jc=-1,Rc=0;function Bt(){return De&6?ut():jc!==-1?jc:jc=ut()}function sr(t){return t.mode&1?De&2&&Ct!==0?Ct&-Ct:vI.transition!==null?(Rc===0&&(Rc=ww()),Rc):(t=Fe,t!==0||(t=window.event,t=t===void 0?16:Sw(t.type)),t):1}function Dn(t,e,n,s){if(50<Sa)throw Sa=0,Rf=null,Error(W(185));pl(t,n,s),(!(De&2)||t!==It)&&(t===It&&(!(De&2)&&(Xu|=n),wt===4&&qs(t,Ct)),rn(t,s),n===1&&De===0&&!(e.mode&1)&&(uo=ut()+500,Wu&&Tr()))}function rn(t,e){var n=t.callbackNode;v2(t,e);var s=Xc(t,t===It?Ct:0);if(s===0)n!==null&&E0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&E0(n),e===1)t.tag===0?yI(gx.bind(null,t)):Gw(gx.bind(null,t)),mI(function(){!(De&6)&&Tr()}),n=null;else{switch(bw(s)){case 1:n=Tm;break;case 4:n=yw;break;case 16:n=Yc;break;case 536870912:n=vw;break;default:n=Yc}n=qb(n,Vb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Vb(t,e){if(jc=-1,Rc=0,De&6)throw Error(W(327));var n=t.callbackNode;if(Qi()&&t.callbackNode!==n)return null;var s=Xc(t,t===It?Ct:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=pu(t,s);else{e=s;var r=De;De|=2;var i=Fb();(It!==t||Ct!==e)&&(us=null,uo=ut()+500,Hr(t,e));do try{FI();break}catch(c){Lb(t,c)}while(!0);Fm(),hu.current=i,De=r,pt!==null?e=0:(It=null,Ct=0,e=wt)}if(e!==0){if(e===2&&(r=rf(t),r!==0&&(s=r,e=Pf(t,r))),e===1)throw n=Ja,Hr(t,0),qs(t,s),rn(t,ut()),n;if(e===6)qs(t,s);else{if(r=t.current.alternate,!(s&30)&&!VI(r)&&(e=pu(t,s),e===2&&(i=rf(t),i!==0&&(s=i,e=Pf(t,i))),e===1))throw n=Ja,Hr(t,0),qs(t,s),rn(t,ut()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(W(345));case 2:Vr(t,Yt,us);break;case 3:if(qs(t,s),(s&130023424)===s&&(e=ep+500-ut(),10<e)){if(Xc(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Bt(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ff(Vr.bind(null,t,Yt,us),e);break}Vr(t,Yt,us);break;case 4:if(qs(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var a=31-Pn(s);i=1<<a,a=e[a],a>r&&(r=a),s&=~i}if(s=r,s=ut()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*OI(s/1960))-s,10<s){t.timeoutHandle=ff(Vr.bind(null,t,Yt,us),s);break}Vr(t,Yt,us);break;case 5:Vr(t,Yt,us);break;default:throw Error(W(329))}}}return rn(t,ut()),t.callbackNode===n?Vb.bind(null,t):null}function Pf(t,e){var n=Ta;return t.current.memoizedState.isDehydrated&&(Hr(t,e).flags|=256),t=pu(t,e),t!==2&&(e=Yt,Yt=n,e!==null&&Df(e)),t}function Df(t){Yt===null?Yt=t:Yt.push.apply(Yt,t)}function VI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!On(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qs(t,e){for(e&=~Zm,e&=~Xu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pn(e),s=1<<n;t[n]=-1,e&=~s}}function gx(t){if(De&6)throw Error(W(327));Qi();var e=Xc(t,0);if(!(e&1))return rn(t,ut()),null;var n=pu(t,e);if(t.tag!==0&&n===2){var s=rf(t);s!==0&&(e=s,n=Pf(t,s))}if(n===1)throw n=Ja,Hr(t,0),qs(t,e),rn(t,ut()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vr(t,Yt,us),rn(t,ut()),null}function tp(t,e){var n=De;De|=1;try{return t(e)}finally{De=n,De===0&&(uo=ut()+500,Wu&&Tr())}}function ei(t){Qs!==null&&Qs.tag===0&&!(De&6)&&Qi();var e=De;De|=1;var n=_n.transition,s=Fe;try{if(_n.transition=null,Fe=1,t)return t()}finally{Fe=s,_n.transition=n,De=e,!(De&6)&&Tr()}}function np(){an=zi.current,Xe(zi)}function Hr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,fI(n)),pt!==null)for(n=pt.return;n!==null;){var s=n;switch(Om(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&nu();break;case 3:lo(),Xe(nn),Xe(Ft),Hm();break;case 5:qm(s);break;case 4:lo();break;case 13:Xe(et);break;case 19:Xe(et);break;case 10:Um(s.type._context);break;case 22:case 23:np()}n=n.return}if(It=t,pt=t=rr(t.current,null),Ct=an=e,wt=0,Ja=null,Zm=Xu=Zr=0,Yt=Ta=null,Ur!==null){for(e=0;e<Ur.length;e++)if(n=Ur[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var a=i.next;i.next=r,s.next=a}n.pending=s}Ur=null}return t}function Lb(t,e){do{var n=pt;try{if(Fm(),kc.current=du,uu){for(var s=nt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}uu=!1}if(Jr=0,Et=vt=nt=null,Ea=!1,Qa=0,Jm.current=null,n===null||n.return===null){wt=1,Ja=e,pt=null;break}e:{var i=t,a=n.return,c=n,u=e;if(e=Ct,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=sx(a);if(y!==null){y.flags&=-257,rx(y,a,c,i,e),y.mode&1&&nx(i,d,e),e=y,u=d;var T=e.updateQueue;if(T===null){var C=new Set;C.add(u),e.updateQueue=C}else T.add(u);break e}else{if(!(e&1)){nx(i,d,e),sp();break e}u=Error(W(426))}}else if(Je&&c.mode&1){var P=sx(a);if(P!==null){!(P.flags&65536)&&(P.flags|=256),rx(P,a,c,i,e),Vm(co(u,c));break e}}i=u=co(u,c),wt!==4&&(wt=2),Ta===null?Ta=[i]:Ta.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=bb(i,u,e);Y0(i,b);break e;case 1:c=u;var E=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(nr===null||!nr.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=_b(i,c,e);Y0(i,R);break e}}i=i.return}while(i!==null)}$b(n)}catch(L){e=L,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function Fb(){var t=hu.current;return hu.current=du,t===null?du:t}function sp(){(wt===0||wt===3||wt===2)&&(wt=4),It===null||!(Zr&268435455)&&!(Xu&268435455)||qs(It,Ct)}function pu(t,e){var n=De;De|=2;var s=Fb();(It!==t||Ct!==e)&&(us=null,Hr(t,e));do try{LI();break}catch(r){Lb(t,r)}while(!0);if(Fm(),De=n,hu.current=s,pt!==null)throw Error(W(261));return It=null,Ct=0,wt}function LI(){for(;pt!==null;)Ub(pt)}function FI(){for(;pt!==null&&!u2();)Ub(pt)}function Ub(t){var e=Bb(t.alternate,t,an);t.memoizedProps=t.pendingProps,e===null?$b(t):pt=e,Jm.current=null}function $b(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RI(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,pt=null;return}}else if(n=jI(n,e,an),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);wt===0&&(wt=5)}function Vr(t,e,n){var s=Fe,r=_n.transition;try{_n.transition=null,Fe=1,UI(t,e,n,s)}finally{_n.transition=r,Fe=s}return null}function UI(t,e,n,s){do Qi();while(Qs!==null);if(De&6)throw Error(W(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(w2(t,i),t===It&&(pt=It=null,Ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||dc||(dc=!0,qb(Yc,function(){return Qi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=_n.transition,_n.transition=null;var a=Fe;Fe=1;var c=De;De|=4,Jm.current=null,DI(t,n),Mb(n,t),oI(df),Jc=!!uf,df=uf=null,t.current=n,MI(n),d2(),De=c,Fe=a,_n.transition=i}else t.current=n;if(dc&&(dc=!1,Qs=t,mu=r),i=t.pendingLanes,i===0&&(nr=null),m2(n.stateNode),rn(t,ut()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(fu)throw fu=!1,t=jf,jf=null,t;return mu&1&&t.tag!==0&&Qi(),i=t.pendingLanes,i&1?t===Rf?Sa++:(Sa=0,Rf=t):Sa=0,Tr(),null}function Qi(){if(Qs!==null){var t=bw(mu),e=_n.transition,n=Fe;try{if(_n.transition=null,Fe=16>t?16:t,Qs===null)var s=!1;else{if(t=Qs,Qs=null,mu=0,De&6)throw Error(W(331));var r=De;for(De|=4,oe=t.current;oe!==null;){var i=oe,a=i.child;if(oe.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(oe=d;oe!==null;){var f=oe;switch(f.tag){case 0:case 11:case 15:Ia(8,f,i)}var m=f.child;if(m!==null)m.return=f,oe=m;else for(;oe!==null;){f=oe;var p=f.sibling,y=f.return;if(Rb(f),f===d){oe=null;break}if(p!==null){p.return=y,oe=p;break}oe=y}}}var T=i.alternate;if(T!==null){var C=T.child;if(C!==null){T.child=null;do{var P=C.sibling;C.sibling=null,C=P}while(C!==null)}}oe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,oe=a;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ia(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,oe=b;break e}oe=i.return}}var E=t.current;for(oe=E;oe!==null;){a=oe;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,oe=S;else e:for(a=E;oe!==null;){if(c=oe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Yu(9,c)}}catch(L){ot(c,c.return,L)}if(c===a){oe=null;break e}var R=c.sibling;if(R!==null){R.return=c.return,oe=R;break e}oe=c.return}}if(De=r,Tr(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(zu,t)}catch{}s=!0}return s}finally{Fe=n,_n.transition=e}}return!1}function xx(t,e,n){e=co(n,e),e=bb(t,e,1),t=tr(t,e,1),e=Bt(),t!==null&&(pl(t,1,e),rn(t,e))}function ot(t,e,n){if(t.tag===3)xx(t,t,n);else for(;e!==null;){if(e.tag===3){xx(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(nr===null||!nr.has(s))){t=co(n,t),t=_b(e,t,1),e=tr(e,t,1),t=Bt(),e!==null&&(pl(e,1,t),rn(e,t));break}}e=e.return}}function $I(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Bt(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Ct&n)===n&&(wt===4||wt===3&&(Ct&130023424)===Ct&&500>ut()-ep?Hr(t,0):Zm|=n),rn(t,e)}function zb(t,e){e===0&&(t.mode&1?(e=tc,tc<<=1,!(tc&130023424)&&(tc=4194304)):e=1);var n=Bt();t=bs(t,e),t!==null&&(pl(t,e,n),rn(t,n))}function zI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),zb(t,n)}function BI(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(W(314))}s!==null&&s.delete(e),zb(t,n)}var Bb;Bb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nn.current)Zt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Zt=!1,AI(t,e,n);Zt=!!(t.flags&131072)}else Zt=!1,Je&&e.flags&1048576&&Ww(e,iu,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Ac(t,e),t=e.pendingProps;var r=io(e,Ft.current);Ki(e,n),r=Wm(null,e,s,t,r,n);var i=Km();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,sn(s)?(i=!0,su(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,zm(e),r.updater=Qu,e.stateNode=r,r._reactInternals=e,wf(e,s,t,n),e=Nf(null,e,s,!0,i,n)):(e.tag=0,Je&&i&&Mm(e),zt(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Ac(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=HI(s),t=Cn(s,t),r){case 0:e=_f(null,e,s,t,n);break e;case 1:e=ax(null,e,s,t,n);break e;case 11:e=ix(null,e,s,t,n);break e;case 14:e=ox(null,e,s,Cn(s.type,t),n);break e}throw Error(W(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Cn(s,r),_f(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Cn(s,r),ax(t,e,s,r,n);case 3:e:{if(Tb(e),t===null)throw Error(W(387));s=e.pendingProps,i=e.memoizedState,r=i.element,Zw(t,e),lu(e,s,null,n);var a=e.memoizedState;if(s=a.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=co(Error(W(423)),e),e=lx(t,e,s,n,r);break e}else if(s!==r){r=co(Error(W(424)),e),e=lx(t,e,s,n,r);break e}else for(ln=er(e.stateNode.containerInfo.firstChild),dn=e,Je=!0,jn=null,n=Xw(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oo(),s===r){e=_s(t,e,n);break e}zt(t,e,s,n)}e=e.child}return e;case 5:return eb(e),t===null&&xf(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,a=r.children,hf(s,r)?a=null:i!==null&&hf(s,i)&&(e.flags|=32),Ib(t,e),zt(t,e,a,n),e.child;case 6:return t===null&&xf(e),null;case 13:return Sb(t,e,n);case 4:return Bm(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ao(e,null,s,n):zt(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Cn(s,r),ix(t,e,s,r,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,a=r.value,We(ou,s._currentValue),s._currentValue=a,i!==null)if(On(i.value,a)){if(i.children===r.children&&!nn.current){e=_s(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===s){if(i.tag===1){u=xs(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),yf(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(W(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),yf(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Ki(e,n),r=En(r),s=s(r),e.flags|=1,zt(t,e,s,n),e.child;case 14:return s=e.type,r=Cn(s,e.pendingProps),r=Cn(s.type,r),ox(t,e,s,r,n);case 15:return Nb(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Cn(s,r),Ac(t,e),e.tag=1,sn(s)?(t=!0,su(e)):t=!1,Ki(e,n),wb(e,s,r),wf(e,s,r,n),Nf(null,e,s,!0,t,n);case 19:return kb(t,e,n);case 22:return Eb(t,e,n)}throw Error(W(156,e.tag))};function qb(t,e){return xw(t,e)}function qI(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(t,e,n,s){return new qI(t,e,n,s)}function rp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HI(t){if(typeof t=="function")return rp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Nm)return 11;if(t===Em)return 14}return 2}function rr(t,e){var n=t.alternate;return n===null?(n=bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pc(t,e,n,s,r,i){var a=2;if(s=t,typeof t=="function")rp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ri:return Gr(n.children,r,i,e);case _m:a=8,r|=8;break;case Bh:return t=bn(12,n,e,r|2),t.elementType=Bh,t.lanes=i,t;case qh:return t=bn(13,n,e,r),t.elementType=qh,t.lanes=i,t;case Hh:return t=bn(19,n,e,r),t.elementType=Hh,t.lanes=i,t;case ew:return Ju(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Jv:a=10;break e;case Zv:a=9;break e;case Nm:a=11;break e;case Em:a=14;break e;case Us:a=16,s=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=bn(a,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Gr(t,e,n,s){return t=bn(7,t,s,e),t.lanes=n,t}function Ju(t,e,n,s){return t=bn(22,t,s,e),t.elementType=ew,t.lanes=n,t.stateNode={isHidden:!1},t}function vh(t,e,n){return t=bn(6,t,null,e),t.lanes=n,t}function wh(t,e,n){return e=bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function GI(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=eh(0),this.expirationTimes=eh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eh(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ip(t,e,n,s,r,i,a,c,u){return t=new GI(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=bn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zm(i),t}function WI(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ji,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function Hb(t){if(!t)return fr;t=t._reactInternals;e:{if(di(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(sn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(sn(n))return Hw(t,n,e)}return e}function Gb(t,e,n,s,r,i,a,c,u){return t=ip(n,s,!0,t,r,i,a,c,u),t.context=Hb(null),n=t.current,s=Bt(),r=sr(n),i=xs(s,r),i.callback=e??null,tr(n,i,r),t.current.lanes=r,pl(t,r,s),rn(t,s),t}function Zu(t,e,n,s){var r=e.current,i=Bt(),a=sr(r);return n=Hb(n),e.context===null?e.context=n:e.pendingContext=n,e=xs(i,a),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=tr(r,e,a),t!==null&&(Dn(t,r,a,i),Sc(t,r,a)),a}function gu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function op(t,e){yx(t,e),(t=t.alternate)&&yx(t,e)}function KI(){return null}var Wb=typeof reportError=="function"?reportError:function(t){console.error(t)};function ap(t){this._internalRoot=t}ed.prototype.render=ap.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Zu(t,e,null,null)};ed.prototype.unmount=ap.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ei(function(){Zu(null,t,null,null)}),e[ws]=null}};function ed(t){this._internalRoot=t}ed.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ew();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Bs.length&&e!==0&&e<Bs[n].priority;n++);Bs.splice(n,0,t),n===0&&Tw(t)}};function lp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function td(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vx(){}function QI(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var d=gu(a);i.call(d)}}var a=Gb(e,s,t,0,null,!1,!1,"",vx);return t._reactRootContainer=a,t[ws]=a.current,qa(t.nodeType===8?t.parentNode:t),ei(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var c=s;s=function(){var d=gu(u);c.call(d)}}var u=ip(t,0,!1,null,null,!1,!1,"",vx);return t._reactRootContainer=u,t[ws]=u.current,qa(t.nodeType===8?t.parentNode:t),ei(function(){Zu(e,u,n,s)}),u}function nd(t,e,n,s,r){var i=n._reactRootContainer;if(i){var a=i;if(typeof r=="function"){var c=r;r=function(){var u=gu(a);c.call(u)}}Zu(e,a,t,r)}else a=QI(n,e,t,r,s);return gu(a)}_w=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ha(e.pendingLanes);n!==0&&(Sm(e,n|1),rn(e,ut()),!(De&6)&&(uo=ut()+500,Tr()))}break;case 13:ei(function(){var s=bs(t,1);if(s!==null){var r=Bt();Dn(s,t,1,r)}}),op(t,1)}};km=function(t){if(t.tag===13){var e=bs(t,134217728);if(e!==null){var n=Bt();Dn(e,t,134217728,n)}op(t,134217728)}};Nw=function(t){if(t.tag===13){var e=sr(t),n=bs(t,e);if(n!==null){var s=Bt();Dn(n,t,e,s)}op(t,e)}};Ew=function(){return Fe};Iw=function(t,e){var n=Fe;try{return Fe=t,e()}finally{Fe=n}};tf=function(t,e,n){switch(e){case"input":if(Kh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Gu(s);if(!r)throw Error(W(90));nw(s),Kh(s,r)}}}break;case"textarea":rw(t,n);break;case"select":e=n.value,e!=null&&qi(t,!!n.multiple,e,!1)}};dw=tp;hw=ei;var YI={usingClientEntryPoint:!1,Events:[xl,Oi,Gu,cw,uw,tp]},aa={findFiberByHostInstance:Fr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XI={bundleType:aa.bundleType,version:aa.version,rendererPackageName:aa.rendererPackageName,rendererConfig:aa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ks.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=pw(t),t===null?null:t.stateNode},findFiberByHostInstance:aa.findFiberByHostInstance||KI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hc.isDisabled&&hc.supportsFiber)try{zu=hc.inject(XI),Qn=hc}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YI;pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lp(e))throw Error(W(200));return WI(t,e,null,n)};pn.createRoot=function(t,e){if(!lp(t))throw Error(W(299));var n=!1,s="",r=Wb;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=ip(t,1,!1,null,null,n,!1,s,r),t[ws]=e.current,qa(t.nodeType===8?t.parentNode:t),new ap(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=pw(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return ei(t)};pn.hydrate=function(t,e,n){if(!td(e))throw Error(W(200));return nd(null,t,e,!0,n)};pn.hydrateRoot=function(t,e,n){if(!lp(t))throw Error(W(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",a=Wb;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Gb(e,null,t,1,n??null,r,!1,i,a),t[ws]=e.current,qa(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new ed(e)};pn.render=function(t,e,n){if(!td(e))throw Error(W(200));return nd(null,t,e,!1,n)};pn.unmountComponentAtNode=function(t){if(!td(t))throw Error(W(40));return t._reactRootContainer?(ei(function(){nd(null,null,t,!1,function(){t._reactRootContainer=null,t[ws]=null})}),!0):!1};pn.unstable_batchedUpdates=tp;pn.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!td(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return nd(t,e,n,!1,s)};pn.version="18.3.1-next-f1338f8080-20240426";function Kb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kb)}catch(t){console.error(t)}}Kb(),Kv.exports=pn;var JI=Kv.exports,wx=JI;$h.createRoot=wx.createRoot,$h.hydrateRoot=wx.hydrateRoot;function xu(){return xu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},xu.apply(this,arguments)}var bx=function(t){var e=A.useRef(t);return e.current=t,e},ZI=function(t,e){var n;return function(){for(var s=this,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];n!==null&&(clearTimeout(n),n=null),n=setTimeout(function(){return t.apply(s,i)},e)}},eT=" use-places-autocomplete: Google Maps Places API library must be loaded. See: https://github.com/wellyshen/use-places-autocomplete#load-the-library",ho=function(e){var n=e===void 0?{}:e,s=n.requestOptions,r=n.debounce,i=r===void 0?200:r,a=n.cache,c=a===void 0?24*60*60:a,u=n.cacheKey,d=u===void 0?"upa":u,f=n.googleMaps,m=n.callbackName,p=n.defaultValue,y=p===void 0?"":p,T=n.initOnMount,C=T===void 0?!0:T,P=A.useState(!1),b=P[0],E=P[1],S=A.useState(y),R=S[0],L=S[1],U=A.useState({loading:!1,status:"",data:[]}),N=U[0],x=U[1],v=A.useRef(),_=bx(s),k=bx(f),j=A.useCallback(function(){var de;if(!v.current){var $=window,J=$.google,H=k.current,ue=(H==null?void 0:H.places)||(J==null||(de=J.maps)==null?void 0:de.places);if(!ue){console.error(eT);return}v.current=new ue.AutocompleteService,E(!0)}},[k]),I=A.useCallback(function(){x({loading:!1,status:"",data:[]})},[]),ee=A.useCallback(function(de){de===void 0&&(de=d);try{sessionStorage.removeItem(de)}catch{}},[d]),ne=A.useCallback(ZI(function(de){var $;if(!de){I();return}x(function(H){return xu({},H,{loading:!0})});var J={};try{J=JSON.parse(sessionStorage.getItem(d)||"{}")}catch{}if(c&&(J=Object.keys(J).reduce(function(H,ue){return J[ue].maxAge-Date.now()>=0&&(H[ue]=J[ue]),H},{}),J[de])){x({loading:!1,status:"OK",data:J[de].data});return}($=v.current)==null||$.getPlacePredictions(xu({},_.current,{input:de}),function(H,ue){if(x({loading:!1,status:ue,data:H||[]}),c&&ue==="OK"){J[de]={data:H,maxAge:Date.now()+c*1e3};try{sessionStorage.setItem(d,JSON.stringify(J))}catch{}}})},i),[c,d,I,_]),Ne=A.useCallback(function(de,$){$===void 0&&($=!0),L(de),v.current&&$&&ne(de)},[ne]);return A.useEffect(function(){if(!C)return function(){return null};var de=window,$=de.google;return!k.current&&!($!=null&&$.maps)&&m?window[m]=j:j(),function(){window[m]&&delete window[m]}},[m,k,j,C]),{ready:b,value:R,suggestions:N,setValue:Ne,clearSuggestions:I,clearCache:ee,init:j}},tT=" use-places-autocomplete: Please provide an address when using getGeocode() with the componentRestrictions.",Qb=function(e){var n=new window.google.maps.Geocoder;return new Promise(function(s,r){n.geocode(e,function(i,a){a!=="OK"&&r(a),!e.address&&e.componentRestrictions&&(console.error(tT),s(i)),s(i)})})},Yb=function(e){var n=e.geometry.location,s=n.lat,r=n.lng;return{lat:s(),lng:r()}};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sT=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),_x=t=>{const e=sT(t);return e.charAt(0).toUpperCase()+e.slice(1)},Xb=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),rT=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=A.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:a,...c},u)=>A.createElement("svg",{ref:u,...iT,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:Xb("lucide",r),...!i&&!rT(c)&&{"aria-hidden":"true"},...c},[...a.map(([d,f])=>A.createElement(d,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=(t,e)=>{const n=A.forwardRef(({className:s,...r},i)=>A.createElement(oT,{ref:i,iconNode:e,className:Xb(`lucide-${nT(_x(t))}`,`lucide-${t}`,s),...r}));return n.displayName=_x(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],yu=ce("activity",aT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Mf=ce("arrow-left",lT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Of=ce("arrow-right",cT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ka=ce("bell",uT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],hT=ce("bookmark",dT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Yi=ce("calendar",fT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mT=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Za=ce("camera",mT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pT=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ao=ce("check",pT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gT=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Vf=ce("chevron-right",gT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xT=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Jb=ce("circle-check-big",xT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],vT=ce("circle-minus",yT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ca=ce("clock",wT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bT=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],en=ce("crown",bT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],NT=ce("ellipsis-vertical",_T);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],IT=ce("ellipsis",ET);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ST=ce("eye",TT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kT=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],cp=ce("file-text",kT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],AT=ce("flag",CT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],el=ce("flame",jT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],PT=ce("funnel",RT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],up=ce("heart",DT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Nx=ce("house",MT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],VT=ce("image",OT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],FT=ce("info",LT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],$T=ce("link",UT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],BT=ce("list",zT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],jo=ce("loader-circle",qT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],GT=ce("lock",HT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Ex=ce("log-in",WT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ix=ce("log-out",KT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ve=ce("map-pin",QT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],mr=ce("message-circle",YT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],vu=ce("message-square",XT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],ZT=ce("mic-vocal",JT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],tS=ce("music",eS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],tl=ce("navigation",nS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],rS=ce("octagon-alert",sS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],oS=ce("party-popper",iS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lS=ce("pen",aS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pr=ce("plus",cS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],dS=ce("refresh-cw",uS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],bh=ce("save",hS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ti=ce("search",fS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],dp=ce("send",mS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gS=ce("settings",pS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Xi=ce("share-2",xS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],tn=ce("shield",yS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Bi=ce("sparkles",vS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Tx=ce("square-pen",wS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Zb=ce("star",bS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],NS=ce("ticket",_S);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Lf=ce("trash-2",ES);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Xn=ce("trending-up",IS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fo=ce("triangle-alert",TS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],kS=ce("user-check",SS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],e_=ce("user-plus",CS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Sx=ce("user",AS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xt=ce("users",jS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],PS=ce("utensils",RS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$e=ce("x",DS);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],sd=ce("zap",MS),OS=()=>{};var kx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},VS=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],a=t[n++],c=t[n++],u=((r&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},n_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],a=r+1<t.length,c=a?t[r+1]:0,u=r+2<t.length,d=u?t[r+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let p=(c&15)<<2|d>>6,y=d&63;u||(y=64,a||(p=64)),s.push(n[f],n[m],n[p],n[y])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(t_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):VS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],c=r<t.length?n[t.charAt(r)]:0;++r;const d=r<t.length?n[t.charAt(r)]:64;++r;const m=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||c==null||d==null||m==null)throw new LS;const p=i<<2|c>>4;if(s.push(p),d!==64){const y=c<<4&240|d>>2;if(s.push(y),m!==64){const T=d<<6&192|m;s.push(T)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class LS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FS=function(t){const e=t_(t);return n_.encodeByteArray(e,!0)},wu=function(t){return FS(t).replace(/\./g,"")},s_=function(t){try{return n_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=()=>US().__FIREBASE_DEFAULTS__,zS=()=>{if(typeof process>"u"||typeof kx>"u")return;const t=kx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&s_(t[1]);return e&&JSON.parse(e)},rd=()=>{try{return OS()||$S()||zS()||BS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},r_=t=>{var e,n;return(n=(e=rd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},qS=t=>{const e=r_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},i_=()=>{var t;return(t=rd())==null?void 0:t.config},o_=t=>{var e;return(e=rd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function a_(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[wu(JSON.stringify(n)),wu(JSON.stringify(a)),""].join(".")}const Aa={};function WS(){const t={prod:[],emulator:[]};for(const e of Object.keys(Aa))Aa[e]?t.emulator.push(e):t.prod.push(e);return t}function KS(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Cx=!1;function l_(t,e){if(typeof window>"u"||typeof document>"u"||!Ro(window.location.host)||Aa[t]===e||Aa[t]||Cx)return;Aa[t]=e;function n(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=WS().prod.length>0;function a(){const p=document.getElementById(s);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,y){p.setAttribute("width","24"),p.setAttribute("id",y),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Cx=!0,a()},p}function f(p,y){p.setAttribute("id",y),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=KS(s),y=n("text"),T=document.getElementById(y)||document.createElement("span"),C=n("learnmore"),P=document.getElementById(C)||document.createElement("a"),b=n("preprendIcon"),E=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const S=p.element;c(S),f(P,C);const R=d();u(E,b),S.append(E,T,P,R),document.body.appendChild(S)}i?(T.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ut())}function YS(){var e;const t=(e=rd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function c_(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function JS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZS(){const t=Ut();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ek(){return!YS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function u_(){try{return typeof indexedDB=="object"}catch{return!1}}function d_(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function tk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk="FirebaseError";class Fn extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=nk,Object.setPrototypeOf(this,Fn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hi.prototype.create)}}class hi{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?sk(i,s):"Error",c=`${this.serviceName}: ${a} (${r}).`;return new Fn(r,c,s)}}function sk(t,e){return t.replace(rk,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const rk=/\{\$([^}]+)}/g;function ik(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ss(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],a=e[r];if(Ax(i)&&Ax(a)){if(!ss(i,a))return!1}else if(i!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Ax(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function ok(t,e){const n=new ak(t,e);return n.subscribe.bind(n)}class ak{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");lk(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=_h),r.error===void 0&&(r.error=_h),r.complete===void 0&&(r.complete=_h);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function _h(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=1e3,uk=2,dk=4*60*60*1e3,hk=.5;function jx(t,e=ck,n=uk){const s=e*Math.pow(n,t),r=Math.round(hk*s*(Math.random()-.5)*2);return Math.min(dk,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t){return t&&t._delegate?t._delegate:t}class Vn{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new HS;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pk(e))try{this.getOrInitializeService({instanceIdentifier:Lr})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Lr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lr){return this.instances.has(e)}getOptions(e=Lr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);s===c&&a.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:mk(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Lr){return this.component?this.component.multipleInstances?e:Lr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mk(t){return t===Lr?void 0:t}function pk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new fk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ke||(ke={}));const xk={debug:ke.DEBUG,verbose:ke.VERBOSE,info:ke.INFO,warn:ke.WARN,error:ke.ERROR,silent:ke.SILENT},yk=ke.INFO,vk={[ke.DEBUG]:"log",[ke.VERBOSE]:"log",[ke.INFO]:"info",[ke.WARN]:"warn",[ke.ERROR]:"error"},wk=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=vk[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class id{constructor(e){this.name=e,this._logLevel=yk,this._logHandler=wk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ke.DEBUG,...e),this._logHandler(this,ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ke.VERBOSE,...e),this._logHandler(this,ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ke.INFO,...e),this._logHandler(this,ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ke.WARN,...e),this._logHandler(this,ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ke.ERROR,...e),this._logHandler(this,ke.ERROR,...e)}}const bk=(t,e)=>e.some(n=>t instanceof n);let Rx,Px;function _k(){return Rx||(Rx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Nk(){return Px||(Px=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h_=new WeakMap,Ff=new WeakMap,f_=new WeakMap,Nh=new WeakMap,hp=new WeakMap;function Ek(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(ir(t.result)),r()},a=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&h_.set(n,t)}).catch(()=>{}),hp.set(e,t),e}function Ik(t){if(Ff.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),r()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Ff.set(t,e)}let Uf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ff.get(t);if(e==="objectStoreNames")return t.objectStoreNames||f_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ir(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Tk(t){Uf=t(Uf)}function Sk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Eh(this),e,...n);return f_.set(s,e.sort?e.sort():[e]),ir(s)}:Nk().includes(t)?function(...e){return t.apply(Eh(this),e),ir(h_.get(this))}:function(...e){return ir(t.apply(Eh(this),e))}}function kk(t){return typeof t=="function"?Sk(t):(t instanceof IDBTransaction&&Ik(t),bk(t,_k())?new Proxy(t,Uf):t)}function ir(t){if(t instanceof IDBRequest)return Ek(t);if(Nh.has(t))return Nh.get(t);const e=kk(t);return e!==t&&(Nh.set(t,e),hp.set(e,t)),e}const Eh=t=>hp.get(t);function m_(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(t,e),c=ir(a);return s&&a.addEventListener("upgradeneeded",u=>{s(ir(a.result),u.oldVersion,u.newVersion,ir(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const Ck=["get","getKey","getAll","getAllKeys","count"],Ak=["put","add","delete","clear"],Ih=new Map;function Dx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ih.get(e))return Ih.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=Ak.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||Ck.includes(n)))return;const i=async function(a,...c){const u=this.transaction(a,r?"readwrite":"readonly");let d=u.store;return s&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),r&&u.done]))[0]};return Ih.set(e,i),i}Tk(t=>({...t,get:(e,n,s)=>Dx(e,n)||t.get(e,n,s),has:(e,n)=>!!Dx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Rk(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Rk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $f="@firebase/app",Mx="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new id("@firebase/app"),Pk="@firebase/app-compat",Dk="@firebase/analytics-compat",Mk="@firebase/analytics",Ok="@firebase/app-check-compat",Vk="@firebase/app-check",Lk="@firebase/auth",Fk="@firebase/auth-compat",Uk="@firebase/database",$k="@firebase/data-connect",zk="@firebase/database-compat",Bk="@firebase/functions",qk="@firebase/functions-compat",Hk="@firebase/installations",Gk="@firebase/installations-compat",Wk="@firebase/messaging",Kk="@firebase/messaging-compat",Qk="@firebase/performance",Yk="@firebase/performance-compat",Xk="@firebase/remote-config",Jk="@firebase/remote-config-compat",Zk="@firebase/storage",eC="@firebase/storage-compat",tC="@firebase/firestore",nC="@firebase/ai",sC="@firebase/firestore-compat",rC="firebase",iC="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="[DEFAULT]",oC={[$f]:"fire-core",[Pk]:"fire-core-compat",[Mk]:"fire-analytics",[Dk]:"fire-analytics-compat",[Vk]:"fire-app-check",[Ok]:"fire-app-check-compat",[Lk]:"fire-auth",[Fk]:"fire-auth-compat",[Uk]:"fire-rtdb",[$k]:"fire-data-connect",[zk]:"fire-rtdb-compat",[Bk]:"fire-fn",[qk]:"fire-fn-compat",[Hk]:"fire-iid",[Gk]:"fire-iid-compat",[Wk]:"fire-fcm",[Kk]:"fire-fcm-compat",[Qk]:"fire-perf",[Yk]:"fire-perf-compat",[Xk]:"fire-rc",[Jk]:"fire-rc-compat",[Zk]:"fire-gcs",[eC]:"fire-gcs-compat",[tC]:"fire-fst",[sC]:"fire-fst-compat",[nC]:"fire-vertex","fire-js":"fire-js",[rC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=new Map,aC=new Map,Bf=new Map;function Ox(t,e){try{t.container.addComponent(e)}catch(n){Ns.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function rs(t){const e=t.name;if(Bf.has(e))return Ns.debug(`There were multiple attempts to register component ${e}.`),!1;Bf.set(e,t);for(const n of bu.values())Ox(n,t);for(const n of aC.values())Ox(n,t);return!0}function fi(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function vn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},or=new hi("app","Firebase",lC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Vn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw or.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=iC;function p_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:zf,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw or.create("bad-app-name",{appName:String(r)});if(n||(n=i_()),!n)throw or.create("no-options");const i=bu.get(r);if(i){if(ss(n,i.options)&&ss(s,i.config))return i;throw or.create("duplicate-app",{appName:r})}const a=new gk(r);for(const u of Bf.values())a.addComponent(u);const c=new cC(n,s,a);return bu.set(r,c),c}function fp(t=zf){const e=bu.get(t);if(!e&&t===zf&&i_())return p_();if(!e)throw or.create("no-app",{appName:t});return e}function Nn(t,e,n){let s=oC[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ns.warn(a.join(" "));return}rs(new Vn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="firebase-heartbeat-database",dC=1,nl="firebase-heartbeat-store";let Th=null;function g_(){return Th||(Th=m_(uC,dC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(nl)}catch(n){console.warn(n)}}}}).catch(t=>{throw or.create("idb-open",{originalErrorMessage:t.message})})),Th}async function hC(t){try{const n=(await g_()).transaction(nl),s=await n.objectStore(nl).get(x_(t));return await n.done,s}catch(e){if(e instanceof Fn)Ns.warn(e.message);else{const n=or.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ns.warn(n.message)}}}async function Vx(t,e){try{const s=(await g_()).transaction(nl,"readwrite");await s.objectStore(nl).put(e,x_(t)),await s.done}catch(n){if(n instanceof Fn)Ns.warn(n.message);else{const s=or.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ns.warn(s.message)}}}function x_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=1024,mC=30;class pC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xC(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Lx();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>mC){const a=yC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Ns.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Lx(),{heartbeatsToSend:s,unsentEntries:r}=gC(this._heartbeatsCache.heartbeats),i=wu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Ns.warn(n),""}}}function Lx(){return new Date().toISOString().substring(0,10)}function gC(t,e=fC){const n=[];let s=t.slice();for(const r of t){const i=n.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),Fx(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Fx(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class xC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return u_()?d_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await hC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Vx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Vx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Fx(t){return wu(JSON.stringify({version:2,heartbeats:t})).length}function yC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(t){rs(new Vn("platform-logger",e=>new jk(e),"PRIVATE")),rs(new Vn("heartbeat",e=>new pC(e),"PRIVATE")),Nn($f,Mx,t),Nn($f,Mx,"esm2020"),Nn("fire-js","")}vC("");var Ux=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ar,y_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,x){function v(){}v.prototype=x.prototype,N.F=x.prototype,N.prototype=new v,N.prototype.constructor=N,N.D=function(_,k,j){for(var I=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)I[ee-2]=arguments[ee];return x.prototype[k].apply(_,I)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(N,x,v){v||(v=0);const _=Array(16);if(typeof x=="string")for(var k=0;k<16;++k)_[k]=x.charCodeAt(v++)|x.charCodeAt(v++)<<8|x.charCodeAt(v++)<<16|x.charCodeAt(v++)<<24;else for(k=0;k<16;++k)_[k]=x[v++]|x[v++]<<8|x[v++]<<16|x[v++]<<24;x=N.g[0],v=N.g[1],k=N.g[2];let j=N.g[3],I;I=x+(j^v&(k^j))+_[0]+3614090360&4294967295,x=v+(I<<7&4294967295|I>>>25),I=j+(k^x&(v^k))+_[1]+3905402710&4294967295,j=x+(I<<12&4294967295|I>>>20),I=k+(v^j&(x^v))+_[2]+606105819&4294967295,k=j+(I<<17&4294967295|I>>>15),I=v+(x^k&(j^x))+_[3]+3250441966&4294967295,v=k+(I<<22&4294967295|I>>>10),I=x+(j^v&(k^j))+_[4]+4118548399&4294967295,x=v+(I<<7&4294967295|I>>>25),I=j+(k^x&(v^k))+_[5]+1200080426&4294967295,j=x+(I<<12&4294967295|I>>>20),I=k+(v^j&(x^v))+_[6]+2821735955&4294967295,k=j+(I<<17&4294967295|I>>>15),I=v+(x^k&(j^x))+_[7]+4249261313&4294967295,v=k+(I<<22&4294967295|I>>>10),I=x+(j^v&(k^j))+_[8]+1770035416&4294967295,x=v+(I<<7&4294967295|I>>>25),I=j+(k^x&(v^k))+_[9]+2336552879&4294967295,j=x+(I<<12&4294967295|I>>>20),I=k+(v^j&(x^v))+_[10]+4294925233&4294967295,k=j+(I<<17&4294967295|I>>>15),I=v+(x^k&(j^x))+_[11]+2304563134&4294967295,v=k+(I<<22&4294967295|I>>>10),I=x+(j^v&(k^j))+_[12]+1804603682&4294967295,x=v+(I<<7&4294967295|I>>>25),I=j+(k^x&(v^k))+_[13]+4254626195&4294967295,j=x+(I<<12&4294967295|I>>>20),I=k+(v^j&(x^v))+_[14]+2792965006&4294967295,k=j+(I<<17&4294967295|I>>>15),I=v+(x^k&(j^x))+_[15]+1236535329&4294967295,v=k+(I<<22&4294967295|I>>>10),I=x+(k^j&(v^k))+_[1]+4129170786&4294967295,x=v+(I<<5&4294967295|I>>>27),I=j+(v^k&(x^v))+_[6]+3225465664&4294967295,j=x+(I<<9&4294967295|I>>>23),I=k+(x^v&(j^x))+_[11]+643717713&4294967295,k=j+(I<<14&4294967295|I>>>18),I=v+(j^x&(k^j))+_[0]+3921069994&4294967295,v=k+(I<<20&4294967295|I>>>12),I=x+(k^j&(v^k))+_[5]+3593408605&4294967295,x=v+(I<<5&4294967295|I>>>27),I=j+(v^k&(x^v))+_[10]+38016083&4294967295,j=x+(I<<9&4294967295|I>>>23),I=k+(x^v&(j^x))+_[15]+3634488961&4294967295,k=j+(I<<14&4294967295|I>>>18),I=v+(j^x&(k^j))+_[4]+3889429448&4294967295,v=k+(I<<20&4294967295|I>>>12),I=x+(k^j&(v^k))+_[9]+568446438&4294967295,x=v+(I<<5&4294967295|I>>>27),I=j+(v^k&(x^v))+_[14]+3275163606&4294967295,j=x+(I<<9&4294967295|I>>>23),I=k+(x^v&(j^x))+_[3]+4107603335&4294967295,k=j+(I<<14&4294967295|I>>>18),I=v+(j^x&(k^j))+_[8]+1163531501&4294967295,v=k+(I<<20&4294967295|I>>>12),I=x+(k^j&(v^k))+_[13]+2850285829&4294967295,x=v+(I<<5&4294967295|I>>>27),I=j+(v^k&(x^v))+_[2]+4243563512&4294967295,j=x+(I<<9&4294967295|I>>>23),I=k+(x^v&(j^x))+_[7]+1735328473&4294967295,k=j+(I<<14&4294967295|I>>>18),I=v+(j^x&(k^j))+_[12]+2368359562&4294967295,v=k+(I<<20&4294967295|I>>>12),I=x+(v^k^j)+_[5]+4294588738&4294967295,x=v+(I<<4&4294967295|I>>>28),I=j+(x^v^k)+_[8]+2272392833&4294967295,j=x+(I<<11&4294967295|I>>>21),I=k+(j^x^v)+_[11]+1839030562&4294967295,k=j+(I<<16&4294967295|I>>>16),I=v+(k^j^x)+_[14]+4259657740&4294967295,v=k+(I<<23&4294967295|I>>>9),I=x+(v^k^j)+_[1]+2763975236&4294967295,x=v+(I<<4&4294967295|I>>>28),I=j+(x^v^k)+_[4]+1272893353&4294967295,j=x+(I<<11&4294967295|I>>>21),I=k+(j^x^v)+_[7]+4139469664&4294967295,k=j+(I<<16&4294967295|I>>>16),I=v+(k^j^x)+_[10]+3200236656&4294967295,v=k+(I<<23&4294967295|I>>>9),I=x+(v^k^j)+_[13]+681279174&4294967295,x=v+(I<<4&4294967295|I>>>28),I=j+(x^v^k)+_[0]+3936430074&4294967295,j=x+(I<<11&4294967295|I>>>21),I=k+(j^x^v)+_[3]+3572445317&4294967295,k=j+(I<<16&4294967295|I>>>16),I=v+(k^j^x)+_[6]+76029189&4294967295,v=k+(I<<23&4294967295|I>>>9),I=x+(v^k^j)+_[9]+3654602809&4294967295,x=v+(I<<4&4294967295|I>>>28),I=j+(x^v^k)+_[12]+3873151461&4294967295,j=x+(I<<11&4294967295|I>>>21),I=k+(j^x^v)+_[15]+530742520&4294967295,k=j+(I<<16&4294967295|I>>>16),I=v+(k^j^x)+_[2]+3299628645&4294967295,v=k+(I<<23&4294967295|I>>>9),I=x+(k^(v|~j))+_[0]+4096336452&4294967295,x=v+(I<<6&4294967295|I>>>26),I=j+(v^(x|~k))+_[7]+1126891415&4294967295,j=x+(I<<10&4294967295|I>>>22),I=k+(x^(j|~v))+_[14]+2878612391&4294967295,k=j+(I<<15&4294967295|I>>>17),I=v+(j^(k|~x))+_[5]+4237533241&4294967295,v=k+(I<<21&4294967295|I>>>11),I=x+(k^(v|~j))+_[12]+1700485571&4294967295,x=v+(I<<6&4294967295|I>>>26),I=j+(v^(x|~k))+_[3]+2399980690&4294967295,j=x+(I<<10&4294967295|I>>>22),I=k+(x^(j|~v))+_[10]+4293915773&4294967295,k=j+(I<<15&4294967295|I>>>17),I=v+(j^(k|~x))+_[1]+2240044497&4294967295,v=k+(I<<21&4294967295|I>>>11),I=x+(k^(v|~j))+_[8]+1873313359&4294967295,x=v+(I<<6&4294967295|I>>>26),I=j+(v^(x|~k))+_[15]+4264355552&4294967295,j=x+(I<<10&4294967295|I>>>22),I=k+(x^(j|~v))+_[6]+2734768916&4294967295,k=j+(I<<15&4294967295|I>>>17),I=v+(j^(k|~x))+_[13]+1309151649&4294967295,v=k+(I<<21&4294967295|I>>>11),I=x+(k^(v|~j))+_[4]+4149444226&4294967295,x=v+(I<<6&4294967295|I>>>26),I=j+(v^(x|~k))+_[11]+3174756917&4294967295,j=x+(I<<10&4294967295|I>>>22),I=k+(x^(j|~v))+_[2]+718787259&4294967295,k=j+(I<<15&4294967295|I>>>17),I=v+(j^(k|~x))+_[9]+3951481745&4294967295,N.g[0]=N.g[0]+x&4294967295,N.g[1]=N.g[1]+(k+(I<<21&4294967295|I>>>11))&4294967295,N.g[2]=N.g[2]+k&4294967295,N.g[3]=N.g[3]+j&4294967295}s.prototype.v=function(N,x){x===void 0&&(x=N.length);const v=x-this.blockSize,_=this.C;let k=this.h,j=0;for(;j<x;){if(k==0)for(;j<=v;)r(this,N,j),j+=this.blockSize;if(typeof N=="string"){for(;j<x;)if(_[k++]=N.charCodeAt(j++),k==this.blockSize){r(this,_),k=0;break}}else for(;j<x;)if(_[k++]=N[j++],k==this.blockSize){r(this,_),k=0;break}}this.h=k,this.o+=x},s.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var x=1;x<N.length-8;++x)N[x]=0;x=this.o*8;for(var v=N.length-8;v<N.length;++v)N[v]=x&255,x/=256;for(this.v(N),N=Array(16),x=0,v=0;v<4;++v)for(let _=0;_<32;_+=8)N[x++]=this.g[v]>>>_&255;return N};function i(N,x){var v=c;return Object.prototype.hasOwnProperty.call(v,N)?v[N]:v[N]=x(N)}function a(N,x){this.h=x;const v=[];let _=!0;for(let k=N.length-1;k>=0;k--){const j=N[k]|0;_&&j==x||(v[k]=j,_=!1)}this.g=v}var c={};function u(N){return-128<=N&&N<128?i(N,function(x){return new a([x|0],x<0?-1:0)}):new a([N|0],N<0?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return m;if(N<0)return P(d(-N));const x=[];let v=1;for(let _=0;N>=v;_++)x[_]=N/v|0,v*=4294967296;return new a(x,0)}function f(N,x){if(N.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(N.charAt(0)=="-")return P(f(N.substring(1),x));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=d(Math.pow(x,8));let _=m;for(let j=0;j<N.length;j+=8){var k=Math.min(8,N.length-j);const I=parseInt(N.substring(j,j+k),x);k<8?(k=d(Math.pow(x,k)),_=_.j(k).add(d(I))):(_=_.j(v),_=_.add(d(I)))}return _}var m=u(0),p=u(1),y=u(16777216);t=a.prototype,t.m=function(){if(C(this))return-P(this).m();let N=0,x=1;for(let v=0;v<this.g.length;v++){const _=this.i(v);N+=(_>=0?_:4294967296+_)*x,x*=4294967296}return N},t.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(T(this))return"0";if(C(this))return"-"+P(this).toString(N);const x=d(Math.pow(N,6));var v=this;let _="";for(;;){const k=R(v,x).g;v=b(v,k.j(x));let j=((v.g.length>0?v.g[0]:v.h)>>>0).toString(N);if(v=k,T(v))return j+_;for(;j.length<6;)j="0"+j;_=j+_}},t.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function T(N){if(N.h!=0)return!1;for(let x=0;x<N.g.length;x++)if(N.g[x]!=0)return!1;return!0}function C(N){return N.h==-1}t.l=function(N){return N=b(this,N),C(N)?-1:T(N)?0:1};function P(N){const x=N.g.length,v=[];for(let _=0;_<x;_++)v[_]=~N.g[_];return new a(v,~N.h).add(p)}t.abs=function(){return C(this)?P(this):this},t.add=function(N){const x=Math.max(this.g.length,N.g.length),v=[];let _=0;for(let k=0;k<=x;k++){let j=_+(this.i(k)&65535)+(N.i(k)&65535),I=(j>>>16)+(this.i(k)>>>16)+(N.i(k)>>>16);_=I>>>16,j&=65535,I&=65535,v[k]=I<<16|j}return new a(v,v[v.length-1]&-2147483648?-1:0)};function b(N,x){return N.add(P(x))}t.j=function(N){if(T(this)||T(N))return m;if(C(this))return C(N)?P(this).j(P(N)):P(P(this).j(N));if(C(N))return P(this.j(P(N)));if(this.l(y)<0&&N.l(y)<0)return d(this.m()*N.m());const x=this.g.length+N.g.length,v=[];for(var _=0;_<2*x;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(let k=0;k<N.g.length;k++){const j=this.i(_)>>>16,I=this.i(_)&65535,ee=N.i(k)>>>16,ne=N.i(k)&65535;v[2*_+2*k]+=I*ne,E(v,2*_+2*k),v[2*_+2*k+1]+=j*ne,E(v,2*_+2*k+1),v[2*_+2*k+1]+=I*ee,E(v,2*_+2*k+1),v[2*_+2*k+2]+=j*ee,E(v,2*_+2*k+2)}for(N=0;N<x;N++)v[N]=v[2*N+1]<<16|v[2*N];for(N=x;N<2*x;N++)v[N]=0;return new a(v,0)};function E(N,x){for(;(N[x]&65535)!=N[x];)N[x+1]+=N[x]>>>16,N[x]&=65535,x++}function S(N,x){this.g=N,this.h=x}function R(N,x){if(T(x))throw Error("division by zero");if(T(N))return new S(m,m);if(C(N))return x=R(P(N),x),new S(P(x.g),P(x.h));if(C(x))return x=R(N,P(x)),new S(P(x.g),x.h);if(N.g.length>30){if(C(N)||C(x))throw Error("slowDivide_ only works with positive integers.");for(var v=p,_=x;_.l(N)<=0;)v=L(v),_=L(_);var k=U(v,1),j=U(_,1);for(_=U(_,2),v=U(v,2);!T(_);){var I=j.add(_);I.l(N)<=0&&(k=k.add(v),j=I),_=U(_,1),v=U(v,1)}return x=b(N,k.j(x)),new S(k,x)}for(k=m;N.l(x)>=0;){for(v=Math.max(1,Math.floor(N.m()/x.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=_<=48?1:Math.pow(2,_-48),j=d(v),I=j.j(x);C(I)||I.l(N)>0;)v-=_,j=d(v),I=j.j(x);T(j)&&(j=p),k=k.add(j),N=b(N,I)}return new S(k,N)}t.B=function(N){return R(this,N).h},t.and=function(N){const x=Math.max(this.g.length,N.g.length),v=[];for(let _=0;_<x;_++)v[_]=this.i(_)&N.i(_);return new a(v,this.h&N.h)},t.or=function(N){const x=Math.max(this.g.length,N.g.length),v=[];for(let _=0;_<x;_++)v[_]=this.i(_)|N.i(_);return new a(v,this.h|N.h)},t.xor=function(N){const x=Math.max(this.g.length,N.g.length),v=[];for(let _=0;_<x;_++)v[_]=this.i(_)^N.i(_);return new a(v,this.h^N.h)};function L(N){const x=N.g.length+1,v=[];for(let _=0;_<x;_++)v[_]=N.i(_)<<1|N.i(_-1)>>>31;return new a(v,N.h)}function U(N,x){const v=x>>5;x%=32;const _=N.g.length-v,k=[];for(let j=0;j<_;j++)k[j]=x>0?N.i(j+v)>>>x|N.i(j+v+1)<<32-x:N.i(j+v);return new a(k,N.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,y_=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,ar=a}).apply(typeof Ux<"u"?Ux:typeof self<"u"?self:typeof window<"u"?window:{});var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var v_,ma,w_,Dc,qf,b_,__,N_;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof fc=="object"&&fc];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(l,h){if(h)e:{var g=s;l=l.split(".");for(var w=0;w<l.length-1;w++){var D=l[w];if(!(D in g))break e;g=g[D]}l=l[l.length-1],w=g[l],h=h(w),h!=w&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}r("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(l){return l||function(h){var g=[],w;for(w in h)Object.prototype.hasOwnProperty.call(h,w)&&g.push([w,h[w]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,g){return l.call.apply(l.bind,arguments)}function d(l,h,g){return d=u,d.apply(null,arguments)}function f(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var w=g.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function m(l,h){function g(){}g.prototype=h.prototype,l.Z=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(w,D,V){for(var X=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)X[_e-2]=arguments[_e];return h.prototype[D].apply(w,X)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function y(l){const h=l.length;if(h>0){const g=Array(h);for(let w=0;w<h;w++)g[w]=l[w];return g}return[]}function T(l,h){for(let w=1;w<arguments.length;w++){const D=arguments[w];var g=typeof D;if(g=g!="object"?g:D?Array.isArray(D)?"array":g:"null",g=="array"||g=="object"&&typeof D.length=="number"){g=l.length||0;const V=D.length||0;l.length=g+V;for(let X=0;X<V;X++)l[g+X]=D[X]}else l.push(D)}}class C{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function P(l){a.setTimeout(()=>{throw l},0)}function b(){var l=N;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class E{constructor(){this.h=this.g=null}add(h,g){const w=S.get();w.set(h,g),this.h?this.h.next=w:this.g=w,this.h=w}}var S=new C(()=>new R,l=>l.reset());class R{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let L,U=!1,N=new E,x=()=>{const l=Promise.resolve(void 0);L=()=>{l.then(v)}};function v(){for(var l;l=b();){try{l.h.call(l.g)}catch(g){P(g)}var h=S;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}U=!1}function _(){this.u=this.u,this.C=this.C}_.prototype.u=!1,_.prototype.dispose=function(){this.u||(this.u=!0,this.N())},_.prototype[Symbol.dispose]=function(){this.dispose()},_.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,h),a.removeEventListener("test",g,h)}catch{}return l}();function I(l){return/^[\s\xa0]*$/.test(l)}function ee(l,h){k.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}m(ee,k),ee.prototype.init=function(l,h){const g=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&ee.Z.h.call(this)},ee.prototype.h=function(){ee.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ne="closure_listenable_"+(Math.random()*1e6|0),Ne=0;function de(l,h,g,w,D){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!w,this.ha=D,this.key=++Ne,this.da=this.fa=!1}function $(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function J(l,h,g){for(const w in l)h.call(g,l[w],w,l)}function H(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function ue(l){const h={};for(const g in l)h[g]=l[g];return h}const me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(l,h){let g,w;for(let D=1;D<arguments.length;D++){w=arguments[D];for(g in w)l[g]=w[g];for(let V=0;V<me.length;V++)g=me[V],Object.prototype.hasOwnProperty.call(w,g)&&(l[g]=w[g])}}function Te(l){this.src=l,this.g={},this.h=0}Te.prototype.add=function(l,h,g,w,D){const V=l.toString();l=this.g[V],l||(l=this.g[V]=[],this.h++);const X=O(l,h,w,D);return X>-1?(h=l[X],g||(h.fa=!1)):(h=new de(h,this.src,V,!!w,D),h.fa=g,l.push(h)),h};function ae(l,h){const g=h.type;if(g in l.g){var w=l.g[g],D=Array.prototype.indexOf.call(w,h,void 0),V;(V=D>=0)&&Array.prototype.splice.call(w,D,1),V&&($(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function O(l,h,g,w){for(let D=0;D<l.length;++D){const V=l[D];if(!V.da&&V.listener==h&&V.capture==!!g&&V.ha==w)return D}return-1}var K="closure_lm_"+(Math.random()*1e6|0),te={};function xe(l,h,g,w,D){if(Array.isArray(h)){for(let V=0;V<h.length;V++)xe(l,h[V],g,w,D);return null}return g=we(g),l&&l[ne]?l.J(h,g,c(w)?!!w.capture:!1,D):Se(l,h,g,!1,w,D)}function Se(l,h,g,w,D,V){if(!h)throw Error("Invalid event type");const X=c(D)?!!D.capture:!!D;let _e=q(l);if(_e||(l[K]=_e=new Te(l)),g=_e.add(h,g,w,X,V),g.proxy)return g;if(w=B(),g.proxy=w,w.src=l,w.listener=g,l.addEventListener)j||(D=X),D===void 0&&(D=!1),l.addEventListener(h.toString(),w,D);else if(l.attachEvent)l.attachEvent(M(h.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return g}function B(){function l(g){return h.call(l.src,l.listener,g)}const h=se;return l}function Z(l,h,g,w,D){if(Array.isArray(h))for(var V=0;V<h.length;V++)Z(l,h[V],g,w,D);else w=c(w)?!!w.capture:!!w,g=we(g),l&&l[ne]?(l=l.i,V=String(h).toString(),V in l.g&&(h=l.g[V],g=O(h,g,w,D),g>-1&&($(h[g]),Array.prototype.splice.call(h,g,1),h.length==0&&(delete l.g[V],l.h--)))):l&&(l=q(l))&&(h=l.g[h.toString()],l=-1,h&&(l=O(h,g,w,D)),(g=l>-1?h[l]:null)&&Q(g))}function Q(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ne])ae(h.i,l);else{var g=l.type,w=l.proxy;h.removeEventListener?h.removeEventListener(g,w,l.capture):h.detachEvent?h.detachEvent(M(g),w):h.addListener&&h.removeListener&&h.removeListener(w),(g=q(h))?(ae(g,l),g.h==0&&(g.src=null,h[K]=null)):$(l)}}}function M(l){return l in te?te[l]:te[l]="on"+l}function se(l,h){if(l.da)l=!0;else{h=new ee(h,this);const g=l.listener,w=l.ha||l.src;l.fa&&Q(l),l=g.call(w,h)}return l}function q(l){return l=l[K],l instanceof Te?l:null}var ie="__closure_events_fn_"+(Math.random()*1e9>>>0);function we(l){return typeof l=="function"?l:(l[ie]||(l[ie]=function(h){return l.handleEvent(h)}),l[ie])}function pe(){_.call(this),this.i=new Te(this),this.M=this,this.G=null}m(pe,_),pe.prototype[ne]=!0,pe.prototype.removeEventListener=function(l,h,g,w){Z(this,l,h,g,w)};function Oe(l,h){var g,w=l.G;if(w)for(g=[];w;w=w.G)g.push(w);if(l=l.M,w=h.type||h,typeof h=="string")h=new k(h,l);else if(h instanceof k)h.target=h.target||l;else{var D=h;h=new k(w,l),je(h,D)}D=!0;let V,X;if(g)for(X=g.length-1;X>=0;X--)V=h.g=g[X],D=Ge(V,w,!0,h)&&D;if(V=h.g=l,D=Ge(V,w,!0,h)&&D,D=Ge(V,w,!1,h)&&D,g)for(X=0;X<g.length;X++)V=h.g=g[X],D=Ge(V,w,!1,h)&&D}pe.prototype.N=function(){if(pe.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const g=l.g[h];for(let w=0;w<g.length;w++)$(g[w]);delete l.g[h],l.h--}}this.G=null},pe.prototype.J=function(l,h,g,w){return this.i.add(String(l),h,!1,g,w)},pe.prototype.K=function(l,h,g,w){return this.i.add(String(l),h,!0,g,w)};function Ge(l,h,g,w){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let D=!0;for(let V=0;V<h.length;++V){const X=h[V];if(X&&!X.da&&X.capture==g){const _e=X.listener,yt=X.ha||X.src;X.fa&&ae(l.i,X),D=_e.call(yt,w)!==!1&&D}}return D&&!w.defaultPrevented}function Tn(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:a.setTimeout(l,h||0)}function lt(l){l.g=Tn(()=>{l.g=null,l.i&&(l.i=!1,lt(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Ml extends _{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:lt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(l){_.call(this),this.h=l,this.g={}}m($t,_);var Cr=[];function Ar(l){J(l.g,function(h,g){this.g.hasOwnProperty(g)&&Q(h)},l),l.g={}}$t.prototype.N=function(){$t.Z.N.call(this),Ar(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cs=a.JSON.stringify,Tg=a.JSON.parse,Ol=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Vl(){}function Ll(){}var jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function vi(){k.call(this,"d")}m(vi,k);function zo(){k.call(this,"c")}m(zo,k);var cs={},G=null;function Ee(){return G=G||new pe}cs.Ia="serverreachability";function Me(l){k.call(this,cs.Ia,l)}m(Me,k);function be(l){const h=Ee();Oe(h,new Me(h))}cs.STAT_EVENT="statevent";function Sn(l,h){k.call(this,cs.STAT_EVENT,l),this.stat=h}m(Sn,k);function ft(l){const h=Ee();Oe(h,new Sn(h,l))}cs.Ja="timingevent";function wi(l,h){k.call(this,cs.Ja,l),this.size=h}m(wi,k);function Un(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function $n(){this.g=!0}$n.prototype.ua=function(){this.g=!1};function bi(l,h,g,w,D,V){l.info(function(){if(l.g)if(V){var X="",_e=V.split("&");for(let Be=0;Be<_e.length;Be++){var yt=_e[Be].split("=");if(yt.length>1){const _t=yt[0];yt=yt[1];const Bn=_t.split("_");X=Bn.length>=2&&Bn[1]=="type"?X+(_t+"="+yt+"&"):X+(_t+"=redacted&")}}}else X=null;else X=V;return"XMLHTTP REQ ("+w+") [attempt "+D+"]: "+h+`
`+g+`
`+X})}function Dd(l,h,g,w,D,V,X){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+D+"]: "+h+`
`+g+`
`+V+" "+X})}function As(l,h,g,w){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+aE(l,g)+(w?" "+w:"")})}function Fl(l,h){l.info(function(){return"TIMEOUT: "+h})}$n.prototype.info=function(){};function aE(l,h){if(!l.g)return h;if(!h)return null;try{const V=JSON.parse(h);if(V){for(l=0;l<V.length;l++)if(Array.isArray(V[l])){var g=V[l];if(!(g.length<2)){var w=g[1];if(Array.isArray(w)&&!(w.length<1)){var D=w[0];if(D!="noop"&&D!="stop"&&D!="close")for(let X=1;X<w.length;X++)w[X]=""}}}}return Cs(V)}catch{return h}}var Ul={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Sg={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},kg;function Md(){}m(Md,Vl),Md.prototype.g=function(){return new XMLHttpRequest},kg=new Md;function Bo(l){return encodeURIComponent(String(l))}function lE(l){var h=1;l=l.split(":");const g=[];for(;h>0&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function js(l,h,g,w){this.j=l,this.i=h,this.l=g,this.S=w||1,this.V=new $t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cg}function Cg(){this.i=null,this.g="",this.h=!1}var Ag={},Od={};function Vd(l,h,g){l.M=1,l.A=zl(zn(h)),l.u=g,l.R=!0,jg(l,null)}function jg(l,h){l.F=Date.now(),$l(l),l.B=zn(l.A);var g=l.B,w=l.S;Array.isArray(w)||(w=[String(w)]),qg(g.i,"t",w),l.C=0,g=l.j.L,l.h=new Cg,l.g=l0(l.j,g?h:null,!l.u),l.P>0&&(l.O=new Ml(d(l.Y,l,l.g),l.P)),h=l.V,g=l.g,w=l.ba;var D="readystatechange";Array.isArray(D)||(D&&(Cr[0]=D.toString()),D=Cr);for(let V=0;V<D.length;V++){const X=xe(g,D[V],w||h.handleEvent,!1,h.h||h);if(!X)break;h.g[X.key]=X}h=l.J?ue(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),be(),bi(l.i,l.v,l.B,l.l,l.S,l.u)}js.prototype.ba=function(l){l=l.target;const h=this.O;h&&Ds(l)==3?h.j():this.Y(l)},js.prototype.Y=function(l){try{if(l==this.g)e:{const _e=Ds(this.g),yt=this.g.ya(),Be=this.g.ca();if(!(_e<3)&&(_e!=3||this.g&&(this.h.h||this.g.la()||Xg(this.g)))){this.K||_e!=4||yt==7||(yt==8||Be<=0?be(3):be(2)),Ld(this);var h=this.g.ca();this.X=h;var g=cE(this);if(this.o=h==200,Dd(this.i,this.v,this.B,this.l,this.S,_e,h),this.o){if(this.U&&!this.L){t:{if(this.g){var w,D=this.g;if((w=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(w)){var V=w;break t}}V=null}if(l=V)As(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fd(this,l);else{this.o=!1,this.m=3,ft(12),Rr(this),qo(this);break e}}if(this.R){l=!0;let _t;for(;!this.K&&this.C<g.length;)if(_t=uE(this,g),_t==Od){_e==4&&(this.m=4,ft(14),l=!1),As(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==Ag){this.m=4,ft(15),As(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else As(this.i,this.l,_t,null),Fd(this,_t);if(Rg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_e!=4||g.length!=0||this.h.h||(this.m=1,ft(16),l=!1),this.o=this.o&&l,!l)As(this.i,this.l,g,"[Invalid Chunked Response]"),Rr(this),qo(this);else if(g.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Wd(X),X.P=!0,ft(11))}}else As(this.i,this.l,g,null),Fd(this,g);_e==4&&Rr(this),this.o&&!this.K&&(_e==4?r0(this.j,this):(this.o=!1,$l(this)))}else EE(this.g),h==400&&g.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),Rr(this),qo(this)}}}catch{}finally{}};function cE(l){if(!Rg(l))return l.g.la();const h=Xg(l.g);if(h==="")return"";let g="";const w=h.length,D=Ds(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Rr(l),qo(l),"";l.h.i=new a.TextDecoder}for(let V=0;V<w;V++)l.h.h=!0,g+=l.h.i.decode(h[V],{stream:!(D&&V==w-1)});return h.length=0,l.h.g+=g,l.C=0,l.h.g}function Rg(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function uE(l,h){var g=l.C,w=h.indexOf(`
`,g);return w==-1?Od:(g=Number(h.substring(g,w)),isNaN(g)?Ag:(w+=1,w+g>h.length?Od:(h=h.slice(w,w+g),l.C=w+g,h)))}js.prototype.cancel=function(){this.K=!0,Rr(this)};function $l(l){l.T=Date.now()+l.H,Pg(l,l.H)}function Pg(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Un(d(l.aa,l),h)}function Ld(l){l.D&&(a.clearTimeout(l.D),l.D=null)}js.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(Fl(this.i,this.B),this.M!=2&&(be(),ft(17)),Rr(this),this.m=2,qo(this)):Pg(this,this.T-l)};function qo(l){l.j.I==0||l.K||r0(l.j,l)}function Rr(l){Ld(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,Ar(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function Fd(l,h){try{var g=l.j;if(g.I!=0&&(g.g==l||Ud(g.h,l))){if(!l.L&&Ud(g.h,l)&&g.I==3){try{var w=g.Ba.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var D=w;if(D[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)Wl(g),Hl(g);else break e;Gd(g),ft(18)}}else g.xa=D[1],0<g.xa-g.K&&D[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Un(d(g.Va,g),6e3));Og(g.h)<=1&&g.ta&&(g.ta=void 0)}else Dr(g,11)}else if((l.L||g.g==l)&&Wl(g),!I(h))for(D=g.Ba.g.parse(h),h=0;h<D.length;h++){let Be=D[h];const _t=Be[0];if(!(_t<=g.K))if(g.K=_t,Be=Be[1],g.I==2)if(Be[0]=="c"){g.M=Be[1],g.ba=Be[2];const Bn=Be[3];Bn!=null&&(g.ka=Bn,g.j.info("VER="+g.ka));const Mr=Be[4];Mr!=null&&(g.za=Mr,g.j.info("SVER="+g.za));const Ms=Be[5];Ms!=null&&typeof Ms=="number"&&Ms>0&&(w=1.5*Ms,g.O=w,g.j.info("backChannelRequestTimeoutMs_="+w)),w=g;const Os=l.g;if(Os){const Ql=Os.g?Os.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ql){var V=w.h;V.g||Ql.indexOf("spdy")==-1&&Ql.indexOf("quic")==-1&&Ql.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&($d(V,V.h),V.h=null))}if(w.G){const Kd=Os.g?Os.g.getResponseHeader("X-HTTP-Session-Id"):null;Kd&&(w.wa=Kd,Ke(w.J,w.G,Kd))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),w=g;var X=l;if(w.na=a0(w,w.L?w.ba:null,w.W),X.L){Vg(w.h,X);var _e=X,yt=w.O;yt&&(_e.H=yt),_e.D&&(Ld(_e),$l(_e)),w.g=X}else n0(w);g.i.length>0&&Gl(g)}else Be[0]!="stop"&&Be[0]!="close"||Dr(g,7);else g.I==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?Dr(g,7):Hd(g):Be[0]!="noop"&&g.l&&g.l.qa(Be),g.A=0)}}be(4)}catch{}}var dE=class{constructor(l,h){this.g=l,this.map=h}};function Dg(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Mg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Og(l){return l.h?1:l.g?l.g.size:0}function Ud(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function $d(l,h){l.g?l.g.add(h):l.h=h}function Vg(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Dg.prototype.cancel=function(){if(this.i=Lg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Lg(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.G);return h}return y(l.i)}var Fg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hE(l,h){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const w=l[g].indexOf("=");let D,V=null;w>=0?(D=l[g].substring(0,w),V=l[g].substring(w+1)):D=l[g],h(D,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Rs(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof Rs?(this.l=l.l,Ho(this,l.j),this.o=l.o,this.g=l.g,Go(this,l.u),this.h=l.h,zd(this,Hg(l.i)),this.m=l.m):l&&(h=String(l).match(Fg))?(this.l=!1,Ho(this,h[1]||"",!0),this.o=Wo(h[2]||""),this.g=Wo(h[3]||"",!0),Go(this,h[4]),this.h=Wo(h[5]||"",!0),zd(this,h[6]||"",!0),this.m=Wo(h[7]||"")):(this.l=!1,this.i=new Qo(null,this.l))}Rs.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(Ko(h,Ug,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Ko(h,Ug,!0),"@"),l.push(Bo(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Ko(g,g.charAt(0)=="/"?pE:mE,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Ko(g,xE)),l.join("")},Rs.prototype.resolve=function(l){const h=zn(this);let g=!!l.j;g?Ho(h,l.j):g=!!l.o,g?h.o=l.o:g=!!l.g,g?h.g=l.g:g=l.u!=null;var w=l.h;if(g)Go(h,l.u);else if(g=!!l.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var D=h.h.lastIndexOf("/");D!=-1&&(w=h.h.slice(0,D+1)+w)}if(D=w,D==".."||D==".")w="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){w=D.lastIndexOf("/",0)==0,D=D.split("/");const V=[];for(let X=0;X<D.length;){const _e=D[X++];_e=="."?w&&X==D.length&&V.push(""):_e==".."?((V.length>1||V.length==1&&V[0]!="")&&V.pop(),w&&X==D.length&&V.push("")):(V.push(_e),w=!0)}w=V.join("/")}else w=D}return g?h.h=w:g=l.i.toString()!=="",g?zd(h,Hg(l.i)):g=!!l.m,g&&(h.m=l.m),h};function zn(l){return new Rs(l)}function Ho(l,h,g){l.j=g?Wo(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Go(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function zd(l,h,g){h instanceof Qo?(l.i=h,yE(l.i,l.l)):(g||(h=Ko(h,gE)),l.i=new Qo(h,l.l))}function Ke(l,h,g){l.i.set(h,g)}function zl(l){return Ke(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function Wo(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ko(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,fE),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function fE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ug=/[#\/\?@]/g,mE=/[#\?:]/g,pE=/[#\?]/g,gE=/[#\?@]/g,xE=/#/g;function Qo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Pr(l){l.g||(l.g=new Map,l.h=0,l.i&&hE(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Qo.prototype,t.add=function(l,h){Pr(this),this.i=null,l=_i(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function $g(l,h){Pr(l),h=_i(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function zg(l,h){return Pr(l),h=_i(l,h),l.g.has(h)}t.forEach=function(l,h){Pr(this),this.g.forEach(function(g,w){g.forEach(function(D){l.call(h,D,w,this)},this)},this)};function Bg(l,h){Pr(l);let g=[];if(typeof h=="string")zg(l,h)&&(g=g.concat(l.g.get(_i(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)g=g.concat(l[h]);return g}t.set=function(l,h){return Pr(this),this.i=null,l=_i(this,l),zg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=Bg(this,l),l.length>0?String(l[0]):h):h};function qg(l,h,g){$g(l,h),g.length>0&&(l.i=null,l.g.set(_i(l,h),y(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let w=0;w<h.length;w++){var g=h[w];const D=Bo(g);g=Bg(this,g);for(let V=0;V<g.length;V++){let X=D;g[V]!==""&&(X+="="+Bo(g[V])),l.push(X)}}return this.i=l.join("&")};function Hg(l){const h=new Qo;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function _i(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function yE(l,h){h&&!l.j&&(Pr(l),l.i=null,l.g.forEach(function(g,w){const D=w.toLowerCase();w!=D&&($g(this,w),qg(this,D,g))},l)),l.j=h}function vE(l,h){const g=new $n;if(a.Image){const w=new Image;w.onload=f(Ps,g,"TestLoadImage: loaded",!0,h,w),w.onerror=f(Ps,g,"TestLoadImage: error",!1,h,w),w.onabort=f(Ps,g,"TestLoadImage: abort",!1,h,w),w.ontimeout=f(Ps,g,"TestLoadImage: timeout",!1,h,w),a.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else h(!1)}function wE(l,h){const g=new $n,w=new AbortController,D=setTimeout(()=>{w.abort(),Ps(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:w.signal}).then(V=>{clearTimeout(D),V.ok?Ps(g,"TestPingServer: ok",!0,h):Ps(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),Ps(g,"TestPingServer: error",!1,h)})}function Ps(l,h,g,w,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),w(g)}catch{}}function bE(){this.g=new Ol}function Bd(l){this.i=l.Sb||null,this.h=l.ab||!1}m(Bd,Vl),Bd.prototype.g=function(){return new Bl(this.i,this.h)};function Bl(l,h){pe.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Bl,pe),t=Bl.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,Xo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||a).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yo(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Xo(this)),this.g&&(this.readyState=3,Xo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Gg(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Gg(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Yo(this):Xo(this),this.readyState==3&&Gg(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Yo(this))},t.Na=function(l){this.g&&(this.response=l,Yo(this))},t.ga=function(){this.g&&Yo(this)};function Yo(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Xo(l)}t.setRequestHeader=function(l,h){this.A.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function Xo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Bl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Wg(l){let h="";return J(l,function(g,w){h+=w,h+=":",h+=g,h+=`\r
`}),h}function qd(l,h,g){e:{for(w in g){var w=!1;break e}w=!0}w||(g=Wg(g),typeof l=="string"?g!=null&&Bo(g):Ke(l,h,g))}function it(l){pe.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(it,pe);var _E=/^https?$/i,NE=["POST","PUT"];t=it.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,h,g,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():kg.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(V){Kg(this,V);return}if(l=g||"",g=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var D in w)g.set(D,w[D]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const V of w.keys())g.set(V,w.get(V));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(g.keys()).find(V=>V.toLowerCase()=="content-type"),D=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(NE,h,void 0)>=0)||w||D||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,X]of g)this.g.setRequestHeader(V,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(V){Kg(this,V)}};function Kg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,Qg(l),ql(l)}function Qg(l){l.A||(l.A=!0,Oe(l,"complete"),Oe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,Oe(this,"complete"),Oe(this,"abort"),ql(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ql(this,!0)),it.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Yg(this):this.Xa())},t.Xa=function(){Yg(this)};function Yg(l){if(l.h&&typeof i<"u"){if(l.v&&Ds(l)==4)setTimeout(l.Ca.bind(l),0);else if(Oe(l,"readystatechange"),Ds(l)==4){l.h=!1;try{const V=l.ca();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var w;if(w=V===0){let X=String(l.D).match(Fg)[1]||null;!X&&a.self&&a.self.location&&(X=a.self.location.protocol.slice(0,-1)),w=!_E.test(X?X.toLowerCase():"")}g=w}if(g)Oe(l,"complete"),Oe(l,"success");else{l.o=6;try{var D=Ds(l)>2?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.ca()+"]",Qg(l)}}finally{ql(l)}}}}function ql(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,h||Oe(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ds(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Ds(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Tg(h)}};function Xg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function EE(l){const h={};l=(l.g&&Ds(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(I(l[w]))continue;var g=lE(l[w]);const D=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const V=h[D]||[];h[D]=V,V.push(g)}H(h,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jo(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function Jg(l){this.za=0,this.i=[],this.j=new $n,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jo("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jo("baseRetryDelayMs",5e3,l),this.Za=Jo("retryDelaySeedMs",1e4,l),this.Ta=Jo("forwardChannelMaxRetries",2,l),this.va=Jo("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Dg(l&&l.concurrentRequestLimit),this.Ba=new bE,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Jg.prototype,t.ka=8,t.I=1,t.connect=function(l,h,g,w){ft(0),this.W=l,this.H=h||{},g&&w!==void 0&&(this.H.OSID=g,this.H.OAID=w),this.F=this.X,this.J=a0(this,null,this.W),Gl(this)};function Hd(l){if(Zg(l),l.I==3){var h=l.V++,g=zn(l.J);if(Ke(g,"SID",l.M),Ke(g,"RID",h),Ke(g,"TYPE","terminate"),Zo(l,g),h=new js(l,l.j,h),h.M=2,h.A=zl(zn(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(h.A.toString(),"")}catch{}!g&&a.Image&&(new Image().src=h.A,g=!0),g||(h.g=l0(h.j,null),h.g.ea(h.A)),h.F=Date.now(),$l(h)}o0(l)}function Hl(l){l.g&&(Wd(l),l.g.cancel(),l.g=null)}function Zg(l){Hl(l),l.v&&(a.clearTimeout(l.v),l.v=null),Wl(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function Gl(l){if(!Mg(l.h)&&!l.m){l.m=!0;var h=l.Ea;L||x(),U||(L(),U=!0),N.add(h,l),l.D=0}}function IE(l,h){return Og(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Un(d(l.Ea,l,h),i0(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const D=new js(this,this.j,l);let V=this.o;if(this.U&&(V?(V=ue(V),je(V,this.U)):V=this.U),this.u!==null||this.R||(D.J=V,V=null),this.S)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var w=this.i[g];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,h>4096){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=t0(this,D,h),g=zn(this.J),Ke(g,"RID",l),Ke(g,"CVER",22),this.G&&Ke(g,"X-HTTP-Session-Id",this.G),Zo(this,g),V&&(this.R?h="headers="+Bo(Wg(V))+"&"+h:this.u&&qd(g,this.u,V)),$d(this.h,D),this.Ra&&Ke(g,"TYPE","init"),this.S?(Ke(g,"$req",h),Ke(g,"SID","null"),D.U=!0,Vd(D,g,null)):Vd(D,g,h),this.I=2}}else this.I==3&&(l?e0(this,l):this.i.length==0||Mg(this.h)||e0(this))};function e0(l,h){var g;h?g=h.l:g=l.V++;const w=zn(l.J);Ke(w,"SID",l.M),Ke(w,"RID",g),Ke(w,"AID",l.K),Zo(l,w),l.u&&l.o&&qd(w,l.u,l.o),g=new js(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),h&&(l.i=h.G.concat(l.i)),h=t0(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),$d(l.h,g),Vd(g,w,h)}function Zo(l,h){l.H&&J(l.H,function(g,w){Ke(h,w,g)}),l.l&&J({},function(g,w){Ke(h,w,g)})}function t0(l,h,g){g=Math.min(l.i.length,g);const w=l.l?d(l.l.Ka,l.l,l):null;e:{var D=l.i;let _e=-1;for(;;){const yt=["count="+g];_e==-1?g>0?(_e=D[0].g,yt.push("ofs="+_e)):_e=0:yt.push("ofs="+_e);let Be=!0;for(let _t=0;_t<g;_t++){var V=D[_t].g;const Bn=D[_t].map;if(V-=_e,V<0)_e=Math.max(0,D[_t].g-100),Be=!1;else try{V="req"+V+"_"||"";try{var X=Bn instanceof Map?Bn:Object.entries(Bn);for(const[Mr,Ms]of X){let Os=Ms;c(Ms)&&(Os=Cs(Ms)),yt.push(V+Mr+"="+encodeURIComponent(Os))}}catch(Mr){throw yt.push(V+"type="+encodeURIComponent("_badmap")),Mr}}catch{w&&w(Bn)}}if(Be){X=yt.join("&");break e}}X=void 0}return l=l.i.splice(0,g),h.G=l,X}function n0(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;L||x(),U||(L(),U=!0),N.add(h,l),l.A=0}}function Gd(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Un(d(l.Da,l),i0(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,s0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Un(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),Hl(this),s0(this))};function Wd(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function s0(l){l.g=new js(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=zn(l.na);Ke(h,"RID","rpc"),Ke(h,"SID",l.M),Ke(h,"AID",l.K),Ke(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&Ke(h,"TO",l.ia),Ke(h,"TYPE","xmlhttp"),Zo(l,h),l.u&&l.o&&qd(h,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=zl(zn(h)),g.u=null,g.R=!0,jg(g,l)}t.Va=function(){this.C!=null&&(this.C=null,Hl(this),Gd(this),ft(19))};function Wl(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function r0(l,h){var g=null;if(l.g==h){Wl(l),Wd(l),l.g=null;var w=2}else if(Ud(l.h,h))g=h.G,Vg(l.h,h),w=1;else return;if(l.I!=0){if(h.o)if(w==1){g=h.u?h.u.length:0,h=Date.now()-h.F;var D=l.D;w=Ee(),Oe(w,new wi(w,g)),Gl(l)}else n0(l);else if(D=h.m,D==3||D==0&&h.X>0||!(w==1&&IE(l,h)||w==2&&Gd(l)))switch(g&&g.length>0&&(h=l.h,h.i=h.i.concat(g)),D){case 1:Dr(l,5);break;case 4:Dr(l,10);break;case 3:Dr(l,6);break;default:Dr(l,2)}}}function i0(l,h){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*h}function Dr(l,h){if(l.j.info("Error code "+h),h==2){var g=d(l.bb,l),w=l.Ua;const D=!w;w=new Rs(w||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ho(w,"https"),zl(w),D?vE(w.toString(),g):wE(w.toString(),g)}else ft(2);l.I=0,l.l&&l.l.pa(h),o0(l),Zg(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function o0(l){if(l.I=0,l.ja=[],l.l){const h=Lg(l.h);(h.length!=0||l.i.length!=0)&&(T(l.ja,h),T(l.ja,l.i),l.h.i.length=0,y(l.i),l.i.length=0),l.l.oa()}}function a0(l,h,g){var w=g instanceof Rs?zn(g):new Rs(g);if(w.g!="")h&&(w.g=h+"."+w.g),Go(w,w.u);else{var D=a.location;w=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;const V=new Rs(null);w&&Ho(V,w),h&&(V.g=h),D&&Go(V,D),g&&(V.h=g),w=V}return g=l.G,h=l.wa,g&&h&&Ke(w,g,h),Ke(w,"VER",l.ka),Zo(l,w),w}function l0(l,h,g){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new it(new Bd({ab:g})):new it(l.ma),h.Fa(l.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function c0(){}t=c0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Kl(){}Kl.prototype.g=function(l,h){return new on(l,h)};function on(l,h){pe.call(this),this.g=new Jg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!I(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!I(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ni(this)}m(on,pe),on.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},on.prototype.close=function(){Hd(this.g)},on.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=Cs(l),l=g);h.i.push(new dE(h.Ya++,l)),h.I==3&&Gl(h)},on.prototype.N=function(){this.g.l=null,delete this.j,Hd(this.g),delete this.g,on.Z.N.call(this)};function u0(l){vi.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}m(u0,vi);function d0(){zo.call(this),this.status=1}m(d0,zo);function Ni(l){this.g=l}m(Ni,c0),Ni.prototype.ra=function(){Oe(this.g,"a")},Ni.prototype.qa=function(l){Oe(this.g,new u0(l))},Ni.prototype.pa=function(l){Oe(this.g,new d0)},Ni.prototype.oa=function(){Oe(this.g,"b")},Kl.prototype.createWebChannel=Kl.prototype.g,on.prototype.send=on.prototype.o,on.prototype.open=on.prototype.m,on.prototype.close=on.prototype.close,N_=function(){return new Kl},__=function(){return Ee()},b_=cs,qf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ul.NO_ERROR=0,Ul.TIMEOUT=8,Ul.HTTP_ERROR=6,Dc=Ul,Sg.COMPLETE="complete",w_=Sg,Ll.EventType=jr,jr.OPEN="a",jr.CLOSE="b",jr.ERROR="c",jr.MESSAGE="d",pe.prototype.listen=pe.prototype.J,ma=Ll,it.prototype.listenOnce=it.prototype.K,it.prototype.getLastError=it.prototype.Ha,it.prototype.getLastErrorCode=it.prototype.ya,it.prototype.getStatus=it.prototype.ca,it.prototype.getResponseJson=it.prototype.La,it.prototype.getResponseText=it.prototype.la,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Fa,v_=it}).apply(typeof fc<"u"?fc:typeof self<"u"?self:typeof window<"u"?window:{});const $x="@firebase/firestore",zx="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new id("@firebase/firestore");function Si(){return ni.logLevel}function re(t,...e){if(ni.logLevel<=ke.DEBUG){const n=e.map(mp);ni.debug(`Firestore (${Do}): ${t}`,...n)}}function Es(t,...e){if(ni.logLevel<=ke.ERROR){const n=e.map(mp);ni.error(`Firestore (${Do}): ${t}`,...n)}}function mo(t,...e){if(ni.logLevel<=ke.WARN){const n=e.map(mp);ni.warn(`Firestore (${Do}): ${t}`,...n)}}function mp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,E_(t,s,n)}function E_(t,e,n){let s=`FIRESTORE (${Do}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Es(s),new Error(s)}function Le(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||E_(e,r,s)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends Fn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mt.UNAUTHENTICATED))}shutdown(){}}class bC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class _C{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Le(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,n(u)):Promise.resolve();let i=new ys;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ys,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},c=u=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ys)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Le(typeof s.accessToken=="string",31837,{l:s}),new I_(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Le(e===null||typeof e=="string",2055,{h:e}),new Mt(e)}}class NC{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class EC{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new NC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Bx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Le(this.o===void 0,3512);const s=i=>{i.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Bx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Le(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Bx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=TC(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function Ce(t,e){return t<e?-1:t>e?1:0}function Hf(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return Sh(r)===Sh(i)?Ce(r,i):Sh(r)?1:-1}return Ce(t.length,e.length)}const SC=55296,kC=57343;function Sh(t){const e=t.charCodeAt(0);return e>=SC&&e<=kC}function po(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="__name__";class Gn{constructor(e,n,s){n===void 0?n=0:n>e.length&&fe(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&fe(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Gn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gn?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=Gn.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return Ce(e.length,n.length)}static compareSegments(e,n){const s=Gn.isNumericId(e),r=Gn.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Gn.extractNumericId(e).compare(Gn.extractNumericId(n)):Hf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ar.fromString(e.substring(4,e.length-2))}}class qe extends Gn{construct(e,n,s){return new qe(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Y(F.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new qe(n)}static emptyPath(){return new qe([])}}const CC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kt extends Gn{construct(e,n,s){return new kt(e,n,s)}static isValidIdentifier(e){return CC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Gf}static keyField(){return new kt([Gf])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Y(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let a=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new Y(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(s+=c,r++):(i(),r++)}if(i(),a)throw new Y(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kt(n)}static emptyPath(){return new kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(qe.fromString(e))}static fromName(e){return new he(qe.fromString(e).popFirst(5))}static empty(){return new he(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new qe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t,e,n){if(!n)throw new Y(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function AC(t,e,n,s){if(e===!0&&s===!0)throw new Y(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qx(t){if(!he.isDocumentKey(t))throw new Y(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Hx(t){if(he.isDocumentKey(t))throw new Y(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function S_(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function od(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":fe(12329,{type:typeof t})}function qt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Y(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=od(t);throw new Y(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function k_(t,e){if(e<=0)throw new Y(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e){const n={typeString:t};return e&&(n.value=e),n}function wl(t,e){if(!S_(t))throw new Y(F.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const a=t[s];if(r&&typeof a!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new Y(F.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=-62135596800,Wx=1e6;class ze{static now(){return ze.fromMillis(Date.now())}static fromDate(e){return ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Wx);return new ze(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Gx)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Wx}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ze._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wl(e,ze._jsonSchema))return new ze(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Gx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ze._jsonSchemaVersion="firestore/timestamp/1.0",ze._jsonSchema={type:xt("string",ze._jsonSchemaVersion),seconds:xt("number"),nanoseconds:xt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new ze(0,0))}static max(){return new ye(new ze(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=-1;function jC(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=ye.fromTimestamp(s===1e9?new ze(n+1,0):new ze(n,s));return new gr(r,he.empty(),e)}function RC(t){return new gr(t.readTime,t.key,sl)}class gr{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new gr(ye.min(),he.empty(),sl)}static max(){return new gr(ye.max(),he.empty(),sl)}}function PC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=he.comparator(t.documentKey,e.documentKey),n!==0?n:Ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mo(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==DC)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,s)=>{n(e)})}static reject(e){return new z((n,s)=>{s(e)})}static waitFor(e){return new z((n,s)=>{let r=0,i=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++i,a&&i===r&&n()},u=>s(u))}),a=!0,i===r&&n()})}static or(e){let n=z.resolve(!1);for(const s of e)n=n.next(r=>r?z.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new z((s,r)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{a[d]=f,++c,c===i&&s(a)},f=>r(f))}})}static doWhile(e,n){return new z((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function OC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Oo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ad.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp=-1;function ld(t){return t==null}function _u(t){return t===0&&1/t==-1/0}function VC(t){return typeof t=="number"&&Number.isInteger(t)&&!_u(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="";function LC(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Kx(e)),e=FC(t.get(n),e);return Kx(e)}function FC(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case C_:n+="";break;default:n+=i}}return n}function Kx(t){return t+C_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Sr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){this.comparator=e,this.root=n||St.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mc(this.root,e,this.comparator,!0)}}class mc{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??St.RED,this.left=r??St.EMPTY,this.right=i??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new St(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return St.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fe(27949);return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw fe(57766)}get value(){throw fe(16141)}get color(){throw fe(16727)}get left(){throw fe(29726)}get right(){throw fe(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new St(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Yx(this.data.getIterator())}getIteratorFrom(e){return new Yx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof bt)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new bt(this.comparator);return n.data=e,n}}class Yx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.fields=e,e.sort(kt.comparator)}static empty(){return new cn([])}unionWith(e){let n=new bt(kt.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new cn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return po(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new j_("Invalid base64 string: "+i):i}}(e);return new jt(n)}static fromUint8Array(e){const n=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new jt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const UC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xr(t){if(Le(!!t,39018),typeof t=="string"){let e=0;const n=UC.exec(t);if(Le(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function yr(t){return typeof t=="string"?jt.fromBase64String(t):jt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_="server_timestamp",P_="__type__",D_="__previous_value__",M_="__local_write_time__";function cd(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[P_])==null?void 0:s.stringValue)===R_}function ud(t){const e=t.mapValue.fields[D_];return cd(e)?ud(e):e}function rl(t){const e=xr(t.mapValue.fields[M_].timestampValue);return new ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,n,s,r,i,a,c,u,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Nu="(default)";class il{constructor(e,n){this.projectId=e,this.database=n||Nu}static empty(){return new il("","")}get isDefaultDatabase(){return this.database===Nu}isEqual(e){return e instanceof il&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="__type__",zC="__max__",pc={mapValue:{}},V_="__vector__",Eu="value";function vr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cd(t)?4:qC(t)?9007199254740991:BC(t)?10:11:fe(28295,{value:t})}function is(t,e){if(t===e)return!0;const n=vr(t);if(n!==vr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rl(t).isEqual(rl(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=xr(r.timestampValue),c=xr(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return yr(r.bytesValue).isEqual(yr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return ct(r.geoPointValue.latitude)===ct(i.geoPointValue.latitude)&&ct(r.geoPointValue.longitude)===ct(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ct(r.integerValue)===ct(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=ct(r.doubleValue),c=ct(i.doubleValue);return a===c?_u(a)===_u(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return po(t.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(Qx(a)!==Qx(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!is(a[u],c[u])))return!1;return!0}(t,e);default:return fe(52216,{left:t})}}function ol(t,e){return(t.values||[]).find(n=>is(n,e))!==void 0}function go(t,e){if(t===e)return 0;const n=vr(t),s=vr(e);if(n!==s)return Ce(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ce(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=ct(i.integerValue||i.doubleValue),u=ct(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Xx(t.timestampValue,e.timestampValue);case 4:return Xx(rl(t),rl(e));case 5:return Hf(t.stringValue,e.stringValue);case 6:return function(i,a){const c=yr(i),u=yr(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=Ce(c[d],u[d]);if(f!==0)return f}return Ce(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=Ce(ct(i.latitude),ct(a.latitude));return c!==0?c:Ce(ct(i.longitude),ct(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Jx(t.arrayValue,e.arrayValue);case 10:return function(i,a){var p,y,T,C;const c=i.fields||{},u=a.fields||{},d=(p=c[Eu])==null?void 0:p.arrayValue,f=(y=u[Eu])==null?void 0:y.arrayValue,m=Ce(((T=d==null?void 0:d.values)==null?void 0:T.length)||0,((C=f==null?void 0:f.values)==null?void 0:C.length)||0);return m!==0?m:Jx(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===pc.mapValue&&a===pc.mapValue)return 0;if(i===pc.mapValue)return 1;if(a===pc.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const p=Hf(u[m],f[m]);if(p!==0)return p;const y=go(c[u[m]],d[f[m]]);if(y!==0)return y}return Ce(u.length,f.length)}(t.mapValue,e.mapValue);default:throw fe(23264,{he:n})}}function Xx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ce(t,e);const n=xr(t),s=xr(e),r=Ce(n.seconds,s.seconds);return r!==0?r:Ce(n.nanos,s.nanos)}function Jx(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=go(n[r],s[r]);if(i)return i}return Ce(n.length,s.length)}function xo(t){return Wf(t)}function Wf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=xr(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return yr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return he.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=Wf(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const a of s)i?i=!1:r+=",",r+=`${a}:${Wf(n.fields[a])}`;return r+"}"}(t.mapValue):fe(61005,{value:t})}function Mc(t){switch(vr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ud(t);return e?16+Mc(e):16;case 5:return 2*t.stringValue.length;case 6:return yr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+Mc(i),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Sr(s.fields,(i,a)=>{r+=i.length+Mc(a)}),r}(t.mapValue);default:throw fe(13486,{value:t})}}function Iu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Kf(t){return!!t&&"integerValue"in t}function xp(t){return!!t&&"arrayValue"in t}function Zx(t){return!!t&&"nullValue"in t}function ey(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oc(t){return!!t&&"mapValue"in t}function BC(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[O_])==null?void 0:s.stringValue)===V_}function ja(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Sr(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=ja(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ja(t.arrayValue.values[n]);return e}return{...t}}function qC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===zC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.value=e}static empty(){return new Jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Oc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ja(n)}setAll(e){let n=kt.emptyPath(),s={},r=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,s,r),s={},r=[],n=c.popLast()}a?s[c.lastSegment()]=ja(a):r.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Oc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Oc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Sr(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Jt(ja(this.value))}}function L_(t){const e=[];return Sr(t.fields,(n,s)=>{const r=new kt([n]);if(Oc(s)){const i=L_(s.mapValue).fields;if(i.length===0)e.push(r);else for(const a of i)e.push(r.child(a))}else e.push(r)}),new cn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n,s,r,i,a,c){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Vt(e,0,ye.min(),ye.min(),ye.min(),Jt.empty(),0)}static newFoundDocument(e,n,s,r){return new Vt(e,1,n,ye.min(),s,r,0)}static newNoDocument(e,n){return new Vt(e,2,n,ye.min(),ye.min(),Jt.empty(),0)}static newUnknownDocument(e,n){return new Vt(e,3,n,ye.min(),ye.min(),Jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n){this.position=e,this.inclusive=n}}function ty(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],a=t.position[r];if(i.field.isKeyField()?s=he.comparator(he.fromName(a.referenceValue),n.key):s=go(a,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function ny(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!is(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,n="asc"){this.field=e,this.dir=n}}function HC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{}class gt extends F_{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new WC(e,n,s):n==="array-contains"?new YC(e,s):n==="in"?new XC(e,s):n==="not-in"?new JC(e,s):n==="array-contains-any"?new ZC(e,s):new gt(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new KC(e,s):new QC(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(go(n,this.value)):n!==null&&vr(this.value)===vr(n)&&this.matchesComparison(go(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ln extends F_{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ln(e,n)}matches(e){return U_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function U_(t){return t.op==="and"}function $_(t){return GC(t)&&U_(t)}function GC(t){for(const e of t.filters)if(e instanceof Ln)return!1;return!0}function Qf(t){if(t instanceof gt)return t.field.canonicalString()+t.op.toString()+xo(t.value);if($_(t))return t.filters.map(e=>Qf(e)).join(",");{const e=t.filters.map(n=>Qf(n)).join(",");return`${t.op}(${e})`}}function z_(t,e){return t instanceof gt?function(s,r){return r instanceof gt&&s.op===r.op&&s.field.isEqual(r.field)&&is(s.value,r.value)}(t,e):t instanceof Ln?function(s,r){return r instanceof Ln&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,a,c)=>i&&z_(a,r.filters[c]),!0):!1}(t,e):void fe(19439)}function B_(t){return t instanceof gt?function(n){return`${n.field.canonicalString()} ${n.op} ${xo(n.value)}`}(t):t instanceof Ln?function(n){return n.op.toString()+" {"+n.getFilters().map(B_).join(" ,")+"}"}(t):"Filter"}class WC extends gt{constructor(e,n,s){super(e,n,s),this.key=he.fromName(s.referenceValue)}matches(e){const n=he.comparator(e.key,this.key);return this.matchesComparison(n)}}class KC extends gt{constructor(e,n){super(e,"in",n),this.keys=q_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class QC extends gt{constructor(e,n){super(e,"not-in",n),this.keys=q_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q_(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(s=>he.fromName(s.referenceValue))}class YC extends gt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xp(n)&&ol(n.arrayValue,this.value)}}class XC extends gt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ol(this.value.arrayValue,n)}}class JC extends gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(ol(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ol(this.value.arrayValue,n)}}class ZC extends gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>ol(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e,n=null,s=[],r=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function sy(t,e=null,n=[],s=[],r=null,i=null,a=null){return new eA(t,e,n,s,r,i,a)}function yp(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Qf(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),ld(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>xo(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>xo(s)).join(",")),e.Te=n}return e.Te}function vp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!HC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!z_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ny(t.startAt,e.startAt)&&ny(t.endAt,e.endAt)}function Yf(t){return he.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,n=null,s=[],r=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tA(t,e,n,s,r,i,a,c){return new mi(t,e,n,s,r,i,a,c)}function dd(t){return new mi(t)}function ry(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wp(t){return t.collectionGroup!==null}function Ji(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new bt(kt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new al(i,s))}),n.has(kt.keyField().canonicalString())||e.Ie.push(new al(kt.keyField(),s))}return e.Ie}function Jn(t){const e=ve(t);return e.Ee||(e.Ee=nA(e,Ji(t))),e.Ee}function nA(t,e){if(t.limitType==="F")return sy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new al(r.field,i)});const n=t.endAt?new yo(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new yo(t.startAt.position,t.startAt.inclusive):null;return sy(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function Xf(t,e){const n=t.filters.concat([e]);return new mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Tu(t,e,n){return new mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hd(t,e){return vp(Jn(t),Jn(e))&&t.limitType===e.limitType}function H_(t){return`${yp(Jn(t))}|lt:${t.limitType}`}function ki(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>B_(r)).join(", ")}]`),ld(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>xo(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>xo(r)).join(",")),`Target(${s})`}(Jn(t))}; limitType=${t.limitType})`}function fd(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):he.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of Ji(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(a,c,u){const d=ty(a,c,u);return a.inclusive?d<=0:d<0}(s.startAt,Ji(s),r)||s.endAt&&!function(a,c,u){const d=ty(a,c,u);return a.inclusive?d>=0:d>0}(s.endAt,Ji(s),r))}(t,e)}function sA(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function G_(t){return(e,n)=>{let s=!1;for(const r of Ji(t)){const i=rA(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function rA(t,e,n){const s=t.field.isKeyField()?he.comparator(e.key,n.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?go(u,d):fe(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return fe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Sr(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return A_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=new rt(he.comparator);function Is(){return iA}const W_=new rt(he.comparator);function pa(...t){let e=W_;for(const n of t)e=e.insert(n.key,n);return e}function K_(t){let e=W_;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function zr(){return Ra()}function Q_(){return Ra()}function Ra(){return new pi(t=>t.toString(),(t,e)=>t.isEqual(e))}const oA=new rt(he.comparator),aA=new bt(he.comparator);function Ae(...t){let e=aA;for(const n of t)e=e.add(n);return e}const lA=new bt(Ce);function cA(){return lA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_u(e)?"-0":e}}function Y_(t){return{integerValue:""+t}}function X_(t,e){return VC(e)?Y_(e):bp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(){this._=void 0}}function uA(t,e,n){return t instanceof ll?function(r,i){const a={fields:{[P_]:{stringValue:R_},[M_]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&cd(i)&&(i=ud(i)),i&&(a.fields[D_]=i),{mapValue:a}}(n,e):t instanceof vo?Z_(t,e):t instanceof wo?e1(t,e):function(r,i){const a=J_(r,i),c=iy(a)+iy(r.Ae);return Kf(a)&&Kf(r.Ae)?Y_(c):bp(r.serializer,c)}(t,e)}function dA(t,e,n){return t instanceof vo?Z_(t,e):t instanceof wo?e1(t,e):n}function J_(t,e){return t instanceof cl?function(s){return Kf(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class ll extends md{}class vo extends md{constructor(e){super(),this.elements=e}}function Z_(t,e){const n=t1(e);for(const s of t.elements)n.some(r=>is(r,s))||n.push(s);return{arrayValue:{values:n}}}class wo extends md{constructor(e){super(),this.elements=e}}function e1(t,e){let n=t1(e);for(const s of t.elements)n=n.filter(r=>!is(r,s));return{arrayValue:{values:n}}}class cl extends md{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function iy(t){return ct(t.integerValue||t.doubleValue)}function t1(t){return xp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n){this.field=e,this.transform=n}}function hA(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof vo&&r instanceof vo||s instanceof wo&&r instanceof wo?po(s.elements,r.elements,is):s instanceof cl&&r instanceof cl?is(s.Ae,r.Ae):s instanceof ll&&r instanceof ll}(t.transform,e.transform)}class fA{constructor(e,n){this.version=e,this.transformResults=n}}class Ht{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ht}static exists(e){return new Ht(void 0,e)}static updateTime(e){return new Ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class gd{}function n1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xd(t.key,Ht.none()):new bl(t.key,t.data,Ht.none());{const n=t.data,s=Jt.empty();let r=new bt(kt.comparator);for(let i of e.fields)if(!r.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?s.delete(i):s.set(i,a),r=r.add(i)}return new kr(t.key,s,new cn(r.toArray()),Ht.none())}}function mA(t,e,n){t instanceof bl?function(r,i,a){const c=r.value.clone(),u=ay(r.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof kr?function(r,i,a){if(!Vc(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=ay(r.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(s1(r)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Pa(t,e,n,s){return t instanceof bl?function(i,a,c,u){if(!Vc(i.precondition,a))return c;const d=i.value.clone(),f=ly(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,s):t instanceof kr?function(i,a,c,u){if(!Vc(i.precondition,a))return c;const d=ly(i.fieldTransforms,u,a),f=a.data;return f.setAll(s1(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,s):function(i,a,c){return Vc(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function pA(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=J_(s.transform,r||null);i!=null&&(n===null&&(n=Jt.empty()),n.set(s.field,i))}return n||null}function oy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&po(s,r,(i,a)=>hA(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class bl extends gd{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class kr extends gd{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function s1(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function ay(t,e,n){const s=new Map;Le(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],a=i.transform,c=e.data.field(i.field);s.set(i.field,dA(a,c,n[r]))}return s}function ly(t,e,n){const s=new Map;for(const r of t){const i=r.transform,a=n.data.field(r.field);s.set(r.field,uA(i,a,e))}return s}class xd extends gd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gA extends gd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&mA(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Pa(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Pa(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=Q_();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(r.key)?null:c;const u=n1(a,c);u!==null&&s.set(r.key,u),a.isValidDocument()||a.convertToNoDocument(ye.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ae())}isEqual(e){return this.batchId===e.batchId&&po(this.mutations,e.mutations,(n,s)=>oy(n,s))&&po(this.baseMutations,e.baseMutations,(n,s)=>oy(n,s))}}class _p{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Le(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return oA}();const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,s[a].version);return new _p(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Re;function wA(t){switch(t){case F.OK:return fe(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return fe(15467,{code:t})}}function r1(t){if(t===void 0)return Es("GRPC error has no .code"),F.UNKNOWN;switch(t){case mt.OK:return F.OK;case mt.CANCELLED:return F.CANCELLED;case mt.UNKNOWN:return F.UNKNOWN;case mt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case mt.INTERNAL:return F.INTERNAL;case mt.UNAVAILABLE:return F.UNAVAILABLE;case mt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case mt.NOT_FOUND:return F.NOT_FOUND;case mt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case mt.ABORTED:return F.ABORTED;case mt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case mt.DATA_LOSS:return F.DATA_LOSS;default:return fe(39323,{code:t})}}(Re=mt||(mt={}))[Re.OK=0]="OK",Re[Re.CANCELLED=1]="CANCELLED",Re[Re.UNKNOWN=2]="UNKNOWN",Re[Re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Re[Re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Re[Re.NOT_FOUND=5]="NOT_FOUND",Re[Re.ALREADY_EXISTS=6]="ALREADY_EXISTS",Re[Re.PERMISSION_DENIED=7]="PERMISSION_DENIED",Re[Re.UNAUTHENTICATED=16]="UNAUTHENTICATED",Re[Re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Re[Re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Re[Re.ABORTED=10]="ABORTED",Re[Re.OUT_OF_RANGE=11]="OUT_OF_RANGE",Re[Re.UNIMPLEMENTED=12]="UNIMPLEMENTED",Re[Re.INTERNAL=13]="INTERNAL",Re[Re.UNAVAILABLE=14]="UNAVAILABLE",Re[Re.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=new ar([4294967295,4294967295],0);function cy(t){const e=bA().encode(t),n=new y_;return n.update(e),new Uint8Array(n.digest())}function uy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ar([n,s],0),new ar([r,i],0)]}class Np{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new ga(`Invalid padding: ${n}`);if(s<0)throw new ga(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new ga(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new ga(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ar.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(ar.fromNumber(s)));return r.compare(_A)===1&&(r=new ar([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=cy(e),[s,r]=uy(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);if(!this.we(a))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Np(i,r,n);return s.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const n=cy(e),[s,r]=uy(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);this.Se(a)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class ga extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,_l.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new yd(ye.min(),r,new rt(Ce),Is(),Ae())}}class _l{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new _l(s,n,Ae(),Ae(),Ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class i1{constructor(e,n){this.targetId=e,this.Ce=n}}class o1{constructor(e,n,s=jt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class dy{constructor(){this.ve=0,this.Fe=hy(),this.Me=jt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ae(),n=Ae(),s=Ae();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:fe(38017,{changeType:i})}}),new _l(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=hy()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Le(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class NA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Is(),this.Je=gc(),this.He=gc(),this.Ye=new rt(Ce)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:fe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(Yf(i))if(s===0){const a=new he(i.path);this.et(n,a,Vt.newNoDocument(a,ye.min()))}else Le(s===1,20013,{expectedCount:s});else{const a=this._t(n);if(a!==s){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let a,c;try{a=yr(s).toUint8Array()}catch(u){if(u instanceof j_)return mo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Np(a,r,i)}catch(u){return mo(u instanceof ga?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Yf(c.target)){const u=new he(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Vt.newNoDocument(u,e))}i.Be&&(n.set(a,i.ke()),i.qe())}});let s=Ae();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(s=s.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const r=new yd(e,n,this.Ye,this.je,s);return this.je=Is(),this.Je=gc(),this.He=gc(),this.Ye=new rt(Ce),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new dy,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new bt(Ce),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new bt(Ce),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dy),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function gc(){return new rt(he.comparator)}function hy(){return new rt(he.comparator)}const EA={asc:"ASCENDING",desc:"DESCENDING"},IA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TA={and:"AND",or:"OR"};class SA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Jf(t,e){return t.useProto3Json||ld(e)?e:{value:e}}function Su(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function a1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kA(t,e){return Su(t,e.toTimestamp())}function Zn(t){return Le(!!t,49232),ye.fromTimestamp(function(n){const s=xr(n);return new ze(s.seconds,s.nanos)}(t))}function Ep(t,e){return Zf(t,e).canonicalString()}function Zf(t,e){const n=function(r){return new qe(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function l1(t){const e=qe.fromString(t);return Le(f1(e),10190,{key:e.toString()}),e}function em(t,e){return Ep(t.databaseId,e.path)}function kh(t,e){const n=l1(e);if(n.get(1)!==t.databaseId.projectId)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Y(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new he(u1(n))}function c1(t,e){return Ep(t.databaseId,e)}function CA(t){const e=l1(t);return e.length===4?qe.emptyPath():u1(e)}function tm(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function u1(t){return Le(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fy(t,e,n){return{name:em(t,e),fields:n.value.mapValue.fields}}function AA(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:fe(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(Le(f===void 0||typeof f=="string",58123),jt.fromBase64String(f||"")):(Le(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),jt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=d.code===void 0?F.UNKNOWN:r1(d.code);return new Y(f,d.message||"")}(a);n=new o1(s,r,i,c||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=kh(t,s.document.name),i=Zn(s.document.updateTime),a=s.document.createTime?Zn(s.document.createTime):ye.min(),c=new Jt({mapValue:{fields:s.document.fields}}),u=Vt.newFoundDocument(r,i,a,c),d=s.targetIds||[],f=s.removedTargetIds||[];n=new Lc(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=kh(t,s.document),i=s.readTime?Zn(s.readTime):ye.min(),a=Vt.newNoDocument(r,i),c=s.removedTargetIds||[];n=new Lc([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=kh(t,s.document),i=s.removedTargetIds||[];n=new Lc([],i,r,null)}else{if(!("filter"in e))return fe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,a=new vA(r,i),c=s.targetId;n=new i1(c,a)}}return n}function jA(t,e){let n;if(e instanceof bl)n={update:fy(t,e.key,e.value)};else if(e instanceof xd)n={delete:em(t,e.key)};else if(e instanceof kr)n={update:fy(t,e.key,e.data),updateMask:UA(e.fieldMask)};else{if(!(e instanceof gA))return fe(16599,{Vt:e.type});n={verify:em(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,a){const c=a.transform;if(c instanceof ll)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof vo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof wo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof cl)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw fe(20930,{transform:a.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:kA(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:fe(27497)}(t,e.precondition)),n}function RA(t,e){return t&&t.length>0?(Le(e!==void 0,14353),t.map(n=>function(r,i){let a=r.updateTime?Zn(r.updateTime):Zn(i);return a.isEqual(ye.min())&&(a=Zn(i)),new fA(a,r.transformResults||[])}(n,e))):[]}function PA(t,e){return{documents:[c1(t,e.path)]}}function DA(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=c1(t,r);const i=function(d){if(d.length!==0)return h1(Ln.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(p){return{field:Ci(p.field),direction:VA(p.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=Jf(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:r}}function MA(t){let e=CA(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Le(s===1,65062);const f=n.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const p=d1(m);return p instanceof Ln&&$_(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(p=>function(T){return new al(Ai(T.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(m){let p;return p=typeof m=="object"?m.value:m,ld(p)?null:p}(n.limit));let u=null;n.startAt&&(u=function(m){const p=!!m.before,y=m.values||[];return new yo(y,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,y=m.values||[];return new yo(y,p)}(n.endAt)),tA(e,r,a,i,c,"F",u,d)}function OA(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function d1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=Ai(n.unaryFilter.field);return gt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Ai(n.unaryFilter.field);return gt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ai(n.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ai(n.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fe(61313);default:return fe(60726)}}(t):t.fieldFilter!==void 0?function(n){return gt.create(Ai(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fe(58110);default:return fe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ln.create(n.compositeFilter.filters.map(s=>d1(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return fe(1026)}}(n.compositeFilter.op))}(t):fe(30097,{filter:t})}function VA(t){return EA[t]}function LA(t){return IA[t]}function FA(t){return TA[t]}function Ci(t){return{fieldPath:t.canonicalString()}}function Ai(t){return kt.fromServerFormat(t.fieldPath)}function h1(t){return t instanceof gt?function(n){if(n.op==="=="){if(ey(n.value))return{unaryFilter:{field:Ci(n.field),op:"IS_NAN"}};if(Zx(n.value))return{unaryFilter:{field:Ci(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ey(n.value))return{unaryFilter:{field:Ci(n.field),op:"IS_NOT_NAN"}};if(Zx(n.value))return{unaryFilter:{field:Ci(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ci(n.field),op:LA(n.op),value:n.value}}}(t):t instanceof Ln?function(n){const s=n.getFilters().map(r=>h1(r));return s.length===1?s[0]:{compositeFilter:{op:FA(n.op),filters:s}}}(t):fe(54877,{filter:t})}function UA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function f1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n,s,r,i=ye.min(),a=ye.min(),c=jt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e){this.yt=e}}function zA(t){const e=MA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(){this.Cn=new qA}addToCollectionParentIndex(e,n){return this.Cn.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(gr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(gr.min())}updateCollectionGroup(e,n,s){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class qA{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new bt(qe.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new bt(qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},m1=41943040;class Qt{static withCacheSize(e){return new Qt(e,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qt.DEFAULT_COLLECTION_PERCENTILE=10,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qt.DEFAULT=new Qt(m1,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qt.DISABLED=new Qt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bo(0)}static cr(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py="LruGarbageCollector",HA=1048576;function gy([t,e],[n,s]){const r=Ce(t,n);return r===0?Ce(e,s):r}class GA{constructor(e){this.Ir=e,this.buffer=new bt(gy),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();gy(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class WA{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){re(py,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Oo(n)?re(py,"Ignoring IndexedDB error during garbage collection: ",n):await Mo(n)}await this.Vr(3e5)})}}class KA{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return z.resolve(ad.ce);const s=new GA(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(re("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(my)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),my):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,a,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,a=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(s=m,c=Date.now(),this.removeTargets(e,s,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(m=>(d=Date.now(),Si()<=ke.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${r} in `+(c-a)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:m})))}}function QA(t,e){return new KA(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(){this.changes=new pi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?z.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Pa(s.mutation,r,cn.empty(),ze.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,Ae()).next(()=>s))}getLocalViewOfDocuments(e,n,s=Ae()){const r=zr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let a=pa();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const s=zr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,Ae()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,s,r){let i=Is();const a=Ra(),c=function(){return Ra()}();return n.forEach((u,d)=>{const f=s.get(d.key);r.has(d.key)&&(f===void 0||f.mutation instanceof kr)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Pa(f.mutation,d,f.mutation.getFieldMask(),ze.now())):a.set(d.key,cn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),n.forEach((d,f)=>c.set(d,new XA(f,a.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const s=Ra();let r=new rt((a,c)=>a-c),i=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=s.get(u)||cn.empty();f=c.applyToLocalView(d,f),s.set(u,f);const m=(r.get(c.batchId)||Ae()).add(u);r=r.insert(c.batchId,m)})}).next(()=>{const a=[],c=r.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,m=Q_();f.forEach(p=>{if(!i.has(p)){const y=n1(n.get(p),s.get(p));y!==null&&m.set(p,y),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return z.waitFor(a)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(a){return he.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):z.resolve(zr());let c=sl,u=i;return a.next(d=>z.forEach(d,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{u=u.insert(f,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Ae())).next(f=>({batchId:c,changes:K_(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new he(n)).next(s=>{let r=pa();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let a=pa();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(m,p){return new mi(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,s,r).next(f=>{f.forEach((m,p)=>{a=a.insert(m,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,Vt.newInvalidDocument(f)))});let c=pa();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Pa(f.mutation,d,cn.empty(),ze.now()),fd(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Zn(r.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:zA(r.bundledQuery),readTime:Zn(r.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this.overlays=new rt(he.comparator),this.qr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const s=zr();return z.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),z.resolve()}getOverlaysForCollection(e,n,s){const r=zr(),i=n.length+1,a=new he(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return z.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new rt((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>s){let f=i.get(d.largestBatchId);f===null&&(f=zr(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=zr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=r)););return z.resolve(c)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new yA(n,s));let i=this.qr.get(n);i===void 0&&(i=Ae(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(){this.sessionToken=jt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.Qr=new bt(Nt.$r),this.Ur=new bt(Nt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Nt(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new Nt(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new he(new qe([])),s=new Nt(n,e),r=new Nt(n,e+1),i=[];return this.Ur.forEachInRange([s,r],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new he(new qe([])),s=new Nt(n,e),r=new Nt(n,e+1);let i=Ae();return this.Ur.forEachInRange([s,r],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Nt(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Nt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return he.comparator(e.key,n.key)||Ce(e.Yr,n.Yr)}static Kr(e,n){return Ce(e.Yr,n.Yr)||he.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new bt(Nt.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new xA(i,n,s,r);this.mutationQueue.push(a);for(const c of r)this.Zr=this.Zr.add(new Nt(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(a)}lookupMutationBatch(e,n){return z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?gp:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Nt(n,0),r=new Nt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],a=>{const c=this.Xr(a.Yr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new bt(Ce);return n.forEach(r=>{const i=new Nt(r,0),a=new Nt(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{s=s.add(c.Yr)})}),z.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;he.isDocumentKey(i)||(i=i.child(""));const a=new Nt(new he(i),0);let c=new bt(Ce);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!s.isPrefixOf(d)&&(d.length===r&&(c=c.add(u.Yr)),!0)},a),z.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Le(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return z.forEach(n.mutations,r=>{const i=new Nt(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new Nt(n,0),r=this.Zr.firstAfterOrEqual(s);return z.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e){this.ri=e,this.docs=function(){return new rt(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,a=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return z.resolve(s?s.document.mutableCopy():Vt.newInvalidDocument(n))}getEntries(e,n){let s=Is();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Vt.newInvalidDocument(r))}),z.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=Is();const a=n.path,c=new he(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||PC(RC(f),s)<=0||(r.has(f.key)||fd(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,s,r){fe(9500)}ii(e,n){return z.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new rj(this)}getSize(e){return z.resolve(this.size)}}class rj extends YA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e){this.persistence=e,this.si=new pi(n=>yp(n),vp),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new Ip,this.targetCount=0,this.ai=bo.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Pr(n),z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=n&&s.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),z.waitFor(i).next(()=>r)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return z.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),z.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(a=>{i.push(r.markPotentiallyOrphaned(e,a))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return z.resolve(s)}containsKey(e,n){return z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,n){this.ui={},this.overlays={},this.ci=new ad(0),this.li=!1,this.li=!0,this.hi=new tj,this.referenceDelegate=e(this),this.Pi=new ij(this),this.indexManager=new BA,this.remoteDocumentCache=function(r){return new sj(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new $A(n),this.Ii=new ZA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ej,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new nj(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){re("MemoryPersistence","Starting transaction:",e);const r=new oj(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return z.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class oj extends MC{constructor(e){super(),this.currentSequenceNumber=e}}class Tp{constructor(e){this.persistence=e,this.Ri=new Ip,this.Vi=null}static mi(e){return new Tp(e)}get fi(){if(this.Vi)return this.Vi;throw fe(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),z.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,s=>{const r=he.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,ye.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return z.or([()=>z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ku{constructor(e,n){this.persistence=e,this.pi=new pi(s=>LC(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=QA(this,n)}static mi(e,n){return new ku(e,n)}Ei(){}di(e){return z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return z.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?z.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,n).next(c=>{c||(s++,i.removeEntry(a,ye.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),z.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Mc(e.data.value)),n}br(e,n,s){return z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return z.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=Ae(),r=Ae();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Sp(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return ek()?8:OC(Ut())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new aj;return this.Ss(e,n,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,a,c.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(Si()<=ke.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",ki(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(Si()<=ke.DEBUG&&re("QueryEngine","Query:",ki(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Si()<=ke.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",ki(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jn(n))):z.resolve())}ys(e,n){if(ry(n))return z.resolve(null);let s=Jn(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Tu(n,null,"F"),s=Jn(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const a=Ae(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,s).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,a,u.readTime)?this.ys(e,Tu(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,s,r){return ry(n)||r.isEqual(ye.min())?z.resolve(null):this.ps.getDocuments(e,s).next(i=>{const a=this.Ds(n,i);return this.Cs(n,a,s,r)?z.resolve(null):(Si()<=ke.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ki(n)),this.vs(e,a,n,jC(r,sl)).next(c=>c))})}Ds(e,n){let s=new bt(G_(e));return n.forEach((r,i)=>{fd(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Si()<=ke.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",ki(n)),this.ps.getDocumentsMatchingQuery(e,n,gr.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp="LocalStore",cj=3e8;class uj{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new rt(Ce),this.xs=new pi(i=>yp(i),vp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function dj(t,e,n,s){return new uj(t,e,n,s)}async function g1(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const a=[],c=[];let u=Ae();for(const d of r){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(s,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:c}))})})}function hj(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const m=d.batch,p=m.keys();let y=z.resolve();return p.forEach(T=>{y=y.next(()=>f.getEntry(u,T)).next(C=>{const P=d.docVersions.get(T);Le(P!==null,48541),C.version.compareTo(P)<0&&(m.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),f.addEntry(C)))})}),y.next(()=>c.mutationQueue.removeMutationBatch(u,m))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(c){let u=Ae();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function x1(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function fj(t,e){const n=ve(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const c=[];e.targetChanges.forEach((f,m)=>{const p=r.get(m);if(!p)return;c.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,m)));let y=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?y=y.withResumeToken(jt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,s)),r=r.insert(m,y),function(C,P,b){return C.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=cj?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(p,y,f)&&c.push(n.Pi.updateTargetData(i,y))});let u=Is(),d=Ae();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(mj(i,a,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!s.isEqual(ye.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));c.push(f)}return z.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=r,i))}function mj(t,e,n){let s=Ae(),r=Ae();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let a=Is();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(c)),u.isNoDocument()&&u.version.isEqual(ye.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):re(kp,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:r}})}function pj(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=gp),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function gj(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,z.resolve(r)):n.Pi.allocateTargetId(s).next(a=>(r=new Ys(e,a,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function nm(t,e,n){const s=ve(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,a=>s.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Oo(a))throw a;re(kp,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function xy(t,e,n){const s=ve(t);let r=ye.min(),i=Ae();return s.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const m=ve(u),p=m.xs.get(f);return p!==void 0?z.resolve(m.Ms.get(p)):m.Pi.getTargetData(d,f)}(s,a,Jn(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(a,e,n?r:ye.min(),n?i:Ae())).next(c=>(xj(s,sA(e),c),{documents:c,Qs:i})))}function xj(t,e,n){let s=t.Os.get(e)||ye.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class yy{constructor(){this.activeTargetIds=cA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yj{constructor(){this.Mo=new yy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yy,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy="ConnectivityMonitor";class wy{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){re(vy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){re(vy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc=null;function sm(){return xc===null?xc=function(){return 268435456+Math.round(2147483648*Math.random())}():xc++,"0x"+xc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="RestConnection",wj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Nu?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const a=sm(),c=this.zo(e,n.toUriEncodedString());re(Ch,`Sending RPC '${e}' ${a}:`,c,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:d}=new URL(c),f=Ro(d);return this.Jo(e,c,u,s,f).then(m=>(re(Ch,`Received RPC '${e}' ${a}: `,m),m),m=>{throw mo(Ch,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",s),m})}Ho(e,n,s,r,i,a){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Do}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=wj[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection";class Nj extends bj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const a=sm();return new Promise((c,u)=>{const d=new v_;d.setWithCredentials(!0),d.listenOnce(w_.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Dc.NO_ERROR:const m=d.getResponseJson();re(Dt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case Dc.TIMEOUT:re(Dt,`RPC '${e}' ${a} timed out`),u(new Y(F.DEADLINE_EXCEEDED,"Request time out"));break;case Dc.HTTP_ERROR:const p=d.getStatus();if(re(Dt,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y==null?void 0:y.error;if(T&&T.status&&T.message){const C=function(b){const E=b.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(E)>=0?E:F.UNKNOWN}(T.status);u(new Y(C,T.message))}else u(new Y(F.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Y(F.UNAVAILABLE,"Connection failed."));break;default:fe(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{re(Dt,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(r);re(Dt,`RPC '${e}' ${a} sending request:`,r),d.send(n,"POST",f,s,15)})}T_(e,n,s){const r=sm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=N_(),c=__(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,s),u.encodeInitMessageHeaders=!0;const f=i.join("");re(Dt,`Creating RPC '${e}' stream ${r}: ${f}`,u);const m=a.createWebChannel(f,u);this.I_(m);let p=!1,y=!1;const T=new _j({Yo:P=>{y?re(Dt,`Not sending because RPC '${e}' stream ${r} is closed:`,P):(p||(re(Dt,`Opening RPC '${e}' stream ${r} transport.`),m.open(),p=!0),re(Dt,`RPC '${e}' stream ${r} sending:`,P),m.send(P))},Zo:()=>m.close()}),C=(P,b,E)=>{P.listen(b,S=>{try{E(S)}catch(R){setTimeout(()=>{throw R},0)}})};return C(m,ma.EventType.OPEN,()=>{y||(re(Dt,`RPC '${e}' stream ${r} transport opened.`),T.o_())}),C(m,ma.EventType.CLOSE,()=>{y||(y=!0,re(Dt,`RPC '${e}' stream ${r} transport closed`),T.a_(),this.E_(m))}),C(m,ma.EventType.ERROR,P=>{y||(y=!0,mo(Dt,`RPC '${e}' stream ${r} transport errored. Name:`,P.name,"Message:",P.message),T.a_(new Y(F.UNAVAILABLE,"The operation could not be completed")))}),C(m,ma.EventType.MESSAGE,P=>{var b;if(!y){const E=P.data[0];Le(!!E,16349);const S=E,R=(S==null?void 0:S.error)||((b=S[0])==null?void 0:b.error);if(R){re(Dt,`RPC '${e}' stream ${r} received error:`,R);const L=R.status;let U=function(v){const _=mt[v];if(_!==void 0)return r1(_)}(L),N=R.message;U===void 0&&(U=F.INTERNAL,N="Unknown error status: "+L+" with message "+R.message),y=!0,T.a_(new Y(U,N)),m.close()}else re(Dt,`RPC '${e}' stream ${r} received:`,E),T.u_(E)}}),C(c,b_.STAT_EVENT,P=>{P.stat===qf.PROXY?re(Dt,`RPC '${e}' stream ${r} detected buffering proxy`):P.stat===qf.NOPROXY&&re(Dt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){return new SA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&re("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="PersistentStream";class v1{constructor(e,n,s,r,i,a,c,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new y1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Es(n.toString()),Es("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new Y(F.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return re(by,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(re(by,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ej extends v1{constructor(e,n,s,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=AA(this.serializer,e),s=function(i){if(!("targetChange"in i))return ye.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ye.min():a.readTime?Zn(a.readTime):ye.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=tm(this.serializer),n.addTarget=function(i,a){let c;const u=a.target;if(c=Yf(u)?{documents:PA(i,u)}:{query:DA(i,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=a1(i,a.resumeToken);const d=Jf(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(ye.min())>0){c.readTime=Su(i,a.snapshotVersion.toTimestamp());const d=Jf(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const s=OA(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=tm(this.serializer),n.removeTarget=e,this.q_(n)}}class Ij extends v1{constructor(e,n,s,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=RA(e.writeResults,e.commitTime),s=Zn(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=tm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>jA(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{}class Sj extends Tj{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,Zf(n,s),r,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y(F.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,Zf(n,s),r,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Y(F.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class kj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Es(n),this.aa=!1):re("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si="RemoteStore";class Cj{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{s.enqueueAndForget(async()=>{gi(this)&&(re(si,"Restarting streams for network reachability change."),await async function(u){const d=ve(u);d.Ea.add(4),await Nl(d),d.Ra.set("Unknown"),d.Ea.delete(4),await wd(d)}(this))})}),this.Ra=new kj(s,r)}}async function wd(t){if(gi(t))for(const e of t.da)await e(!0)}async function Nl(t){for(const e of t.da)await e(!1)}function w1(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Rp(n)?jp(n):Vo(n).O_()&&Ap(n,e))}function Cp(t,e){const n=ve(t),s=Vo(n);n.Ia.delete(e),s.O_()&&b1(n,e),n.Ia.size===0&&(s.O_()?s.L_():gi(n)&&n.Ra.set("Unknown"))}function Ap(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Vo(t).Y_(e)}function b1(t,e){t.Va.Ue(e),Vo(t).Z_(e)}function jp(t){t.Va=new NA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Vo(t).start(),t.Ra.ua()}function Rp(t){return gi(t)&&!Vo(t).x_()&&t.Ia.size>0}function gi(t){return ve(t).Ea.size===0}function _1(t){t.Va=void 0}async function Aj(t){t.Ra.set("Online")}async function jj(t){t.Ia.forEach((e,n)=>{Ap(t,e)})}async function Rj(t,e){_1(t),Rp(t)?(t.Ra.ha(e),jp(t)):t.Ra.set("Unknown")}async function Pj(t,e,n){if(t.Ra.set("Online"),e instanceof o1&&e.state===2&&e.cause)try{await async function(r,i){const a=i.cause;for(const c of i.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,a),r.Ia.delete(c),r.Va.removeTarget(c))}(t,e)}catch(s){re(si,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Cu(t,s)}else if(e instanceof Lc?t.Va.Ze(e):e instanceof i1?t.Va.st(e):t.Va.tt(e),!n.isEqual(ye.min()))try{const s=await x1(t.localStore);n.compareTo(s)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(jt.EMPTY_BYTE_STRING,f.snapshotVersion)),b1(i,u);const m=new Ys(f.target,u,d,f.sequenceNumber);Ap(i,m)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(s){re(si,"Failed to raise snapshot:",s),await Cu(t,s)}}async function Cu(t,e,n){if(!Oo(e))throw e;t.Ea.add(1),await Nl(t),t.Ra.set("Offline"),n||(n=()=>x1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re(si,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await wd(t)})}function N1(t,e){return e().catch(n=>Cu(t,n,e))}async function bd(t){const e=ve(t),n=wr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:gp;for(;Dj(e);)try{const r=await pj(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,Mj(e,r)}catch(r){await Cu(e,r)}E1(e)&&I1(e)}function Dj(t){return gi(t)&&t.Ta.length<10}function Mj(t,e){t.Ta.push(e);const n=wr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function E1(t){return gi(t)&&!wr(t).x_()&&t.Ta.length>0}function I1(t){wr(t).start()}async function Oj(t){wr(t).ra()}async function Vj(t){const e=wr(t);for(const n of t.Ta)e.ea(n.mutations)}async function Lj(t,e,n){const s=t.Ta.shift(),r=_p.from(s,e,n);await N1(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await bd(t)}async function Fj(t,e){e&&wr(t).X_&&await async function(s,r){if(function(a){return wA(a)&&a!==F.ABORTED}(r.code)){const i=s.Ta.shift();wr(s).B_(),await N1(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await bd(s)}}(t,e),E1(t)&&I1(t)}async function _y(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),re(si,"RemoteStore received new credentials");const s=gi(n);n.Ea.add(3),await Nl(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await wd(n)}async function Uj(t,e){const n=ve(t);e?(n.Ea.delete(2),await wd(n)):e||(n.Ea.add(2),await Nl(n),n.Ra.set("Unknown"))}function Vo(t){return t.ma||(t.ma=function(n,s,r){const i=ve(n);return i.sa(),new Ej(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:Aj.bind(null,t),t_:jj.bind(null,t),r_:Rj.bind(null,t),H_:Pj.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Rp(t)?jp(t):t.Ra.set("Unknown")):(await t.ma.stop(),_1(t))})),t.ma}function wr(t){return t.fa||(t.fa=function(n,s,r){const i=ve(n);return i.sa(),new Ij(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Oj.bind(null,t),r_:Fj.bind(null,t),ta:Vj.bind(null,t),na:Lj.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await bd(t)):(await t.fa.stop(),t.Ta.length>0&&(re(si,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const a=Date.now()+s,c=new Pp(e,n,a,r,i);return c.start(s),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dp(t,e){if(Es("AsyncQueue",`${e}: ${t}`),Oo(t))return new Y(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{static emptySet(e){return new Zi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||he.comparator(n.key,s.key):(n,s)=>he.comparator(n.key,s.key),this.keyedMap=pa(),this.sortedSet=new rt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Zi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Zi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.ga=new rt(he.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):fe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class _o{constructor(e,n,s,r,i,a,c,u,d){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,s,r,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new _o(e,n,Zi.emptySet(n),a,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class zj{constructor(){this.queries=Ey(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=ve(n),i=r.queries;r.queries=Ey(),i.forEach((a,c)=>{for(const u of c.Sa)u.onError(s)})})(this,new Y(F.ABORTED,"Firestore shutting down"))}}function Ey(){return new pi(t=>H_(t),hd)}async function Mp(t,e){const n=ve(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new $j,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const c=Dp(a,`Initialization of query '${ki(e.query)}' failed`);return void e.onError(c)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Vp(n)}async function Op(t,e){const n=ve(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function Bj(t,e){const n=ve(t);let s=!1;for(const r of e){const i=r.query,a=n.queries.get(i);if(a){for(const c of a.Sa)c.Fa(r)&&(s=!0);a.wa=r}}s&&Vp(n)}function qj(t,e,n){const s=ve(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function Vp(t){t.Ca.forEach(e=>{e.next()})}var rm,Iy;(Iy=rm||(rm={})).Ma="default",Iy.Cache="cache";class Lp{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new _o(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=_o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e){this.key=e}}class S1{constructor(e){this.key=e}}class Hj{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ae(),this.mutatedKeys=Ae(),this.eu=G_(e),this.tu=new Zi(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new Ny,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,a=r,c=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,d=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,m)=>{const p=r.get(f),y=fd(this.query,m)?m:null,T=!!p&&this.mutatedKeys.has(p.key),C=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let P=!1;p&&y?p.data.isEqual(y.data)?T!==C&&(s.track({type:3,doc:y}),P=!0):this.su(p,y)||(s.track({type:2,doc:y}),P=!0,(u&&this.eu(y,u)>0||d&&this.eu(y,d)<0)&&(c=!0)):!p&&y?(s.track({type:0,doc:y}),P=!0):p&&!y&&(s.track({type:1,doc:p}),P=!0,(u||d)&&(c=!0)),P&&(y?(a=a.add(y),i=C?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),s.track({type:1,doc:f})}return{tu:a,iu:s,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,m)=>function(y,T){const C=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe(20277,{Rt:P})}};return C(y)-C(T)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(s),r=r??!1;const c=n&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new _o(this.query,e.tu,i,a,e.mutatedKeys,u===0,d,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ny,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ae(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new S1(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new T1(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ae();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return _o.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fp="SyncEngine";class Gj{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class Wj{constructor(e){this.key=e,this.hu=!1}}class Kj{constructor(e,n,s,r,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new pi(c=>H_(c),hd),this.Iu=new Map,this.Eu=new Set,this.du=new rt(he.comparator),this.Au=new Map,this.Ru=new Ip,this.Vu={},this.mu=new Map,this.fu=bo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qj(t,e,n=!0){const s=P1(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await k1(s,e,n,!0),r}async function Yj(t,e){const n=P1(t);await k1(n,e,!0,!1)}async function k1(t,e,n,s){const r=await gj(t.localStore,Jn(e)),i=r.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return s&&(c=await Xj(t,e,i,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&w1(t.remoteStore,r),c}async function Xj(t,e,n,s,r){t.pu=(m,p,y)=>async function(C,P,b,E){let S=P.view.ru(b);S.Cs&&(S=await xy(C.localStore,P.query,!1).then(({documents:N})=>P.view.ru(N,S)));const R=E&&E.targetChanges.get(P.targetId),L=E&&E.targetMismatches.get(P.targetId)!=null,U=P.view.applyChanges(S,C.isPrimaryClient,R,L);return Sy(C,P.targetId,U.au),U.snapshot}(t,m,p,y);const i=await xy(t.localStore,e,!0),a=new Hj(e,i.Qs),c=a.ru(i.documents),u=_l.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),d=a.applyChanges(c,t.isPrimaryClient,u);Sy(t,n,d.au);const f=new Gj(e,n,a);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function Jj(t,e,n){const s=ve(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(a=>!hd(a,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await nm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&Cp(s.remoteStore,r.targetId),im(s,r.targetId)}).catch(Mo)):(im(s,r.targetId),await nm(s.localStore,r.targetId,!0))}async function Zj(t,e){const n=ve(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Cp(n.remoteStore,s.targetId))}async function e4(t,e,n){const s=a4(t);try{const r=await function(a,c){const u=ve(a),d=ze.now(),f=c.reduce((y,T)=>y.add(T.key),Ae());let m,p;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=Is(),C=Ae();return u.Ns.getEntries(y,f).next(P=>{T=P,T.forEach((b,E)=>{E.isValidDocument()||(C=C.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,T)).next(P=>{m=P;const b=[];for(const E of c){const S=pA(E,m.get(E.key).overlayedDocument);S!=null&&b.push(new kr(E.key,S,L_(S.value.mapValue),Ht.exists(!0)))}return u.mutationQueue.addMutationBatch(y,d,b,c)}).next(P=>{p=P;const b=P.applyToLocalDocumentSet(m,C);return u.documentOverlayCache.saveOverlays(y,P.batchId,b)})}).then(()=>({batchId:p.batchId,changes:K_(m)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(a,c,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new rt(Ce)),d=d.insert(c,u),a.Vu[a.currentUser.toKey()]=d}(s,r.batchId,n),await El(s,r.changes),await bd(s.remoteStore)}catch(r){const i=Dp(r,"Failed to persist write");n.reject(i)}}async function C1(t,e){const n=ve(t);try{const s=await fj(n.localStore,e);e.targetChanges.forEach((r,i)=>{const a=n.Au.get(i);a&&(Le(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Le(a.hu,14607):r.removedDocuments.size>0&&(Le(a.hu,42227),a.hu=!1))}),await El(n,s,e)}catch(s){await Mo(s)}}function Ty(t,e,n){const s=ve(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){const u=ve(a);u.onlineState=c;let d=!1;u.queries.forEach((f,m)=>{for(const p of m.Sa)p.va(c)&&(d=!0)}),d&&Vp(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function t4(t,e,n){const s=ve(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let a=new rt(he.comparator);a=a.insert(i,Vt.newNoDocument(i,ye.min()));const c=Ae().add(i),u=new yd(ye.min(),new Map,new rt(Ce),a,c);await C1(s,u),s.du=s.du.remove(i),s.Au.delete(e),Up(s)}else await nm(s.localStore,e,!1).then(()=>im(s,e,n)).catch(Mo)}async function n4(t,e){const n=ve(t),s=e.batch.batchId;try{const r=await hj(n.localStore,e);j1(n,s,null),A1(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await El(n,r)}catch(r){await Mo(r)}}async function s4(t,e,n){const s=ve(t);try{const r=await function(a,c){const u=ve(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(m=>(Le(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(s.localStore,e);j1(s,e,n),A1(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await El(s,r)}catch(r){await Mo(r)}}function A1(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function j1(t,e,n){const s=ve(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function im(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||R1(t,s)})}function R1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Cp(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Up(t))}function Sy(t,e,n){for(const s of n)s instanceof T1?(t.Ru.addReference(s.key,e),r4(t,s)):s instanceof S1?(re(Fp,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||R1(t,s.key)):fe(19791,{wu:s})}function r4(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(re(Fp,"New document in limbo: "+n),t.Eu.add(s),Up(t))}function Up(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new he(qe.fromString(e)),s=t.fu.next();t.Au.set(s,new Wj(n)),t.du=t.du.insert(n,s),w1(t.remoteStore,new Ys(Jn(dd(n.path)),s,"TargetPurposeLimboResolution",ad.ce))}}async function El(t,e,n){const s=ve(t),r=[],i=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach((c,u)=>{a.push(s.pu(u,e,n).then(d=>{var f;if((d||n)&&s.isPrimaryClient){const m=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:f.current;s.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){r.push(d);const m=Sp.As(u.targetId,d);i.push(m)}}))}),await Promise.all(a),s.Pu.H_(r),await async function(u,d){const f=ve(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>z.forEach(d,p=>z.forEach(p.Es,y=>f.persistence.referenceDelegate.addReference(m,p.targetId,y)).next(()=>z.forEach(p.ds,y=>f.persistence.referenceDelegate.removeReference(m,p.targetId,y)))))}catch(m){if(!Oo(m))throw m;re(kp,"Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const y=f.Ms.get(p),T=y.snapshotVersion,C=y.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(p,C)}}}(s.localStore,i))}async function i4(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){re(Fp,"User change. New user:",e.toKey());const s=await g1(n.localStore,e);n.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new Y(F.CANCELLED,a))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await El(n,s.Ls)}}function o4(t,e){const n=ve(t),s=n.Au.get(e);if(s&&s.hu)return Ae().add(s.key);{let r=Ae();const i=n.Iu.get(e);if(!i)return r;for(const a of i){const c=n.Tu.get(a);r=r.unionWith(c.view.nu)}return r}}function P1(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=C1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=o4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=t4.bind(null,e),e.Pu.H_=Bj.bind(null,e.eventManager),e.Pu.yu=qj.bind(null,e.eventManager),e}function a4(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=n4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s4.bind(null,e),e}class Au{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return dj(this.persistence,new lj,e.initialUser,this.serializer)}Cu(e){return new p1(Tp.mi,this.serializer)}Du(e){return new yj}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Au.provider={build:()=>new Au};class l4 extends Au{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Le(this.persistence.referenceDelegate instanceof ku,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new WA(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new p1(s=>ku.mi(s,n),this.serializer)}}class om{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Ty(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=i4.bind(null,this.syncEngine),await Uj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zj}()}createDatastore(e){const n=vd(e.databaseInfo.databaseId),s=function(i){return new Nj(i)}(e.databaseInfo);return function(i,a,c,u){return new Sj(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,a,c){return new Cj(s,r,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Ty(this.syncEngine,n,0),function(){return wy.v()?new wy:new vj}())}createSyncEngine(e,n){return function(r,i,a,c,u,d,f){const m=new Kj(r,i,a,c,u,d);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=ve(r);re(si,"RemoteStore shutting down."),i.Ea.add(5),await Nl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}om.provider={build:()=>new om};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Es("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="FirestoreClient";class c4{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Mt.UNAUTHENTICATED,this.clientId=pp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async a=>{re(br,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(s,a=>(re(br,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Dp(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function jh(t,e){t.asyncQueue.verifyOperationInProgress(),re(br,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await g1(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ky(t,e){t.asyncQueue.verifyOperationInProgress();const n=await u4(t);re(br,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>_y(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>_y(e.remoteStore,r)),t._onlineComponents=e}async function u4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re(br,"Using user provided OfflineComponentProvider");try{await jh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===F.FAILED_PRECONDITION||r.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;mo("Error using user provided cache. Falling back to memory cache: "+n),await jh(t,new Au)}}else re(br,"Using default OfflineComponentProvider"),await jh(t,new l4(void 0));return t._offlineComponents}async function D1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re(br,"Using user provided OnlineComponentProvider"),await ky(t,t._uninitializedComponentsProvider._online)):(re(br,"Using default OnlineComponentProvider"),await ky(t,new om))),t._onlineComponents}function d4(t){return D1(t).then(e=>e.syncEngine)}async function ju(t){const e=await D1(t),n=e.eventManager;return n.onListen=Qj.bind(null,e.syncEngine),n.onUnlisten=Jj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Yj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Zj.bind(null,e.syncEngine),n}function h4(t,e,n={}){const s=new ys;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new $p({next:p=>{f.Nu(),a.enqueueAndForget(()=>Op(i,m));const y=p.docs.has(c);!y&&p.fromCache?d.reject(new Y(F.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&p.fromCache&&u&&u.source==="server"?d.reject(new Y(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new Lp(dd(c.path),f,{includeMetadataChanges:!0,qa:!0});return Mp(i,m)}(await ju(t),t.asyncQueue,e,n,s)),s.promise}function f4(t,e,n={}){const s=new ys;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new $p({next:p=>{f.Nu(),a.enqueueAndForget(()=>Op(i,m)),p.fromCache&&u.source==="server"?d.reject(new Y(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new Lp(c,f,{includeMetadataChanges:!0,qa:!0});return Mp(i,m)}(await ju(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="firestore.googleapis.com",Ay=!0;class jy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=O1,this.ssl=Ay}else this.host=e.host,this.ssl=e.ssl??Ay;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=m1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HA)throw new Y(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}AC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=M1(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Y(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _d{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new wC;switch(s.type){case"firstParty":return new EC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Y(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=Cy.get(n);s&&(re("ComponentProvider","Removing Datastore"),Cy.delete(n),s.terminate())}(this),Promise.resolve()}}function m4(t,e,n,s={}){var d;t=qt(t,_d);const r=Ro(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;r&&(a_(`https://${c}`),l_("Firestore",!0)),i.host!==O1&&i.host!==c&&mo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:r,emulatorOptions:s};if(!ss(u,a)&&(t._setSettings(u),s.mockUserToken)){let f,m;if(typeof s.mockUserToken=="string")f=s.mockUserToken,m=Mt.MOCK_USER;else{f=GS(s.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new Y(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Mt(p)}t._authCredentials=new bC(new I_(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ls(this.firestore,e,this._query)}}class at{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new at(this.firestore,e,this._key)}toJSON(){return{type:at._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(wl(n,at._jsonSchema))return new at(e,s||null,new he(qe.fromString(n.referencePath)))}}at._jsonSchemaVersion="firestore/documentReference/1.0",at._jsonSchema={type:xt("string",at._jsonSchemaVersion),referencePath:xt("string")};class lr extends ls{constructor(e,n,s){super(e,n,dd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new at(this.firestore,null,new he(e))}withConverter(e){return new lr(this.firestore,e,this._path)}}function Pe(t,e,...n){if(t=Ze(t),T_("collection","path",e),t instanceof _d){const s=qe.fromString(e,...n);return Hx(s),new lr(t,null,s)}{if(!(t instanceof at||t instanceof lr))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(qe.fromString(e,...n));return Hx(s),new lr(t.firestore,null,s)}}function He(t,e,...n){if(t=Ze(t),arguments.length===1&&(e=pp.newId()),T_("doc","path",e),t instanceof _d){const s=qe.fromString(e,...n);return qx(s),new at(t,null,new he(s))}{if(!(t instanceof at||t instanceof lr))throw new Y(F.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(qe.fromString(e,...n));return qx(s),new at(t.firestore,t instanceof lr?t.converter:null,new he(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry="AsyncQueue";class Py{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new y1(this,"async_queue_retry"),this._c=()=>{const s=Ah();s&&re(Ry,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=Ah();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ah();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new ys;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Oo(e))throw e;re(Ry,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Es("INTERNAL UNHANDLED ERROR: ",Dy(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Pp.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&fe(47125,{Pc:Dy(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Dy(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class os extends _d{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new Py,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Py(e),this._firestoreClient=void 0,await e}}}function p4(t,e){const n=typeof t=="object"?t:fp(),s=typeof t=="string"?t:Nu,r=fi(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=qS("firestore");i&&m4(r,...i)}return r}function Il(t){if(t._terminated)throw new Y(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||g4(t),t._firestoreClient}function g4(t){var s,r,i;const e=t._freezeSettings(),n=function(c,u,d,f){return new $C(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,M1(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new c4(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wn(jt.fromBase64String(e))}catch(n){throw new Y(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new wn(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:wn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wl(e,wn._jsonSchema))return wn.fromBase64String(e.bytes)}}wn._jsonSchemaVersion="firestore/bytes/1.0",wn._jsonSchema={type:xt("string",wn._jsonSchemaVersion),bytes:xt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Y(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function am(){return new Lo(Gf)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Y(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Y(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:es._jsonSchemaVersion}}static fromJSON(e){if(wl(e,es._jsonSchema))return new es(e.latitude,e.longitude)}}es._jsonSchemaVersion="firestore/geoPoint/1.0",es._jsonSchema={type:xt("string",es._jsonSchemaVersion),latitude:xt("number"),longitude:xt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wl(e,ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ts(e.vectorValues);throw new Y(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ts._jsonSchemaVersion="firestore/vectorValue/1.0",ts._jsonSchema={type:xt("string",ts._jsonSchemaVersion),vectorValues:xt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=/^__.*__$/;class y4{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new kr(e,this.data,this.fieldMask,n,this.fieldTransforms):new bl(e,this.data,n,this.fieldTransforms)}}class V1{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new kr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function L1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe(40011,{Ac:t})}}class Nd{constructor(e,n,s,r,i,a){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Nd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ru(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(L1(this.Ac)&&x4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class v4{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||vd(e)}Cc(e,n,s,r=!1){return new Nd({Ac:e,methodName:n,Dc:s,path:kt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fo(t){const e=t._freezeSettings(),n=vd(t._databaseId);return new v4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function zp(t,e,n,s,r,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);Wp("Data must be an object, but it was:",a,s);const c=B1(s,a);let u,d;if(i.merge)u=new cn(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const p=lm(e,m,n);if(!a.contains(p))throw new Y(F.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);H1(f,p)||f.push(p)}u=new cn(f),d=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=a.fieldTransforms;return new y4(new Jt(c),u,d)}class Tl extends xi{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tl}}function F1(t,e,n){return new Nd({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Bp extends xi{_toFieldTransform(e){return new pd(e.path,new ll)}isEqual(e){return e instanceof Bp}}class qp extends xi{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=F1(this,e,!0),s=this.vc.map(i=>yi(i,n)),r=new vo(s);return new pd(e.path,r)}isEqual(e){return e instanceof qp&&ss(this.vc,e.vc)}}class Hp extends xi{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=F1(this,e,!0),s=this.vc.map(i=>yi(i,n)),r=new wo(s);return new pd(e.path,r)}isEqual(e){return e instanceof Hp&&ss(this.vc,e.vc)}}class Gp extends xi{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new cl(e.serializer,X_(e.serializer,this.Fc));return new pd(e.path,n)}isEqual(e){return e instanceof Gp&&this.Fc===e.Fc}}function U1(t,e,n,s){const r=t.Cc(1,e,n);Wp("Data must be an object, but it was:",r,s);const i=[],a=Jt.empty();Sr(s,(u,d)=>{const f=Kp(e,u,n);d=Ze(d);const m=r.yc(f);if(d instanceof Tl)i.push(f);else{const p=yi(d,m);p!=null&&(i.push(f),a.set(f,p))}});const c=new cn(i);return new V1(a,c,r.fieldTransforms)}function $1(t,e,n,s,r,i){const a=t.Cc(1,e,n),c=[lm(e,s,n)],u=[r];if(i.length%2!=0)throw new Y(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)c.push(lm(e,i[p])),u.push(i[p+1]);const d=[],f=Jt.empty();for(let p=c.length-1;p>=0;--p)if(!H1(d,c[p])){const y=c[p];let T=u[p];T=Ze(T);const C=a.yc(y);if(T instanceof Tl)d.push(y);else{const P=yi(T,C);P!=null&&(d.push(y),f.set(y,P))}}const m=new cn(d);return new V1(f,m,a.fieldTransforms)}function z1(t,e,n,s=!1){return yi(n,t.Cc(s?4:3,e))}function yi(t,e){if(q1(t=Ze(t)))return Wp("Unsupported field value:",e,t),B1(t,e);if(t instanceof xi)return function(s,r){if(!L1(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let a=0;for(const c of s){let u=yi(c,r.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Ze(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return X_(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=ze.fromDate(s);return{timestampValue:Su(r.serializer,i)}}if(s instanceof ze){const i=new ze(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Su(r.serializer,i)}}if(s instanceof es)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof wn)return{bytesValue:a1(r.serializer,s._byteString)};if(s instanceof at){const i=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(i))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ep(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof ts)return function(a,c){return{mapValue:{fields:{[O_]:{stringValue:V_},[Eu]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return bp(c.serializer,d)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${od(s)}`)}(t,e)}function B1(t,e){const n={};return A_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sr(t,(s,r)=>{const i=yi(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function q1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof es||t instanceof wn||t instanceof at||t instanceof xi||t instanceof ts)}function Wp(t,e,n){if(!q1(n)||!S_(n)){const s=od(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function lm(t,e,n){if((e=Ze(e))instanceof Lo)return e._internalPath;if(typeof e=="string")return Kp(t,e);throw Ru("Field path arguments must be of type string or ",t,!1,void 0,n)}const w4=new RegExp("[~\\*/\\[\\]]");function Kp(t,e,n){if(e.search(w4)>=0)throw Ru(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Lo(...e.split("."))._internalPath}catch{throw Ru(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ru(t,e,n,s,r){const i=s&&!s.isEmpty(),a=r!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${s}`),a&&(u+=` in document ${r}`),u+=")"),new Y(F.INVALID_ARGUMENT,c+t+u)}function H1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new at(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new b4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ed("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class b4 extends Qp{data(){return super.data()}}function Ed(t,e){return typeof e=="string"?Kp(t,e):e instanceof Lo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Y(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yp{}class Id extends Yp{}function tt(t,e,...n){let s=[];e instanceof Yp&&s.push(e),s=s.concat(n),function(i){const a=i.filter(u=>u instanceof Xp).length,c=i.filter(u=>u instanceof Td).length;if(a>1||a>0&&c>0)throw new Y(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class Td extends Id{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Td(e,n,s)}_apply(e){const n=this._parse(e);return W1(e._query,n),new ls(e.firestore,e.converter,Xf(e._query,n))}_parse(e){const n=Fo(e.firestore);return function(i,a,c,u,d,f,m){let p;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Y(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Vy(m,f);const T=[];for(const C of m)T.push(Oy(u,i,C));p={arrayValue:{values:T}}}else p=Oy(u,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Vy(m,f),p=z1(c,a,m,f==="in"||f==="not-in");return gt.create(d,f,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function dt(t,e,n){const s=e,r=Ed("where",t);return Td._create(r,s,n)}class Xp extends Yp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Xp(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:Ln.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const u of c)W1(a,u),a=Xf(a,u)}(e._query,n),new ls(e.firestore,e.converter,Xf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jp extends Id{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Jp(e,n)}_apply(e){const n=function(r,i,a){if(r.startAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Y(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new al(i,a)}(e._query,this._field,this._direction);return new ls(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new mi(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function Wr(t,e="asc"){const n=e,s=Ed("orderBy",t);return Jp._create(s,n)}class Sd extends Id{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new Sd(e,n,s)}_apply(e){return new ls(e.firestore,e.converter,Tu(e._query,this._limit,this._limitType))}}function No(t){return k_("limit",t),Sd._create("limit",t,"F")}function _4(t){return k_("limitToLast",t),Sd._create("limitToLast",t,"L")}class Zp extends Id{constructor(e,n,s){super(),this.type=e,this._docOrFields=n,this._inclusive=s}static _create(e,n,s){return new Zp(e,n,s)}_apply(e){const n=E4(e,this.type,this._docOrFields,this._inclusive);return new ls(e.firestore,e.converter,function(r,i){return new mi(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)}(e._query,n))}}function N4(...t){return Zp._create("startAfter",t,!1)}function E4(t,e,n,s){if(n[0]=Ze(n[0]),n[0]instanceof Qp)return function(i,a,c,u,d){if(!u)throw new Y(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const f=[];for(const m of Ji(i))if(m.field.isKeyField())f.push(Iu(a,u.key));else{const p=u.data.field(m.field);if(cd(p))throw new Y(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const y=m.field.canonicalString();throw new Y(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}f.push(p)}return new yo(f,d)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=Fo(t.firestore);return function(a,c,u,d,f,m){const p=a.explicitOrderBy;if(f.length>p.length)throw new Y(F.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let T=0;T<f.length;T++){const C=f[T];if(p[T].field.isKeyField()){if(typeof C!="string")throw new Y(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!wp(a)&&C.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const P=a.path.child(qe.fromString(C));if(!he.isDocumentKey(P))throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const b=new he(P);y.push(Iu(c,b))}else{const P=z1(u,d,C);y.push(P)}}return new yo(y,m)}(t._query,t.firestore._databaseId,r,e,n,s)}}function Oy(t,e,n){if(typeof(n=Ze(n))=="string"){if(n==="")throw new Y(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wp(e)&&n.indexOf("/")!==-1)throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(qe.fromString(n));if(!he.isDocumentKey(s))throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Iu(t,new he(s))}if(n instanceof at)return Iu(t,n._key);throw new Y(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${od(n)}.`)}function Vy(t,e){if(!Array.isArray(t)||t.length===0)throw new Y(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function W1(t,e){const n=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Y(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class I4{convertValue(e,n="none"){switch(vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw fe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Sr(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var s,r,i;const n=(i=(r=(s=e.fields)==null?void 0:s[Eu].arrayValue)==null?void 0:r.values)==null?void 0:i.map(a=>ct(a.doubleValue));return new ts(n)}convertGeoPoint(e){return new es(ct(e.latitude),ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=ud(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(rl(e));default:return null}}convertTimestamp(e){const n=xr(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=qe.fromString(e);Le(f1(s),9688,{name:e});const r=new il(s.get(1),s.get(3)),i=new he(s.popFirst(5));return r.isEqual(n)||Es(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class xa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Kr extends Qp{constructor(e,n,s,r,i,a){super(e,n,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Fc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Ed("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Kr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Kr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Kr._jsonSchema={type:xt("string",Kr._jsonSchemaVersion),bundleSource:xt("string","DocumentSnapshot"),bundleName:xt("string"),bundle:xt("string")};class Fc extends Kr{data(e={}){return super.data(e)}}class Qr{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new xa(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Fc(this._firestore,this._userDataWriter,s.key,s,new xa(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{const u=new Fc(r._firestore,r._userDataWriter,c.doc.key,c.doc,new xa(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Fc(r._firestore,r._userDataWriter,c.doc.key,c.doc,new xa(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let d=-1,f=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:T4(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=pp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function T4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t){t=qt(t,at);const e=qt(t.firestore,os);return h4(Il(e),t._key).then(n=>K1(e,t,n))}Qr._jsonSchemaVersion="firestore/querySnapshot/1.0",Qr._jsonSchema={type:xt("string",Qr._jsonSchemaVersion),bundleSource:xt("string","QuerySnapshot"),bundleName:xt("string"),bundle:xt("string")};class tg extends I4{constructor(e){super(),this.firestore=e}convertBytes(e){return new wn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new at(this.firestore,null,n)}}function ht(t){t=qt(t,ls);const e=qt(t.firestore,os),n=Il(e),s=new tg(e);return G1(t._query),f4(n,t._query).then(r=>new Qr(e,s,t,r))}function Eo(t,e,n){t=qt(t,at);const s=qt(t.firestore,os),r=eg(t.converter,e,n);return Sl(s,[zp(Fo(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Ht.none())])}function hn(t,e,n,...s){t=qt(t,at);const r=qt(t.firestore,os),i=Fo(r);let a;return a=typeof(e=Ze(e))=="string"||e instanceof Lo?$1(i,"updateDoc",t._key,e,n,s):U1(i,"updateDoc",t._key,e),Sl(r,[a.toMutation(t._key,Ht.exists(!0))])}function S4(t){return Sl(qt(t.firestore,os),[new xd(t._key,Ht.none())])}function Ts(t,e){const n=qt(t.firestore,os),s=He(t),r=eg(t.converter,e);return Sl(n,[zp(Fo(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Ht.exists(!1))]).then(()=>s)}function ri(t,...e){var u,d,f;t=Ze(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||My(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(My(e[s])){const m=e[s];e[s]=(u=m.next)==null?void 0:u.bind(m),e[s+1]=(d=m.error)==null?void 0:d.bind(m),e[s+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,a,c;if(t instanceof at)a=qt(t.firestore,os),c=dd(t._key.path),i={next:m=>{e[s]&&e[s](K1(a,t,m))},error:e[s+1],complete:e[s+2]};else{const m=qt(t,ls);a=qt(m.firestore,os),c=m._query;const p=new tg(a);i={next:y=>{e[s]&&e[s](new Qr(a,p,m,y))},error:e[s+1],complete:e[s+2]},G1(t._query)}return function(p,y,T,C){const P=new $p(C),b=new Lp(y,P,T);return p.asyncQueue.enqueueAndForget(async()=>Mp(await ju(p),b)),()=>{P.Nu(),p.asyncQueue.enqueueAndForget(async()=>Op(await ju(p),b))}}(Il(a),c,r,i)}function Sl(t,e){return function(s,r){const i=new ys;return s.asyncQueue.enqueueAndForget(async()=>e4(await d4(s),r,i)),i.promise}(Il(t),e)}function K1(t,e,n){const s=n.docs.get(e._key),r=new tg(t);return new Kr(t,r,e._key,s,new xa(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Fo(e)}set(e,n,s){this._verifyNotCommitted();const r=Rh(e,this._firestore),i=eg(r.converter,n,s),a=zp(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(a.toMutation(r._key,Ht.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=Rh(e,this._firestore);let a;return a=typeof(n=Ze(n))=="string"||n instanceof Lo?$1(this._dataReader,"WriteBatch.update",i._key,n,s,r):U1(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,Ht.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Rh(e,this._firestore);return this._mutations=this._mutations.concat(new xd(n._key,Ht.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Y(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rh(t,e){if((t=Ze(t)).firestore!==e)throw new Y(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(){return new Tl("deleteField")}function cr(){return new Bp("serverTimestamp")}function ng(...t){return new qp("arrayUnion",t)}function cm(...t){return new Hp("arrayRemove",t)}function A4(t){return new Gp("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t){return Il(t=qt(t,os)),new k4(t,e=>Sl(t,e))}(function(e,n=!0){(function(r){Do=r})(Po),rs(new Vn("firestore",(s,{instanceIdentifier:r,options:i})=>{const a=s.getProvider("app").getImmediate(),c=new os(new _C(s.getProvider("auth-internal")),new IC(a,s.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Y(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new il(d.options.projectId,f)}(a,r),a);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Nn($x,zx,e),Nn($x,zx,"esm2020")})();var j4="firebase",R4="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn(j4,R4,"app");const Y1="@firebase/installations",sg="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=1e4,J1=`w:${sg}`,Z1="FIS_v2",P4="https://firebaseinstallations.googleapis.com/v1",D4=60*60*1e3,M4="installations",O4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ii=new hi(M4,O4,V4);function eN(t){return t instanceof Fn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN({projectId:t}){return`${P4}/projects/${t}/installations`}function nN(t){return{token:t.token,requestStatus:2,expiresIn:F4(t.expiresIn),creationTime:Date.now()}}async function sN(t,e){const s=(await e.json()).error;return ii.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function rN({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function L4(t,{refreshToken:e}){const n=rN(t);return n.append("Authorization",U4(e)),n}async function iN(t){const e=await t();return e.status>=500&&e.status<600?t():e}function F4(t){return Number(t.replace("s","000"))}function U4(t){return`${Z1} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=tN(t),r=rN(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&r.append("x-firebase-client",d)}const a={fid:n,authVersion:Z1,appId:t.appId,sdkVersion:J1},c={method:"POST",headers:r,body:JSON.stringify(a)},u=await iN(()=>fetch(s,c));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:nN(d.authToken)}}else throw await sN("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oN(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=/^[cdef][\w-]{21}$/,um="";function q4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=H4(t);return B4.test(n)?n:um}catch{return um}}function H4(t){return z4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=new Map;function lN(t,e){const n=kd(t);cN(n,e),G4(n,e)}function cN(t,e){const n=aN.get(t);if(n)for(const s of n)s(e)}function G4(t,e){const n=W4();n&&n.postMessage({key:t,fid:e}),K4()}let Br=null;function W4(){return!Br&&"BroadcastChannel"in self&&(Br=new BroadcastChannel("[Firebase] FID Change"),Br.onmessage=t=>{cN(t.data.key,t.data.fid)}),Br}function K4(){aN.size===0&&Br&&(Br.close(),Br=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="firebase-installations-database",Y4=1,oi="firebase-installations-store";let Ph=null;function rg(){return Ph||(Ph=m_(Q4,Y4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(oi)}}})),Ph}async function Pu(t,e){const n=kd(t),r=(await rg()).transaction(oi,"readwrite"),i=r.objectStore(oi),a=await i.get(n);return await i.put(e,n),await r.done,(!a||a.fid!==e.fid)&&lN(t,e.fid),e}async function uN(t){const e=kd(t),s=(await rg()).transaction(oi,"readwrite");await s.objectStore(oi).delete(e),await s.done}async function Cd(t,e){const n=kd(t),r=(await rg()).transaction(oi,"readwrite"),i=r.objectStore(oi),a=await i.get(n),c=e(a);return c===void 0?await i.delete(n):await i.put(c,n),await r.done,c&&(!a||a.fid!==c.fid)&&lN(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ig(t){let e;const n=await Cd(t.appConfig,s=>{const r=X4(s),i=J4(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===um?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function X4(t){const e=t||{fid:q4(),registrationStatus:0};return dN(e)}function J4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(ii.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=Z4(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:eR(t)}:{installationEntry:e}}async function Z4(t,e){try{const n=await $4(t,e);return Pu(t.appConfig,n)}catch(n){throw eN(n)&&n.customData.serverCode===409?await uN(t.appConfig):await Pu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function eR(t){let e=await Ly(t.appConfig);for(;e.registrationStatus===1;)await oN(100),e=await Ly(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await ig(t);return s||n}return e}function Ly(t){return Cd(t,e=>{if(!e)throw ii.create("installation-not-found");return dN(e)})}function dN(t){return tR(t)?{fid:t.fid,registrationStatus:0}:t}function tR(t){return t.registrationStatus===1&&t.registrationTime+X1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nR({appConfig:t,heartbeatServiceProvider:e},n){const s=sR(t,n),r=L4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&r.append("x-firebase-client",d)}const a={installation:{sdkVersion:J1,appId:t.appId}},c={method:"POST",headers:r,body:JSON.stringify(a)},u=await iN(()=>fetch(s,c));if(u.ok){const d=await u.json();return nN(d)}else throw await sN("Generate Auth Token",u)}function sR(t,{fid:e}){return`${tN(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function og(t,e=!1){let n;const s=await Cd(t.appConfig,i=>{if(!hN(i))throw ii.create("not-registered");const a=i.authToken;if(!e&&oR(a))return i;if(a.requestStatus===1)return n=rR(t,e),i;{if(!navigator.onLine)throw ii.create("app-offline");const c=lR(i);return n=iR(t,c),c}});return n?await n:s.authToken}async function rR(t,e){let n=await Fy(t.appConfig);for(;n.authToken.requestStatus===1;)await oN(100),n=await Fy(t.appConfig);const s=n.authToken;return s.requestStatus===0?og(t,e):s}function Fy(t){return Cd(t,e=>{if(!hN(e))throw ii.create("not-registered");const n=e.authToken;return cR(n)?{...e,authToken:{requestStatus:0}}:e})}async function iR(t,e){try{const n=await nR(t,e),s={...e,authToken:n};return await Pu(t.appConfig,s),n}catch(n){if(eN(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await uN(t.appConfig);else{const s={...e,authToken:{requestStatus:0}};await Pu(t.appConfig,s)}throw n}}function hN(t){return t!==void 0&&t.registrationStatus===2}function oR(t){return t.requestStatus===2&&!aR(t)}function aR(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+D4}function lR(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function cR(t){return t.requestStatus===1&&t.requestTime+X1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR(t){const e=t,{installationEntry:n,registrationPromise:s}=await ig(e);return s?s.catch(console.error):og(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(t,e=!1){const n=t;return await hR(n),(await og(n,e)).token}async function hR(t){const{registrationPromise:e}=await ig(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(t){if(!t||!t.options)throw Dh("App Configuration");if(!t.name)throw Dh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Dh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Dh(t){return ii.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN="installations",mR="installations-internal",pR=t=>{const e=t.getProvider("app").getImmediate(),n=fR(e),s=fi(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},gR=t=>{const e=t.getProvider("app").getImmediate(),n=fi(e,fN).getImmediate();return{getId:()=>uR(n),getToken:r=>dR(n,r)}};function xR(){rs(new Vn(fN,pR,"PUBLIC")),rs(new Vn(mR,gR,"PRIVATE"))}xR();Nn(Y1,sg);Nn(Y1,sg,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du="analytics",yR="firebase_id",vR="origin",wR=60*1e3,bR="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ag="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt=new id("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},fn=new hi("analytics","Analytics",_R);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(t){if(!t.startsWith(ag)){const e=fn.create("invalid-gtag-resource",{gtagURL:t});return Gt.warn(e.message),""}return t}function mN(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function ER(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function IR(t,e){const n=ER("firebase-js-sdk-policy",{createScriptURL:NR}),s=document.createElement("script"),r=`${ag}?l=${t}&id=${e}`;s.src=n?n==null?void 0:n.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function TR(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function SR(t,e,n,s,r,i){const a=s[r];try{if(a)await e[a];else{const u=(await mN(n)).find(d=>d.measurementId===r);u&&await e[u.appId]}}catch(c){Gt.error(c)}t("config",r,i)}async function kR(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let a=r.send_to;Array.isArray(a)||(a=[a]);const c=await mN(n);for(const u of a){const d=c.find(m=>m.measurementId===u),f=d&&e[d.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){Gt.error(i)}}function CR(t,e,n,s){async function r(i,...a){try{if(i==="event"){const[c,u]=a;await kR(t,e,n,c,u)}else if(i==="config"){const[c,u]=a;await SR(t,e,n,s,c,u)}else if(i==="consent"){const[c,u]=a;t("consent",c,u)}else if(i==="get"){const[c,u,d]=a;t("get",c,u,d)}else if(i==="set"){const[c]=a;t("set",c)}else t(i,...a)}catch(c){Gt.error(c)}}return r}function AR(t,e,n,s,r){let i=function(...a){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=CR(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function jR(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ag)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR=30,PR=1e3;class DR{constructor(e={},n=PR){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const pN=new DR;function MR(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function OR(t){var a;const{appId:e,apiKey:n}=t,s={method:"GET",headers:MR(n)},r=bR.replace("{app-id}",e),i=await fetch(r,s);if(i.status!==200&&i.status!==304){let c="";try{const u=await i.json();(a=u.error)!=null&&a.message&&(c=u.error.message)}catch{}throw fn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:c})}return i.json()}async function VR(t,e=pN,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw fn.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw fn.create("no-api-key")}const a=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new UR;return setTimeout(async()=>{c.abort()},wR),gN({appId:s,apiKey:r,measurementId:i},a,c,e)}async function gN(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=pN){var c;const{appId:i,measurementId:a}=t;try{await LR(s,e)}catch(u){if(a)return Gt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:i,measurementId:a};throw u}try{const u=await OR(t);return r.deleteThrottleMetadata(i),u}catch(u){const d=u;if(!FR(d)){if(r.deleteThrottleMetadata(i),a)return Gt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:a};throw u}const f=Number((c=d==null?void 0:d.customData)==null?void 0:c.httpStatus)===503?jx(n,r.intervalMillis,RR):jx(n,r.intervalMillis),m={throttleEndTimeMillis:Date.now()+f,backoffCount:n+1};return r.setThrottleMetadata(i,m),Gt.debug(`Calling attemptFetch again in ${f} millis`),gN(t,m,s,r)}}function LR(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(fn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function FR(t){if(!(t instanceof Fn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class UR{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function $R(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,a={...s,send_to:i};t("event",n,a)}}async function zR(t,e,n,s){if(s&&s.global){const r={};for(const i of Object.keys(n))r[`user_properties.${i}`]=n[i];return t("set",r),Promise.resolve()}else{const r=await e;t("config",r,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BR(){if(u_())try{await d_()}catch(t){return Gt.warn(fn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Gt.warn(fn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function qR(t,e,n,s,r,i,a){const c=VR(t);c.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&Gt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>Gt.error(p)),e.push(c);const u=BR().then(p=>{if(p)return s.getId()}),[d,f]=await Promise.all([c,u]);jR(i)||IR(i,d.measurementId),r("js",new Date);const m=(a==null?void 0:a.config)??{};return m[vR]="firebase",m.update=!0,f!=null&&(m[yR]=f),r("config",d.measurementId,m),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e){this.app=e}_delete(){return delete eo[this.app.options.appId],Promise.resolve()}}let eo={},Uy=[];const $y={};let Mh="dataLayer",GR="gtag",zy,lg,By=!1;function WR(){const t=[];if(c_()&&t.push("This is a browser extension environment."),tk()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=fn.create("invalid-analytics-context",{errorInfo:e});Gt.warn(n.message)}}function KR(t,e,n){WR();const s=t.options.appId;if(!s)throw fn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Gt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw fn.create("no-api-key");if(eo[s]!=null)throw fn.create("already-exists",{id:s});if(!By){TR(Mh);const{wrappedGtag:i,gtagCore:a}=AR(eo,Uy,$y,Mh,GR);lg=i,zy=a,By=!0}return eo[s]=qR(t,Uy,$y,e,zy,Mh,n),new HR(t)}function QR(t=fp()){t=Ze(t);const e=fi(t,Du);return e.isInitialized()?e.getImmediate():YR(t)}function YR(t,e={}){const n=fi(t,Du);if(n.isInitialized()){const r=n.getImmediate();if(ss(e,n.getOptions()))return r;throw fn.create("already-initialized")}return n.initialize({options:e})}function XR(t,e,n){t=Ze(t),zR(lg,eo[t.app.options.appId],e,n).catch(s=>Gt.error(s))}function JR(t,e,n,s){t=Ze(t),$R(lg,eo[t.app.options.appId],e,n,s).catch(r=>Gt.error(r))}const qy="@firebase/analytics",Hy="0.10.19";function ZR(){rs(new Vn(Du,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return KR(s,r,n)},"PUBLIC")),rs(new Vn("analytics-internal",t,"PRIVATE")),Nn(qy,Hy),Nn(qy,Hy,"esm2020");function t(e){try{const n=e.getProvider(Du).getImmediate();return{logEvent:(s,r,i)=>JR(n,s,r,i),setUserProperties:(s,r)=>XR(n,s,r)}}catch(n){throw fn.create("interop-component-reg-failed",{reason:n})}}}ZR();function xN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const e5=xN,yN=new hi("auth","Firebase",xN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=new id("@firebase/auth");function t5(t,...e){Mu.logLevel<=ke.WARN&&Mu.warn(`Auth (${Po}): ${t}`,...e)}function Uc(t,...e){Mu.logLevel<=ke.ERROR&&Mu.error(`Auth (${Po}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(t,...e){throw ug(t,...e)}function Mn(t,...e){return ug(t,...e)}function cg(t,e,n){const s={...e5(),[e]:n};return new hi("auth","Firebase",s).create(e,{appName:t.name})}function ur(t){return cg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function n5(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&as(t,"argument-error"),cg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ug(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return yN.create(t,...e)}function ge(t,e,...n){if(!t)throw ug(e,...n)}function ps(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Uc(e),new Error(e)}function Ss(t,e){t||ps(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function s5(){return Gy()==="http:"||Gy()==="https:"}function Gy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s5()||c_()||"connection"in navigator)?navigator.onLine:!0}function i5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ss(n>e,"Short delay should be less than long delay!"),this.isMobile=QS()||JS()}get(){return r5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(t,e){Ss(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ps("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ps("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ps("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],l5=new kl(3e4,6e4);function Ad(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function $o(t,e,n,s,r={}){return wN(t,r,async()=>{let i={},a={};s&&(e==="GET"?a=s:i={body:JSON.stringify(s)});const c=vl({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return XS()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ro(t.emulatorConfig.host)&&(d.credentials="include"),vN.fetch()(await _N(t,t.config.apiHost,n,c),d)})}async function wN(t,e,n){t._canInitEmulator=!1;const s={...o5,...e};try{const r=new c5(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw yc(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw yc(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw yc(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw yc(t,"user-disabled",a);const f=s[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw cg(t,f,d);as(t,f)}}catch(r){if(r instanceof Fn)throw r;as(t,"network-request-failed",{message:String(r)})}}async function bN(t,e,n,s,r={}){const i=await $o(t,e,n,s,r);return"mfaPendingCredential"in i&&as(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function _N(t,e,n,s){const r=`${e}${n}?${s}`,i=t,a=i.config.emulator?dg(t.config,r):`${t.config.apiScheme}://${r}`;return a5.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class c5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Mn(this.auth,"network-request-failed")),l5.get())})}}function yc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Mn(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(t,e){return $o(t,"POST","/v1/accounts:delete",e)}async function Ou(t,e){return $o(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d5(t,e=!1){const n=Ze(t),s=await n.getIdToken(e),r=hg(s);ge(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Da(Oh(r.auth_time)),issuedAtTime:Da(Oh(r.iat)),expirationTime:Da(Oh(r.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Oh(t){return Number(t)*1e3}function hg(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Uc("JWT malformed, contained fewer than 3 sections"),null;try{const r=s_(n);return r?JSON.parse(r):(Uc("Failed to decode base64 JWT payload"),null)}catch(r){return Uc("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Wy(t){const e=hg(t);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ul(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Fn&&h5(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function h5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Da(this.lastLoginAt),this.creationTime=Da(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vu(t){var m;const e=t.auth,n=await t.getIdToken(),s=await ul(t,Ou(e,{idToken:n}));ge(s==null?void 0:s.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const i=(m=r.providerUserInfo)!=null&&m.length?NN(r.providerUserInfo):[],a=p5(t.providerData,i),c=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new hm(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function m5(t){const e=Ze(t);await Vu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p5(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function NN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g5(t,e){const n=await wN(t,{},async()=>{const s=vl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,a=await _N(t,r,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:s};return t.emulatorConfig&&Ro(t.emulatorConfig.host)&&(u.credentials="include"),vN.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function x5(t,e){return $o(t,"POST","/v2/accounts:revokeToken",Ad(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ge(e.length!==0,"internal-error");const n=Wy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await g5(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,a=new to;return s&&(ge(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),r&&(ge(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),i&&(ge(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new to,this.toJSON())}_performRefresh(){return ps("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(t,e){ge(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Rn{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new f5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new hm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await ul(this,this.stsTokenManager.getToken(this.auth,e));return ge(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return d5(this,e)}reload(){return m5(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Rn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Vu(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(ur(this.auth));const e=await this.getIdToken();return await ul(this,u5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,i=n.phoneNumber??void 0,a=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:y,providerData:T,stsTokenManager:C}=n;ge(m&&C,e,"internal-error");const P=to.fromJSON(this.name,C);ge(typeof m=="string",e,"internal-error"),Ls(s,e.name),Ls(r,e.name),ge(typeof p=="boolean",e,"internal-error"),ge(typeof y=="boolean",e,"internal-error"),Ls(i,e.name),Ls(a,e.name),Ls(c,e.name),Ls(u,e.name),Ls(d,e.name),Ls(f,e.name);const b=new Rn({uid:m,auth:e,email:r,emailVerified:p,displayName:s,isAnonymous:y,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:d,lastLoginAt:f});return T&&Array.isArray(T)&&(b.providerData=T.map(E=>({...E}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,n,s=!1){const r=new to;r.updateFromServerResponse(n);const i=new Rn({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Vu(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];ge(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?NN(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),c=new to;c.updateFromIdToken(s);const u=new Rn({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new hm(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=new Map;function gs(t){Ss(t instanceof Function,"Expected a class definition");let e=Ky.get(t);return e?(Ss(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ky.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}EN.type="NONE";const Qy=EN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t,e,n){return`firebase:${t}:${e}:${n}`}class no{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=$c(this.userKey,r.apiKey,i),this.fullPersistenceKey=$c("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ou(this.auth,{idToken:e}).catch(()=>{});return n?Rn._fromGetAccountInfoResponse(this.auth,n,e):null}return Rn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new no(gs(Qy),e,s);const r=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=r[0]||gs(Qy);const a=$c(s,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(a);if(f){let m;if(typeof f=="string"){const p=await Ou(e,{idToken:f}).catch(()=>{});if(!p)break;m=await Rn._fromGetAccountInfoResponse(e,p,f)}else m=Rn._fromJSON(e,f);d!==i&&(c=m),i=d;break}}catch{}const u=r.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new no(i,e,s):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new no(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(AN(e))return"Blackberry";if(jN(e))return"Webos";if(TN(e))return"Safari";if((e.includes("chrome/")||SN(e))&&!e.includes("edge/"))return"Chrome";if(CN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function IN(t=Ut()){return/firefox\//i.test(t)}function TN(t=Ut()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SN(t=Ut()){return/crios\//i.test(t)}function kN(t=Ut()){return/iemobile/i.test(t)}function CN(t=Ut()){return/android/i.test(t)}function AN(t=Ut()){return/blackberry/i.test(t)}function jN(t=Ut()){return/webos/i.test(t)}function fg(t=Ut()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function y5(t=Ut()){var e;return fg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function v5(){return ZS()&&document.documentMode===10}function RN(t=Ut()){return fg(t)||CN(t)||jN(t)||AN(t)||/windows phone/i.test(t)||kN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(t,e=[]){let n;switch(t){case"Browser":n=Yy(Ut());break;case"Worker":n=`${Yy(Ut())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Po}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b5(t,e={}){return $o(t,"GET","/v2/passwordPolicy",Ad(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=6;class N5{constructor(e){var s;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??_5,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xy(this),this.idTokenSubscription=new Xy(this),this.beforeStateQueue=new w5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=gs(n)),this._initializationPromise=this.queue(async()=>{var s,r,i;if(!this._deleted&&(this.persistenceManager=await no.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ou(this,{idToken:e}),s=await Rn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(vn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(s=u.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Vu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=i5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(ur(this));const n=e?Ze(e):null;return n&&ge(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vn(this.app)?Promise.reject(ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await b5(this),n=new N5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hi("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await x5(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&gs(e)||this._popupRedirectResolver;ge(n,this,"argument-error"),this.redirectPersistenceManager=await no.create(this,[gs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,s,r);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var n;if(vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&t5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Cl(t){return Ze(t)}class Xy{constructor(e){this.auth=e,this.observer=null,this.addObserver=ok(n=>this.observer=n)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function I5(t){mg=t}function T5(t){return mg.loadJS(t)}function S5(){return mg.gapiScript}function k5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C5(t,e){const n=fi(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(ss(i,e??{}))return r;as(r,"already-initialized")}return n.initialize({options:e})}function A5(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(gs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function j5(t,e,n){const s=Cl(t);ge(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=DN(e),{host:a,port:c}=R5(e),u=c===null?"":`:${c}`,d={url:`${i}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){ge(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ge(ss(d,s.config.emulator)&&ss(f,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=d,s.emulatorConfig=f,s.settings.appVerificationDisabledForTesting=!0,Ro(a)?(a_(`${i}//${a}${u}`),l_("Auth",!0)):P5()}function DN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function R5(t){const e=DN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:Jy(s.substr(i.length+1))}}else{const[i,a]=s.split(":");return{host:i,port:Jy(a)}}}function Jy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function P5(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ps("not implemented")}_getIdTokenResponse(e){return ps("not implemented")}_linkToIdToken(e,n){return ps("not implemented")}_getReauthenticationResolver(e){return ps("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function so(t,e){return bN(t,"POST","/v1/accounts:signInWithIdp",Ad(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5="http://localhost";class ai extends MN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):as("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=n;if(!s||!r)return null;const a=new ai(s,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return so(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,so(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,so(e,n)}buildRequest(){const e={requestUri:D5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=vl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al extends pg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends Al{constructor(){super("facebook.com")}static credential(e){return ai._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hs.credential(e.oauthAccessToken)}catch{return null}}}Hs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Al{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ai._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return hs.credential(n,s)}catch{return null}}}hs.GOOGLE_SIGN_IN_METHOD="google.com";hs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs extends Al{constructor(){super("github.com")}static credential(e){return ai._fromParams({providerId:Gs.PROVIDER_ID,signInMethod:Gs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gs.credentialFromTaggedObject(e)}static credentialFromError(e){return Gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gs.credential(e.oauthAccessToken)}catch{return null}}}Gs.GITHUB_SIGN_IN_METHOD="github.com";Gs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends Al{constructor(){super("twitter.com")}static credential(e,n){return ai._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Ws.credential(n,s)}catch{return null}}}Ws.TWITTER_SIGN_IN_METHOD="twitter.com";Ws.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M5(t,e){return bN(t,"POST","/v1/accounts:signUp",Ad(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await Rn._fromIdTokenResponse(e,s,r),a=Zy(s);return new _r({user:i,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=Zy(s);return new _r({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function Zy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O5(t){var r;if(vn(t.app))return Promise.reject(ur(t));const e=Cl(t);if(await e._initializationPromise,(r=e.currentUser)!=null&&r.isAnonymous)return new _r({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await M5(e,{returnSecureToken:!0}),s=await _r._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu extends Fn{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Lu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Lu(e,n,s,r)}}function ON(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Lu._fromErrorAndOperation(t,i,e,s):i})}async function V5(t,e,n=!1){const s=await ul(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _r._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L5(t,e,n=!1){const{auth:s}=t;if(vn(s.app))return Promise.reject(ur(s));const r="reauthenticate";try{const i=await ul(t,ON(s,r,e,t),n);ge(i.idToken,s,"internal-error");const a=hg(i.idToken);ge(a,s,"internal-error");const{sub:c}=a;return ge(t.uid===c,s,"user-mismatch"),_r._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&as(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F5(t,e,n=!1){if(vn(t.app))return Promise.reject(ur(t));const s="signIn",r=await ON(t,s,e),i=await _r._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}function U5(t,e,n,s){return Ze(t).onIdTokenChanged(e,n,s)}function $5(t,e,n){return Ze(t).beforeAuthStateChanged(e,n)}function z5(t,e,n,s){return Ze(t).onAuthStateChanged(e,n,s)}function B5(t){return Ze(t).signOut()}const Fu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Fu,"1"),this.storage.removeItem(Fu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5=1e3,H5=10;class LN extends VN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=RN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},i=this.storage.getItem(s);v5()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,H5):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},q5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}LN.type="LOCAL";const G5=LN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN extends VN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}FN.type="SESSION";const UN=FN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new jd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,a=this.handlersMap[r];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const c=Array.from(a).map(async d=>d(n.origin,i)),u=await W5(c);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=gg("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},s);a={messageChannel:r,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(p.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return window}function Q5(t){ns().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $N(){return typeof ns().WorkerGlobalScope<"u"&&typeof ns().importScripts=="function"}async function Y5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function X5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function J5(){return $N()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="firebaseLocalStorageDb",Z5=1,Uu="firebaseLocalStorage",BN="fbase_key";class jl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Rd(t,e){return t.transaction([Uu],e?"readwrite":"readonly").objectStore(Uu)}function eP(){const t=indexedDB.deleteDatabase(zN);return new jl(t).toPromise()}function fm(){const t=indexedDB.open(zN,Z5);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Uu,{keyPath:BN})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Uu)?e(s):(s.close(),await eP(),e(await fm()))})})}async function ev(t,e,n){const s=Rd(t,!0).put({[BN]:e,value:n});return new jl(s).toPromise()}async function tP(t,e){const n=Rd(t,!1).get(e),s=await new jl(n).toPromise();return s===void 0?null:s.value}function tv(t,e){const n=Rd(t,!0).delete(e);return new jl(n).toPromise()}const nP=800,sP=3;class qN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>sP)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $N()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jd._getInstance(J5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,s;if(this.activeServiceWorker=await Y5(),!this.activeServiceWorker)return;this.sender=new K5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||X5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fm();return await ev(e,Fu,"1"),await tv(e,Fu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>ev(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>tP(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Rd(r,!1).getAll();return new jl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qN.type="LOCAL";const rP=qN;new kl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(t,e){return e?gs(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg extends MN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return so(e,this._buildIdpRequest())}_linkToIdToken(e,n){return so(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return so(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function iP(t){return F5(t.auth,new xg(t),t.bypassAuthState)}function oP(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),L5(n,new xg(t),t.bypassAuthState)}async function aP(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),V5(n,new xg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iP;case"linkViaPopup":case"linkViaRedirect":return aP;case"reauthViaPopup":case"reauthViaRedirect":return oP;default:as(this.auth,"internal-error")}}resolve(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=new kl(2e3,1e4);async function cP(t,e,n){if(vn(t.app))return Promise.reject(Mn(t,"operation-not-supported-in-this-environment"));const s=Cl(t);n5(t,e,pg);const r=HN(s,n);return new qr(s,"signInViaPopup",e,r).executeNotNull()}class qr extends GN{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,qr.currentPopupAction&&qr.currentPopupAction.cancel(),qr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ge(e,this.auth,"internal-error"),e}async onExecution(){Ss(this.filter.length===1,"Popup operations only handle one event");const e=gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if((s=(n=this.authWindow)==null?void 0:n.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lP.get())};e()}}qr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP="pendingRedirect",zc=new Map;class dP extends GN{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=zc.get(this.auth._key());if(!e){try{const s=await hP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}zc.set(this.auth._key(),e)}return this.bypassAuthState||zc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hP(t,e){const n=pP(e),s=mP(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function fP(t,e){zc.set(t._key(),e)}function mP(t){return gs(t._redirectPersistence)}function pP(t){return $c(uP,t.config.apiKey,t.name)}async function gP(t,e,n=!1){if(vn(t.app))return Promise.reject(ur(t));const s=Cl(t),r=HN(s,e),a=await new dP(s,r,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=10*60*1e3;class yP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!WN(e)){const r=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";n.onError(Mn(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xP&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WN({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WN(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(t,e={}){return $o(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_P=/^https?/;async function NP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wP(t);for(const n of e)try{if(EP(n))return}catch{}as(t,"unauthorized-domain")}function EP(t){const e=dm(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!_P.test(n))return!1;if(bP.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=new kl(3e4,6e4);function sv(){const t=ns().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function TP(t){return new Promise((e,n)=>{var r,i,a;function s(){sv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sv(),n(Mn(t,"network-request-failed"))},timeout:IP.get()})}if((i=(r=ns().gapi)==null?void 0:r.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=ns().gapi)!=null&&a.load)s();else{const c=k5("iframefcb");return ns()[c]=()=>{gapi.load?s():n(Mn(t,"network-request-failed"))},T5(`${S5()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Bc=null,e})}let Bc=null;function SP(t){return Bc=Bc||TP(t),Bc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP=new kl(5e3,15e3),CP="__/auth/iframe",AP="emulator/auth/iframe",jP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function PP(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?dg(e,AP):`https://${t.config.authDomain}/${CP}`,s={apiKey:e.apiKey,appName:t.name,v:Po},r=RP.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${vl(s).slice(1)}`}async function DP(t){const e=await SP(t),n=ns().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:PP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jP,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const a=Mn(t,"network-request-failed"),c=ns().setTimeout(()=>{i(a)},kP.get());function u(){ns().clearTimeout(c),r(s)}s.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OP=500,VP=600,LP="_blank",FP="http://localhost";class rv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UP(t,e,n,s=OP,r=VP){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let c="";const u={...MP,width:s.toString(),height:r.toString(),top:i,left:a},d=Ut().toLowerCase();n&&(c=SN(d)?LP:n),IN(d)&&(e=e||FP,u.scrollbars="yes");const f=Object.entries(u).reduce((p,[y,T])=>`${p}${y}=${T},`,"");if(y5(d)&&c!=="_self")return $P(e||"",c),new rv(null);const m=window.open(e||"",c,f);ge(m,t,"popup-blocked");try{m.focus()}catch{}return new rv(m)}function $P(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP="__/auth/handler",BP="emulator/auth/handler",qP=encodeURIComponent("fac");async function iv(t,e,n,s,r,i){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Po,eventId:r};if(e instanceof pg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",ik(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof Al){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${qP}=${encodeURIComponent(u)}`:"";return`${HP(t)}?${vl(c).slice(1)}${d}`}function HP({config:t}){return t.emulator?dg(t,BP):`https://${t.authDomain}/${zP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh="webStorageSupport";class GP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UN,this._completeRedirectFn=gP,this._overrideRedirectResult=fP}async _openPopup(e,n,s,r){var a;Ss((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await iv(e,n,s,dm(),r);return UP(e,i,gg())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await iv(e,n,s,dm(),r);return Q5(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Ss(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await DP(e),s=new yP(e);return n.register("authEvent",r=>(ge(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Vh,{type:Vh},r=>{var a;const i=(a=r==null?void 0:r[0])==null?void 0:a[Vh];i!==void 0&&n(!!i),as(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=NP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return RN()||TN()||fg()}}const WP=GP;var ov="@firebase/auth",av="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YP(t){rs(new Vn("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=s.options;ge(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PN(t)},d=new E5(s,r,i,u);return A5(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),rs(new Vn("auth-internal",e=>{const n=Cl(e.getProvider("auth").getImmediate());return(s=>new KP(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nn(ov,av,QP(t)),Nn(ov,av,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=5*60,JP=o_("authIdTokenMaxAge")||XP;let lv=null;const ZP=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>JP)return;const r=n==null?void 0:n.token;lv!==r&&(lv=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function e3(t=fp()){const e=fi(t,"auth");if(e.isInitialized())return e.getImmediate();const n=C5(t,{popupRedirectResolver:WP,persistence:[rP,G5,UN]}),s=o_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const a=ZP(i.toString());$5(n,a,()=>a(n.currentUser)),U5(n,c=>a(c))}}const r=r_("auth");return r&&j5(n,`http://${r}`),n}function t3(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}I5({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=Mn("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",t3().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YP("Browser");const n3={apiKey:"AIzaSyABtIX9_vCAlG5t9OGNpaWujr-BqMbiaZg",authDomain:"vibemap-v0.firebaseapp.com",projectId:"vibemap-v0",storageBucket:"vibemap-v0.firebasestorage.app",messagingSenderId:"708774733086",appId:"1:708774733086:web:c1a310eecf74101cd1d50f",measurementId:"G-FRGPMYGK1K"},Pd=p_(n3);QR(Pd);const Ye=e3(Pd),s3=new hs,le=p4(Pd);console.log(" Firebase initialized:",Pd.name);var cv;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(cv||(cv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uv;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(uv||(uv={}));var dv;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(dv||(dv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv=["user","model","function","system"];var fv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(fv||(fv={}));var mv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(mv||(mv={}));var pv;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(pv||(pv={}));var gv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(gv||(gv={}));var Ma;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.OTHER="OTHER"})(Ma||(Ma={}));var xv;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(xv||(xv={}));var yv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(yv||(yv={}));var vv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(vv||(vv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Ii extends Lt{constructor(e,n){super(e),this.response=n}}class KN extends Lt{constructor(e,n,s,r){super(e),this.status=n,this.statusText=s,this.errorDetails=r}}class dr extends Lt{}class QN extends Lt{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3="https://generativelanguage.googleapis.com",i3="v1beta",o3="0.24.1",a3="genai-js";var li;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(li||(li={}));class l3{constructor(e,n,s,r,i){this.model=e,this.task=n,this.apiKey=s,this.stream=r,this.requestOptions=i}toString(){var e,n;const s=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||i3;let i=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||r3}/${s}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}function c3(t){const e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${a3}/${o3}`),e.join(" ")}async function u3(t){var e;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",c3(t.requestOptions)),n.append("x-goog-api-key",t.apiKey);let s=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(s){if(!(s instanceof Headers))try{s=new Headers(s)}catch(r){throw new dr(`unable to convert customHeaders value ${JSON.stringify(s)} to Headers: ${r.message}`)}for(const[r,i]of s.entries()){if(r==="x-goog-api-key")throw new dr(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new dr(`Header name ${r} can only be set using the apiClient field`);n.append(r,i)}}return n}async function d3(t,e,n,s,r,i){const a=new l3(t,e,n,s,i);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},p3(i)),{method:"POST",headers:await u3(a),body:r})}}async function Rl(t,e,n,s,r,i={},a=fetch){const{url:c,fetchOptions:u}=await d3(t,e,n,s,r,i);return h3(c,u,a)}async function h3(t,e,n=fetch){let s;try{s=await n(t,e)}catch(r){f3(r,t)}return s.ok||await m3(s,t),s}function f3(t,e){let n=t;throw n.name==="AbortError"?(n=new QN(`Request aborted when fetching ${e.toString()}: ${t.message}`),n.stack=t.stack):t instanceof KN||t instanceof dr||(n=new Lt(`Error fetching from ${e.toString()}: ${t.message}`),n.stack=t.stack),n}async function m3(t,e){let n="",s;try{const r=await t.json();n=r.error.message,r.error.details&&(n+=` ${JSON.stringify(r.error.details)}`,s=r.error.details)}catch{}throw new KN(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${n}`,t.status,t.statusText,s)}function p3(t){const e={};if((t==null?void 0:t.signal)!==void 0||(t==null?void 0:t.timeout)>=0){const n=new AbortController;(t==null?void 0:t.timeout)>=0&&setTimeout(()=>n.abort(),t.timeout),t!=null&&t.signal&&t.signal.addEventListener("abort",()=>{n.abort()}),e.signal=n.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),qc(t.candidates[0]))throw new Ii(`${zs(t)}`,t);return g3(t)}else if(t.promptFeedback)throw new Ii(`Text not available. ${zs(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),qc(t.candidates[0]))throw new Ii(`${zs(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),wv(t)[0]}else if(t.promptFeedback)throw new Ii(`Function call not available. ${zs(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),qc(t.candidates[0]))throw new Ii(`${zs(t)}`,t);return wv(t)}else if(t.promptFeedback)throw new Ii(`Function call not available. ${zs(t)}`,t)},t}function g3(t){var e,n,s,r;const i=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const a of(r=(s=t.candidates)===null||s===void 0?void 0:s[0].content)===null||r===void 0?void 0:r.parts)a.text&&i.push(a.text),a.executableCode&&i.push("\n```"+a.executableCode.language+`
`+a.executableCode.code+"\n```\n"),a.codeExecutionResult&&i.push("\n```\n"+a.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}function wv(t){var e,n,s,r;const i=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const a of(r=(s=t.candidates)===null||s===void 0?void 0:s[0].content)===null||r===void 0?void 0:r.parts)a.functionCall&&i.push(a.functionCall);if(i.length>0)return i}const x3=[Ma.RECITATION,Ma.SAFETY,Ma.LANGUAGE];function qc(t){return!!t.finishReason&&x3.includes(t.finishReason)}function zs(t){var e,n,s;let r="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)r+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(r+=` due to ${t.promptFeedback.blockReason}`),!((n=t.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(r+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((s=t.candidates)===null||s===void 0)&&s[0]){const i=t.candidates[0];qc(i)&&(r+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(r+=`: ${i.finishMessage}`))}return r}function dl(t){return this instanceof dl?(this.v=t,this):new dl(t)}function y3(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),r,i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(p){s[p]&&(r[p]=function(y){return new Promise(function(T,C){i.push([p,y,T,C])>1||c(p,y)})})}function c(p,y){try{u(s[p](y))}catch(T){m(i[0][3],T)}}function u(p){p.value instanceof dl?Promise.resolve(p.value.v).then(d,f):m(i[0][2],p)}function d(p){c("next",p)}function f(p){c("throw",p)}function m(p,y){p(y),i.shift(),i.length&&c(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function v3(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=_3(e),[s,r]=n.tee();return{stream:b3(s),response:w3(r)}}async function w3(t){const e=[],n=t.getReader();for(;;){const{done:s,value:r}=await n.read();if(s)return yg(N3(e));e.push(r)}}function b3(t){return y3(this,arguments,function*(){const n=t.getReader();for(;;){const{value:s,done:r}=yield dl(n.read());if(r)break;yield yield dl(yg(s))}})}function _3(t){const e=t.getReader();return new ReadableStream({start(s){let r="";return i();function i(){return e.read().then(({value:a,done:c})=>{if(c){if(r.trim()){s.error(new Lt("Failed to parse stream"));return}s.close();return}r+=a;let u=r.match(bv),d;for(;u;){try{d=JSON.parse(u[1])}catch{s.error(new Lt(`Error parsing JSON response: "${u[1]}"`));return}s.enqueue(d),r=r.substring(u[0].length),u=r.match(bv)}return i()}).catch(a=>{let c=a;throw c.stack=a.stack,c.name==="AbortError"?c=new QN("Request aborted when reading from the stream"):c=new Lt("Error reading from the stream"),c})}}})}function N3(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const s of t){if(s.candidates){let r=0;for(const i of s.candidates)if(n.candidates||(n.candidates=[]),n.candidates[r]||(n.candidates[r]={index:r}),n.candidates[r].citationMetadata=i.citationMetadata,n.candidates[r].groundingMetadata=i.groundingMetadata,n.candidates[r].finishReason=i.finishReason,n.candidates[r].finishMessage=i.finishMessage,n.candidates[r].safetyRatings=i.safetyRatings,i.content&&i.content.parts){n.candidates[r].content||(n.candidates[r].content={role:i.content.role||"user",parts:[]});const a={};for(const c of i.content.parts)c.text&&(a.text=c.text),c.functionCall&&(a.functionCall=c.functionCall),c.executableCode&&(a.executableCode=c.executableCode),c.codeExecutionResult&&(a.codeExecutionResult=c.codeExecutionResult),Object.keys(a).length===0&&(a.text=""),n.candidates[r].content.parts.push(a)}r++}s.usageMetadata&&(n.usageMetadata=s.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t,e,n,s){const r=await Rl(e,li.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),s);return v3(r)}async function XN(t,e,n,s){const i=await(await Rl(e,li.GENERATE_CONTENT,t,!1,JSON.stringify(n),s)).json();return{response:yg(i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function hl(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return E3(e)}function E3(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let s=!1,r=!1;for(const i of t)"functionResponse"in i?(n.parts.push(i),r=!0):(e.parts.push(i),s=!0);if(s&&r)throw new Lt("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!r)throw new Lt("No content is provided for sending chat message.");return s?e:n}function I3(t,e){var n;let s={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(n=e==null?void 0:e.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const r=t.generateContentRequest!=null;if(t.contents){if(r)throw new dr("CountTokensRequest must have one of contents or generateContentRequest, not both.");s.contents=t.contents}else if(r)s=Object.assign(Object.assign({},s),t.generateContentRequest);else{const i=hl(t);s.contents=[i]}return{generateContentRequest:s}}function _v(t){let e;return t.contents?e=t:e={contents:[hl(t)]},t.systemInstruction&&(e.systemInstruction=JN(t.systemInstruction)),e}function T3(t){return typeof t=="string"||Array.isArray(t)?{content:hl(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],S3={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function k3(t){let e=!1;for(const n of t){const{role:s,parts:r}=n;if(!e&&s!=="user")throw new Lt(`First content should be with role 'user', got ${s}`);if(!hv.includes(s))throw new Lt(`Each item should include role field. Got ${s} but valid roles are: ${JSON.stringify(hv)}`);if(!Array.isArray(r))throw new Lt("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new Lt("Each Content should have at least one part");const i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of r)for(const u of Nv)u in c&&(i[u]+=1);const a=S3[s];for(const c of Nv)if(!a.includes(c)&&i[c]>0)throw new Lt(`Content with role '${s}' can't contain '${c}' part`);e=!0}}function Ev(t){var e;if(t.candidates===void 0||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const s of n.parts)if(s===void 0||Object.keys(s).length===0||s.text!==void 0&&s.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="SILENT_ERROR";class C3{constructor(e,n,s,r={}){this.model=n,this.params=s,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,s!=null&&s.history&&(k3(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,n={}){var s,r,i,a,c,u;await this._sendPromise;const d=hl(e),f={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),n);let p;return this._sendPromise=this._sendPromise.then(()=>XN(this._apiKey,this.model,f,m)).then(y=>{var T;if(Ev(y.response)){this._history.push(d);const C=Object.assign({parts:[],role:"model"},(T=y.response.candidates)===null||T===void 0?void 0:T[0].content);this._history.push(C)}else{const C=zs(y.response);C&&console.warn(`sendMessage() was unsuccessful. ${C}. Inspect response object for details.`)}p=y}).catch(y=>{throw this._sendPromise=Promise.resolve(),y}),await this._sendPromise,p}async sendMessageStream(e,n={}){var s,r,i,a,c,u;await this._sendPromise;const d=hl(e),f={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),n),p=YN(this._apiKey,this.model,f,m);return this._sendPromise=this._sendPromise.then(()=>p).catch(y=>{throw new Error(Iv)}).then(y=>y.response).then(y=>{if(Ev(y)){this._history.push(d);const T=Object.assign({},y.candidates[0].content);T.role||(T.role="model"),this._history.push(T)}else{const T=zs(y);T&&console.warn(`sendMessageStream() was unsuccessful. ${T}. Inspect response object for details.`)}}).catch(y=>{y.message!==Iv&&console.error(y)}),p}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A3(t,e,n,s){return(await Rl(e,li.COUNT_TOKENS,t,!1,JSON.stringify(n),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j3(t,e,n,s){return(await Rl(e,li.EMBED_CONTENT,t,!1,JSON.stringify(n),s)).json()}async function R3(t,e,n,s){const r=n.requests.map(a=>Object.assign(Object.assign({},a),{model:e}));return(await Rl(e,li.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:r}),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,n,s={}){this.apiKey=e,this._requestOptions=s,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=JN(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(e,n={}){var s;const r=_v(e),i=Object.assign(Object.assign({},this._requestOptions),n);return XN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},r),i)}async generateContentStream(e,n={}){var s;const r=_v(e),i=Object.assign(Object.assign({},this._requestOptions),n);return YN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},r),i)}startChat(e){var n;return new C3(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},e),this._requestOptions)}async countTokens(e,n={}){const s=I3(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),n);return A3(this.apiKey,this.model,s,r)}async embedContent(e,n={}){const s=T3(e),r=Object.assign(Object.assign({},this._requestOptions),n);return j3(this.apiKey,this.model,s,r)}async batchEmbedContents(e,n={}){const s=Object.assign(Object.assign({},this._requestOptions),n);return R3(this.apiKey,this.model,e,s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e){this.apiKey=e}getGenerativeModel(e,n){if(!e.model)throw new Lt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Tv(this.apiKey,e,n)}getGenerativeModelFromCachedContent(e,n,s){if(!e.name)throw new dr("Cached content must contain a `name` field.");if(!e.model)throw new dr("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const a of r)if(n!=null&&n[a]&&e[a]&&(n==null?void 0:n[a])!==e[a]){if(a==="model"){const c=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,u=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===u)continue}throw new dr(`Different value for "${a}" specified in modelParams (${n[a]}) and cachedContent (${e[a]})`)}const i=Object.assign(Object.assign({},n),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Tv(this.apiKey,i,s)}}const P3="AIzaSyAipvqizajDpEGU8VSDlseBmtrDKppRNl0",D3=new ZN(P3),M3=async t=>{try{if(!t.trim())return{flagged:!1,reason:"",category:"none",confidence:0};const e=D3.getGenerativeModel({model:"gemini-pro"}),n=`
            You are a content moderator for a social app called "VibeMap".
            Analyze the following text for: Harassment, Hate Speech, Sexually Explicit content, Dangerous content, or Spam.
            
            Text: "${t}"

            Respond ONLY with a JSON object in this format:
            {
                "flagged": boolean,
                "reason": "short explanation",
                "category": "one of the categories listed above or none",
                "confidence": number (0-1)
            }
        `,i=(await(await e.generateContent(n)).response).text().replace(/```json/g,"").replace(/```/g,"").trim();try{return JSON.parse(i)}catch(a){return console.error("Failed to parse Gemini/AI response",a),{flagged:!1,reason:"AI Parse Error",category:"none",confidence:0}}}catch(e){return console.error("AI Moderation Error:",e),{flagged:!1,reason:"Service Error",category:"none",confidence:0}}},O3=async t=>{try{return await S4(He(le,"posts",t)),!0}catch(e){throw console.error("Error deleting post:",e),e}},eE=async t=>{try{const e=t.content||t.caption||t.description||"",n=await M3(e);return n.flagged&&await Ts(Pe(le,"reports"),{type:"post",targetId:"PENDING_ID",reason:`AI Auto-Flag: ${n.category}`,status:"pending",timestamp:Date.now(),reporterId:"system_ai",details:n}),{id:(await Ts(Pe(le,"posts"),{...t,likes:[],comments:[],shares:0,timestamp:cr(),aiModeration:n})).id,...t,aiModeration:n}}catch(e){throw console.error("Error creating post:",e),e}},vg=async(t,e)=>{try{const n=He(le,"posts",t);return await hn(n,e),!0}catch(n){throw console.error("Error updating post:",n),n}},un={AUTH_NOT_LOGGED_IN:"ERR_AUTH_01",AUTH_LOGIN_FAILED:"ERR_AUTH_02",AUTH_LOGOUT_FAILED:"ERR_AUTH_03",PERM_DENIED:"ERR_PERM_01",PERM_ACTION_NOT_ALLOWED:"ERR_PERM_02",DATA_MISSING_FIELDS:"ERR_DATA_01",DATA_INVALID_TYPE:"ERR_DATA_02",DATA_UPLOAD_FAILED:"ERR_DATA_03",NET_CONNECTION:"ERR_NET_01",NET_FIRESTORE_WRITE:"ERR_NET_02",NET_FIRESTORE_READ:"ERR_NET_03",NET_UNKNOWN:"ERR_NET_99"},Kn=(t,e,n=un.NET_UNKNOWN)=>{console.error(`[${n}] ${t} Failed:`,e);let s=n;(e==null?void 0:e.code)==="permission-denied"&&(s=un.PERM_DENIED),(e==null?void 0:e.code)==="unavailable"&&(s=un.NET_CONNECTION);const r=(e==null?void 0:e.message)||"An unexpected error occurred.";console.warn(`Action Failed: ${t} [${s}]: ${r}`)},V3="AIzaSyAipvqizajDpEGU8VSDlseBmtrDKppRNl0",Sv=new ZN(V3),Io=Sv?Sv.getGenerativeModel({model:"gemini-2.5-flash"},{apiVersion:"v1beta"}):null,tE=async(t,e)=>{if(!Io)return"";try{const n=`
      Identify the popular area, hub, sector, or zone name from this location details.
      Place Name: "${t}"
      Address: "${e}"

      Rules:
      1. Prioritize identifying famous hubs (e.g., "Cyber Hub", "Worldmark", "Khan Market").
      2. If inside a Tech Park or Mall, return that (e.g., "Vatika Business Centre", "Select Citywalk").
      3. If generic, fallback to "Sector X" or "Area Name" (e.g., "Sector 49", "Hauz Khas").
      4. DO NOT return specific building numbers (e.g., "Tower B", "Shop 5").
      5. Return ONLY the short name. No quotes, no explanations.
    `,i=(await(await Io.generateContent(n)).response).text().trim();return!i||i.length>30?"":i}catch(n){return console.error("Gemini Area Extraction Error:",n),""}},L3=async t=>{if(!Io)return["NeonWanderer","MidnightViber","BassDropBot"];try{console.log("Generating usernames for:",t);const e=`Generate 5 creative, quirky, and safe display names for a user on a social vibe-check app.
    The user describes their vibe as: "${t}".
    
    Themes to explore:
    - Abstract concepts related to the description
    - Fun alliterations
    - Short, punchy handles (max 15 chars)
    - Avoid generic prefixes like "Real", "The", "Soul" unless unique.
    - Mix of cool, mysterious, and energetic tones.
    
    Output ONLY a JSON array of strings, e.g. ["NeonRider", "ZenMaster", "VibeSurfer"]. Do not include markdown formatting.`,i=(await(await Io.generateContent(e)).response).text().replace(/```json/g,"").replace(/```/g,"").trim(),a=JSON.parse(i);return Array.isArray(a)?a:["NeonWanderer","MidnightViber","BassDropBot"]}catch(e){console.error("Gemini Username Error:",e);const n=t.split(",").map(s=>s.trim()).filter(s=>s.length>0);if(n.length>0){const s=n[0].replace(/\s+/g,""),r=Math.floor(Math.random()*1e3);return[`Real${s}`,`The${s}Vibe`,`${s}Soul`,`Neon${s}`,`${s}${r}`]}return["MysteryGuest","CityLight","VibeSeeker"]}},kv=async t=>{if(!Io)return{safe:!0};try{const e=`Analyze the following social media comment for vulgarity, harassment, or stalking behavior. 
    Comment: "${t}"
    Return ONLY a JSON object with: { "safe": boolean, "reason": string | null }. Do not include markdown.`,i=(await(await Io.generateContent(e)).response).text().replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(i)}catch(e){return console.error("Gemini Moderation Error:",e),{safe:!0}}},F3=({children:t,currentPage:e,onNavigate:n,onLogout:s,onDropVibe:r,isDropVibeOpen:i,setIsDropVibeOpen:a,user:c,initialLocation:u,notifications:d=[],onOpenNotifications:f,unreadMessageCount:m=0})=>{var J,H,ue,me,je,Te;const[p,y]=A.useState(""),[T,C]=A.useState(""),[P,b]=A.useState(""),[E,S]=A.useState("2"),[R,L]=A.useState(null),[U,N]=A.useState(!1),x=d.filter(ae=>!ae.read).length,[v,_]=A.useState({});A.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(ae=>{const{latitude:O,longitude:K}=ae.coords,te=window.google;te&&te.maps&&_({location:new te.maps.LatLng(O,K),radius:5e4})},ae=>console.log("Layout Geo error:",ae))},[]);const{value:k,suggestions:{status:j,data:I},setValue:ee,clearSuggestions:ne}=ho({requestOptions:v,debounce:300});A.useEffect(()=>{u&&i&&(ee(u,!1),C(u))},[u,i,ee]);const Ne=async()=>{if(!p||!k){Kn("Drop Vibe",new Error("Missing Message or Location"),un.DATA_MISSING_FIELDS);return}if(!c){Kn("Drop Vibe",new Error("You must be logged in."),un.AUTH_NOT_LOGGED_IN);return}try{let ae="";k&&P&&(ae=await tE(k,P));const O={location:{name:k,address:P||"Unknown",shortLocation:ae},visitDate:new Date().toISOString(),imageUrl:R||null,rsvps:{},comments:[],likes:[],shares:0,type:"regular",visibility:"Public"};await eE({...O,description:`[DROP: ${E}h] ${p}`,user:{id:c.id,displayName:c.displayName,handle:c.handle||"vibemap_user",avatarUrl:c.avatarUrl,isConnected:!0,isInfluencer:c.isInfluencer||!1,trustScore:c.trustScore||0}}),alert(`Vibe dropped for ${E} hours! Saved to Feed.`),a(!1),y(""),ee(""),C(""),b(""),L(null),n("feed")}catch(ae){Kn("Drop Vibe",ae,un.NET_FIRESTORE_WRITE)}},de=ae=>{var K;const O=(K=ae.target.files)==null?void 0:K[0];if(O){if(O.size>5*1024*1024){alert("File too large. Max 5MB.");return}const te=new FileReader;te.onloadend=()=>{L(te.result)},te.readAsDataURL(O)}},$=[{id:"feed",icon:Nx,label:"Feed"},{id:"hotspots",icon:el,label:"Hotspots"},{id:"chat",icon:mr,label:"Chat"},{id:"profile",icon:Sx,label:"Profile"}];return o.jsxs("div",{className:"min-h-screen bg-slate-950 text-white flex flex-col md:flex-row",children:[o.jsxs("div",{className:"hidden md:flex fixed top-0 left-64 right-0 h-16 bg-slate-950/50 backdrop-blur-md z-20 px-8 items-center justify-end gap-6 border-b border-brand-800/20",children:[o.jsxs("button",{onClick:f,className:"relative p-2 text-slate-400 hover:text-white transition-colors",children:[o.jsx(ka,{className:"w-5 h-5"}),x>0&&o.jsx("span",{className:"absolute top-1.5 right-2 w-2 h-2 bg-red-500 rounded-full border-2 border-slate-900"})]}),o.jsxs("button",{onClick:()=>n("origin-roots"),className:"group flex items-center gap-2 px-4 py-2 rounded-full border border-brand-500/30 bg-brand-500/5 hover:bg-brand-500/10 transition-all duration-300 animate-neon-pulse",children:[o.jsx(en,{className:"w-4 h-4 text-brand-400 group-hover:rotate-12 transition-transform"}),o.jsx("span",{className:"text-xs font-black uppercase tracking-[0.2em] text-shimmer",children:"Our Roots"})]}),o.jsxs("button",{onClick:s,className:`flex items-center gap-2 p-2 transition-colors ${(J=c==null?void 0:c.handle)!=null&&J.startsWith("guest_")?"text-brand-400 hover:text-brand-300":"text-slate-500 hover:text-red-400"}`,title:(H=c==null?void 0:c.handle)!=null&&H.startsWith("guest_")?"Log In":"Sign Out",children:[(ue=c==null?void 0:c.handle)!=null&&ue.startsWith("guest_")?o.jsx(Ex,{className:"w-5 h-5"}):o.jsx(Ix,{className:"w-5 h-5"}),o.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:(me=c==null?void 0:c.handle)!=null&&me.startsWith("guest_")?"Login":"Logout"})]})]}),o.jsxs("aside",{className:"hidden md:flex flex-col w-64 bg-brand-900 border-r border-brand-800 p-6 fixed h-full z-10",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-10 cursor-pointer",onClick:()=>n("feed"),children:[o.jsx(Ve,{className:"text-brand-400 w-8 h-8"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-brand-400 to-accent bg-clip-text text-transparent leading-none",children:"VibeMap"}),o.jsx("span",{className:"text-[10px] font-bold text-slate-500 tracking-[0.2em] uppercase mt-1",children:"Find Your Tribe"})]})]}),o.jsxs("nav",{className:"flex-1 space-y-4",children:[$.map(ae=>o.jsxs("button",{onClick:()=>n(ae.id),className:`relative flex items-center gap-3 w-full p-3 rounded-xl transition-all ${e===ae.id?"bg-brand-600 text-white shadow-lg shadow-brand-600/30":"text-slate-400 hover:bg-brand-800 hover:text-white"}`,children:[o.jsx(ae.icon,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:ae.label}),ae.id==="chat"&&m>0&&o.jsx("span",{className:"absolute right-3 w-3 h-3 bg-green-500 rounded-full shadow-lg shadow-green-500/50"})]},ae.id)),o.jsxs("button",{onClick:()=>n("search"),className:`flex items-center gap-3 w-full p-3 rounded-xl transition-all ${e==="search"?"bg-brand-600 text-white shadow-lg shadow-brand-600/30":"text-slate-400 hover:bg-brand-800 hover:text-white"}`,children:[o.jsx(ti,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Vibe Finder"})]})]})]}),o.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 bg-brand-900 sticky top-0 z-20 border-b border-brand-800",children:[o.jsxs("div",{className:"flex items-center gap-2",onClick:()=>n("feed"),children:[o.jsx(Ve,{className:"text-brand-400 w-6 h-6"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-bold text-xl leading-none",children:"VibeMap"}),o.jsx("span",{className:"text-[8px] font-bold text-slate-500 tracking-[0.2em] uppercase",children:"Find Your Tribe"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:f,className:"relative p-1.5 text-slate-400 hover:text-white transition-colors",children:[o.jsx(ka,{className:"w-5 h-5"}),x>0&&o.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full border border-brand-900"})]}),o.jsxs("button",{onClick:()=>n("origin-roots"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-brand-500/30 bg-brand-500/5 animate-neon-pulse",children:[o.jsx(en,{className:"w-3.5 h-3.5 text-brand-400"}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-shimmer",children:"Roots"})]}),o.jsx("button",{onClick:s,className:`p-1 transition-colors ${(je=c==null?void 0:c.handle)!=null&&je.startsWith("guest_")?"text-brand-400 hover:text-brand-300":"text-slate-500 hover:text-red-400"}`,children:(Te=c==null?void 0:c.handle)!=null&&Te.startsWith("guest_")?o.jsx(Ex,{className:"w-5 h-5"}):o.jsx(Ix,{className:"w-5 h-5"})})]})]}),o.jsx("main",{className:"flex-1 md:ml-64 p-4 md:p-8 md:pt-24 pb-24 md:pb-8 max-w-4xl mx-auto w-full relative",children:t}),o.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-brand-900 border-t border-brand-800 px-4 flex justify-between items-center z-50 h-14",children:[o.jsx("button",{onClick:()=>n("feed"),className:`flex flex-col items-center gap-1 ${e==="feed"?"text-white":"text-slate-500"}`,children:o.jsx(Nx,{className:"w-[1.6rem] h-[1.6rem]",strokeWidth:e==="feed"?2.5:2})}),o.jsx("button",{onClick:()=>n("hotspots"),className:`flex flex-col items-center gap-1 ${e==="hotspots"?"text-white":"text-slate-500"}`,children:o.jsx(el,{className:"w-[1.6rem] h-[1.6rem]",strokeWidth:e==="hotspots"?2.5:2})}),o.jsx("div",{className:"relative group pointer-events-none transform scale-90 origin-center",children:o.jsxs("div",{className:"pointer-events-auto relative",children:[o.jsx("div",{className:"absolute inset-0 bg-brand-500 blur-xl opacity-20 group-hover:opacity-40 transition-opacity rounded-full"}),o.jsxs("div",{className:"bg-gradient-to-b from-brand-600 to-brand-900 border border-brand-400/50 rounded-3xl w-40 h-12 flex items-center justify-between px-1 shadow-2xl shadow-brand-500/30 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"}),o.jsxs("button",{onClick:r,className:"z-10 flex flex-col items-center justify-center w-12 active:scale-95 transition-transform",children:[o.jsx(pr,{className:"w-5 h-5 text-white mb-0.5",strokeWidth:2.5}),o.jsx("span",{className:"text-[8px] font-bold text-brand-100 uppercase tracking-wide",children:"Drop"})]}),o.jsx("div",{className:"z-10 flex flex-col items-center justify-center",children:o.jsx("span",{className:"text-xl font-black italic text-white tracking-tighter leading-none",style:{textShadow:"0 0 10px rgba(255,255,255,0.5)"},children:"Vibe"})}),o.jsxs("button",{onClick:()=>n("search"),className:"z-10 flex flex-col items-center justify-center w-12 active:scale-95 transition-transform",children:[o.jsx(ti,{className:"w-5 h-5 text-white mb-0.5",strokeWidth:2.5}),o.jsx("span",{className:"text-[8px] font-bold text-brand-100 uppercase tracking-wide",children:"Finder"})]}),o.jsx("div",{className:"absolute top-2 bottom-2 left-[3.25rem] w-px bg-white/10"}),o.jsx("div",{className:"absolute top-2 bottom-2 right-[3.25rem] w-px bg-white/10"})]})]})}),o.jsxs("button",{onClick:()=>n("chat"),className:`relative flex flex-col items-center gap-1 ${e==="chat"?"text-white":"text-slate-500"}`,children:[o.jsx(mr,{className:"w-[1.6rem] h-[1.6rem]",strokeWidth:e==="chat"?2.5:2}),m>0&&o.jsx("span",{className:"absolute top-0 right-1 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-brand-900"})]}),o.jsx("button",{onClick:()=>n("profile"),className:`flex flex-col items-center gap-1 ${e==="profile"?"text-white":"text-slate-500"}`,children:o.jsx(Sx,{className:"w-[1.6rem] h-[1.6rem]",strokeWidth:e==="profile"?2.5:2})})]}),i&&o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-3xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center text-white",children:o.jsx(tl,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Drop a Vibe"}),o.jsx("p",{className:"text-xs text-slate-400",children:"Signal a flash event nearby."})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest px-1",children:"Message"}),o.jsx("input",{type:"text",placeholder:"e.g. Grab a beer @ Open Tap...",value:p,onChange:ae=>y(ae.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-500 mt-1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest px-1",children:"Location"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Ve,{className:"absolute left-4 top-3.5 text-brand-400 w-4 h-4 z-10"}),o.jsx("input",{type:"text",placeholder:"Search places...",value:k,onChange:ae=>{ee(ae.target.value),C(ae.target.value)},className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-10 pr-4 py-3 text-white focus:outline-none focus:border-brand-500"}),j==="OK"&&I.length>0&&o.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-slate-900 border border-brand-800 rounded-xl shadow-xl z-50 max-h-40 overflow-y-auto",children:I.map(ae=>o.jsxs("div",{onClick:()=>{ee(ae.structured_formatting.main_text,!1),C(ae.structured_formatting.main_text),b(ae.structured_formatting.secondary_text),ne()},className:"px-4 py-2 hover:bg-white/10 cursor-pointer text-sm text-slate-300 truncate",children:[o.jsx("span",{className:"font-bold text-white",children:ae.structured_formatting.main_text}),o.jsxs("span",{className:"text-slate-500 ml-1",children:["- ",ae.structured_formatting.secondary_text]})]},ae.place_id))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest px-1",children:"Expires In"}),o.jsx("div",{className:"grid grid-cols-3 gap-2 mt-1",children:["1","2","4"].map(ae=>o.jsxs("button",{onClick:()=>S(ae),className:`py-2 rounded-xl text-xs font-bold transition border ${E===ae?"bg-brand-600 border-brand-500 text-white":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:[ae," Hour",ae!=="1"&&"s"]},ae))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest px-1",children:"Add Photo (Optional)"}),R?null:o.jsxs("div",{className:"flex gap-2 mt-1",children:[o.jsx("div",{className:"flex-1 relative group",children:o.jsxs("div",{className:"border border-slate-700 bg-slate-900/50 rounded-xl p-3 flex flex-col items-center justify-center cursor-pointer hover:bg-slate-800 hover:border-brand-500 transition h-24",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:de,className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full z-10"}),o.jsx("div",{className:"bg-slate-800 p-2 rounded-full mb-1 group-hover:scale-110 transition",children:o.jsxs("svg",{className:"w-4 h-4 text-brand-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),o.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"Gallery"})]})}),o.jsx("div",{className:"flex-1 relative group",children:o.jsxs("div",{className:"border border-slate-700 bg-slate-900/50 rounded-xl p-3 flex flex-col items-center justify-center cursor-pointer hover:bg-slate-800 hover:border-brand-500 transition h-24",children:[o.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:de,className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full z-10"}),o.jsx("div",{className:"bg-slate-800 p-2 rounded-full mb-1 group-hover:scale-110 transition",children:o.jsx(Za,{className:"w-4 h-4 text-brand-400"})}),o.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"Camera"})]})})]}),o.jsx("input",{type:"file",accept:"image/*",id:"drop-image-upload",onChange:de,className:"hidden"}),R?o.jsxs("div",{className:"relative w-full h-32 rounded-xl overflow-hidden border border-brand-700 group",children:[o.jsx("img",{src:R,alt:"Preview",className:"w-full h-full object-cover"}),o.jsx("button",{onClick:()=>L(null),className:"absolute top-2 right-2 bg-black/50 p-1.5 rounded-full text-white hover:bg-red-500 transition",children:o.jsx($e,{className:"w-4 h-4"})})]}):null]})]}),o.jsxs("button",{onClick:async()=>{N(!0),await Ne(),N(!1)},disabled:!p||U,className:"w-full bg-white text-brand-900 font-bold py-3.5 rounded-xl hover:bg-slate-200 transition mt-4 disabled:opacity-50 flex items-center justify-center gap-2",children:[U?o.jsx(jo,{className:"w-5 h-5 animate-spin"}):o.jsx(Ca,{className:"w-4 h-4"}),U?"Dropping...":"Drop Vibe Pin"]})]})})]})},Lh=async t=>{if(!t)return!1;const e=t.toLowerCase().trim();if(["admin","support","vibe","vibemap"].includes(e))return!1;try{const n=Pe(le,"users"),s=tt(n,dt("handle","==",e));return(await ht(s)).empty}catch(n){return console.error("Error checking handle availability:",n),!1}},Cv={Music:{icon:o.jsx(tS,{className:"w-4 h-4"}),options:["Rock","Pop","Jazz","Techno","EDM","Hip-Hop","Classical","Indie","Metal","R&B"]},Dance:{icon:o.jsx(ZT,{className:"w-4 h-4"}),options:["Salsa","Bachata","Hip-Hop","Contemporary","Freestyle","Ballroom","Bollywood","Bhangra"]},Food:{icon:o.jsx(PS,{className:"w-4 h-4"}),options:["Mediterranean","Mughlai","Indian","Continental","Pan-Asian","Italian","Mexican","Street Food"]},Ambiance:{icon:o.jsx(sd,{className:"w-4 h-4"}),options:["Rooftop","Speakeasy","Outdoor","Cozy","Energetic","Romantic","Dive Bar","Live Music"]}},Av=({onComplete:t})=>{const[e,n]=A.useState(1);ml.useEffect(()=>{Ye.currentUser&&n(2)},[]);const[s,r]=A.useState(""),[i,a]=A.useState(50),[c,u]=A.useState([]),[d,f]=A.useState(!1),[m,p]=A.useState(""),[y,T]=A.useState(""),[C,P]=A.useState(!1),[b,E]=A.useState(""),[S,R]=A.useState("Music"),[L,U]=A.useState({Music:[],Dance:[],Food:[],Ambiance:[]}),N=async()=>{if(!s)return;f(!0);let _="Balanced vibe";i<30&&(_="Very lowkey, chill, mysterious"),i>70&&(_="High energy, raging, loud, party");const k=`${s}. Intensity: ${_}`,j=await L3(k),I=[];for(const ee of j)await Lh(ee)&&I.push(ee);u(I.length>0?I:["VibeMaster_X","Neon_Soul_01"]),f(!1)},x=(_,k)=>{U(j=>{const I=j[_];return I.includes(k)?{...j,[_]:I.filter(ee=>ee!==k)}:I.length>=3?j:{...j,[_]:[...I,k]}})},v=y||m;return e===1?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-brand-900 via-slate-950 to-slate-950 p-4",children:o.jsxs("div",{className:"w-full max-w-md bg-white/5 backdrop-blur-xl border border-white/10 p-8 rounded-3xl text-center space-y-6 animate-fade-in-up",children:[o.jsx("div",{className:"w-16 h-16 bg-brand-600 rounded-2xl mx-auto flex items-center justify-center rotate-3 shadow-2xl shadow-brand-500/20",children:o.jsx(Bi,{className:"text-white w-8 h-8"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome to VibeMap"}),o.jsx("p",{className:"text-slate-400",children:"Reconnect with the moments you missed."})]}),o.jsxs("button",{onClick:async()=>{try{await cP(Ye,s3),n(2)}catch(_){console.error(_),alert("Login Failed: "+_.message)}},className:"w-full bg-white text-brand-900 font-bold py-3.5 rounded-xl hover:bg-slate-200 transition flex items-center justify-center gap-2 shadow-lg",children:[o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:o.jsx("path",{fill:"currentColor",d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"})}),"Continue with Google"]}),o.jsx("p",{className:"text-xs text-slate-500",children:"By continuing, you agree to our Terms & Privacy Policy."})]})}):o.jsx("div",{className:"min-h-screen bg-slate-950 p-4 pt-8 pb-20 md:flex md:items-center md:justify-center overflow-y-auto",children:o.jsxs("div",{className:"w-full max-w-lg space-y-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Create your Flex"}),o.jsx("p",{className:"text-slate-400 text-sm",children:"Design your vibe identity."})]}),o.jsxs("div",{className:"bg-brand-900/20 backdrop-blur-md border border-brand-500/20 p-5 rounded-2xl space-y-4",children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-bold text-brand-200 uppercase tracking-wider flex items-center gap-2",children:[o.jsx(Bi,{className:"w-4 h-4 text-brand-400"})," Flex Generator"]}),o.jsx("span",{className:"text-[10px] bg-brand-500/10 text-brand-400 px-2 py-0.5 rounded-full border border-brand-500/20",children:"Recommended"})]}),o.jsx("p",{className:"text-[10px] text-brand-400/80",children:"Let AI craft your unique Vibe Flex."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",value:s,onChange:_=>r(_.target.value),className:"w-full bg-slate-950/50 border border-slate-700/50 rounded-xl px-4 py-3 text-white focus:border-brand-500 focus:outline-none placeholder:text-slate-600 text-sm",placeholder:"Describe your vibe (e.g., 'Techno raver seeking chill spots')"}),o.jsxs("div",{className:"bg-slate-950/30 p-3 rounded-xl border border-white/5 space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-bold text-slate-400",children:[o.jsx("span",{children:"Lowkey"}),o.jsxs("span",{children:["Intensity: ",i,"%"]}),o.jsx("span",{children:"Raging"})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:i,onChange:_=>a(Number(_.target.value)),className:"w-full h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-brand-500"})]}),o.jsxs("button",{onClick:N,disabled:d||!s,className:"w-full bg-brand-600 py-3 rounded-xl hover:bg-brand-500 transition disabled:opacity-50 text-white font-bold shadow-lg shadow-brand-600/20 flex items-center justify-center gap-2",children:[d?o.jsx(dS,{className:"animate-spin w-5 h-5"}):o.jsx(Bi,{className:"w-5 h-5"}),"Generate Flex"]})]}),c.length>0&&o.jsx("div",{className:"grid grid-cols-2 gap-2 animate-fade-in pt-2",children:c.map(_=>o.jsxs("button",{onClick:()=>{p(_),T("")},className:`p-2.5 rounded-lg text-xs font-medium transition text-left truncate border ${m===_&&!y?"bg-brand-600 border-brand-500 text-white shadow-md":"bg-slate-800/50 border-white/5 text-slate-300 hover:bg-slate-700 hover:border-white/10"}`,children:["@",_]},_))})]}),o.jsxs("div",{className:"bg-slate-900/40 border border-white/5 p-5 rounded-2xl relative space-y-2",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Or flex manually"})}),o.jsx("input",{type:"text",value:y,onChange:async _=>{const k=_.target.value;if(T(k),p(""),E(""),k.length>3){P(!0);const j=await Lh(k);P(!1),j||E("Handle is already taken.")}},className:`w-full bg-transparent border-b ${y.toLowerCase()==="admin"?"border-red-500":"border-slate-700"} py-2 text-white focus:border-white focus:outline-none placeholder:text-slate-600 text-sm transition-colors`,placeholder:"Type your handle..."}),C&&o.jsx("p",{className:"text-slate-500 text-[10px] mt-1",children:"Checking availability..."}),b&&o.jsx("p",{className:"text-red-500 text-[10px] font-medium mt-1",children:b}),y.toLowerCase()==="admin"&&o.jsx("p",{className:"text-red-500 text-[10px] font-medium mt-1",children:"Reserved handle."})]}),o.jsxs("div",{className:"bg-slate-900/40 border border-white/5 p-5 rounded-2xl space-y-4",children:[o.jsx("label",{className:"text-sm font-bold text-slate-300 uppercase tracking-wider block mb-2",children:"Your Vibe Profile"}),o.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-2",children:Object.keys(Cv).map(_=>o.jsxs("button",{onClick:()=>R(_),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-all ${S===_?"bg-white text-brand-950 shadow-lg":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[_,L[_].length>0&&o.jsx("span",{className:"ml-2 bg-brand-600 text-white rounded-full w-4 h-4 inline-flex items-center justify-center text-[8px]",children:L[_].length})]},_))}),o.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-xl border border-white/5 min-h-[120px] animate-fade-in",children:[o.jsx("div",{className:"flex flex-wrap gap-2",children:Cv[S].options.map(_=>{const k=L[S].includes(_);return o.jsx("button",{onClick:()=>x(S,_),disabled:!k&&L[S].length>=3,className:`px-3 py-1.5 rounded-lg text-xs font-medium border transition-all ${k?"bg-brand-600 border-brand-500 text-white shadow-brand-500/20 shadow-md":"bg-transparent border-slate-700 text-slate-400 hover:border-slate-500 hover:text-slate-300 disabled:opacity-30"}`,children:_},_)})}),o.jsxs("p",{className:"text-[10px] text-slate-600 mt-4 text-center",children:["Select up to 3 ",S," vibes."]})]})]}),v&&o.jsxs("div",{className:"bg-gradient-to-r from-brand-900/50 to-slate-900/50 border border-brand-500/30 p-4 rounded-xl flex items-center gap-4 animate-fade-in",children:[o.jsx("div",{className:"w-12 h-12 bg-brand-600/20 rounded-full flex items-center justify-center border border-brand-500/50",children:o.jsx(Bi,{className:"w-6 h-6 text-brand-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("h4",{className:"text-white font-bold text-sm",children:["@",v]}),o.jsx("p",{className:"text-xs text-brand-200",children:i>70?"High Energy  Party Starter":i<30?"Lowkey  Mystery Guest":"Balanced  Social Explorer"})]}),o.jsx(Ao,{className:"w-5 h-5 text-green-400"})]}),o.jsxs("button",{onClick:async()=>{if(!v)return;const _=Object.values(L).reduce((I,ee)=>I.concat(ee),[]);if(!Ye.currentUser)return;if(!await Lh(v)){alert("This handle was just taken! Please choose another.");return}const j={id:Ye.currentUser.uid,displayName:Ye.currentUser.displayName||v,email:Ye.currentUser.email||"",handle:v,avatarUrl:Ye.currentUser.photoURL||`https://ui-avatars.com/api/?name=${v}&background=7c3aed&color=fff`,isConnected:!0,interests:_,trustScore:80,followersCount:0,followingCount:0,followers:[],following:[],vibes:_,isNewUser:!0};try{await Eo(He(le,"users",j.id),j),t(j)}catch(I){console.error(I)}},disabled:!v||!!b||C,className:"w-full bg-white text-brand-900 font-bold py-4 rounded-xl hover:bg-slate-200 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl shadow-white/5",children:["Start Vibing ",o.jsx(Of,{className:"w-4 h-4"})]})]})})};var Ue=(t=>(t.WILL_JOIN="Going",t.INTERESTED="Interested",t.MAYBE="Maybe",t.NOT_THIS_TIME="Not Going",t))(Ue||{});const Ti={COMMENT:1,REACTION:.5,RSVP_GOING:2,RSVP_MAYBE:1,RSVP_INTERESTED:.5,RSVP_NOT_GOING:0},vc=t=>{var n;let e=0;return e+=(((n=t.comments)==null?void 0:n.length)||0)*Ti.COMMENT,e+=(t.likes||0)*Ti.REACTION,t.rsvps&&Object.values(t.rsvps).forEach(s=>{Object.values(t.rsvps).forEach(r=>{const i=r;i===Ue.WILL_JOIN||i==="Going"?e+=Ti.RSVP_GOING:i===Ue.MAYBE||i==="Maybe"?e+=Ti.RSVP_MAYBE:i===Ue.INTERESTED||i==="Interested"?e+=Ti.RSVP_INTERESTED:(i===Ue.NOT_THIS_TIME||i==="Not Going")&&(e+=Ti.RSVP_NOT_GOING)})}),e},wc=t=>{if(!t.visitDate)return!1;const e=new Date(t.visitDate).getTime(),s=Date.now()-3*60*60*1e3;return e>s},Fs=(t,e)=>e==="visited"?new Date(t.visitDate).getTime():new Date(t.createdAt||t.visitDate).getTime(),U3=(t,e,n,s,r,i,a)=>{let c=[...t];const u=(e==null?void 0:e.following)||[];return[...n.filter(f=>u.includes(f.id)).map(f=>f.id),e!=null&&e.id],s==="inner-circle"?(c=c.filter(f=>u.includes(f.user.id)||f.user.id===(e==null?void 0:e.id)),c.sort((f,m)=>{const p=wc(f),y=wc(m);return p&&!y?-1:!p&&y?1:Fs(m,r)-Fs(f,r)})):s==="trend"?(c=c.filter(f=>!u.includes(f.user.id)&&f.user.id!==(e==null?void 0:e.id)),c.sort((f,m)=>{const p=wc(f),y=wc(m);if(p&&!y)return-1;if(!p&&y)return 1;const T=vc(f),C=vc(m);return T!==C?C-T:Fs(m,r)-Fs(f,r)})):s==="places"?(c=c.filter(f=>f.location&&f.location.name),c.sort((f,m)=>{const p=vc(f),y=vc(m);return p!==y?y-p:Fs(m,r)-Fs(f,r)})):s==="polls"&&(c=c.filter(f=>f.type==="poll"),c.sort((f,m)=>Fs(m,r)-Fs(f,r))),c},$3=t=>new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),z3=t=>t.split(/(\s+)/).map((e,n)=>e.startsWith("@")?o.jsx("span",{className:"text-blue-400 font-medium cursor-pointer hover:underline",children:e},n):e.startsWith("#")?o.jsx("span",{className:"text-brand-400 font-medium cursor-pointer hover:underline",children:e},n):e),B3=t=>{if(!t||t==="Unknown"||t==="Unknown Address")return"";const e=t.split(",").map(u=>u.trim()),n=/(Cyber\s?Hub|Cyber\s?City|Worldmark|Aerocity|Galleria|Horizon\s?Center|Vatika|Select\s?City|Promenade|Ambience|Mall|Market|Bazaar|Plaza|High\s?Street|Trade\s?Tower)/i,s=e.find(u=>n.test(u));if(s)return`, ${s}`;const r=/(Sector\s?\d+|Phase\s?\d+|Block\s?[A-Z](\s|$)|Pocket\s?[A-Z])/i,i=e.find(u=>r.test(u));if(i)return`, ${i}`;const a=/^(Tower|Floor|Ground|Shop|Unit|Plot|Building|Room|Flat|No\.|#|Level)/i,c=e.find(u=>!a.test(u)&&u.length>3&&isNaN(Number(u)));return c?`, ${c}`:`, ${e[0]}`},To=({isFollowing:t,isFollower:e=!1,isFriend:n=!1,onToggle:s,size:r="md",className:i=""})=>{const a={sm:"w-2 h-2",md:"w-2.5 h-2.5",lg:"w-3 h-3"};let c="Follow",u=pr,d="bg-brand-600 border-brand-500 text-white hover:bg-brand-500 hover:scale-105 shadow-brand-500/20";n?(c="Friend",u=kS,d="bg-slate-800 border-slate-600 text-brand-300 hover:text-white hover:border-brand-500 hover:bg-brand-900/50"):t?(c="Following",u=Ao,d="bg-slate-800 border-slate-600 text-slate-400 hover:bg-red-500/20 hover:text-red-500 hover:border-red-500"):e&&(c="Follow Back",u=pr,d="bg-brand-600 border-brand-500 text-white hover:bg-brand-500 hover:scale-105 shadow-brand-500/20");const f=`
        ${r==="sm"?"px-3 py-1 text-[10px]":""}
        ${r==="md"?"px-4 py-1.5 text-[11px]":""}
        ${r==="lg"?"px-6 py-2 text-sm":""}
    `;return o.jsxs("button",{onClick:s,className:`
                rounded-xl flex items-center justify-center transition-all shadow-lg border font-bold gap-1.5
                ${d}
                ${f}
                ${i}
            `,title:t?"Unfollow":"Follow",children:[o.jsx(u,{className:a[r]}),o.jsx("span",{children:c})]})},Pl="notifications",ya=async(t,e,n,s,r)=>{try{if(t===e)return;const i=await Uo(He(le,"users",e)),a=i.exists()?i.data():{};await Ts(Pe(le,Pl),{recipientId:t,senderId:e,type:n,targetId:r||null,message:s,read:!1,createdAt:new Date().toISOString(),senderName:a.handle?`@${a.handle}`:a.displayName||"Someone",senderAvatar:a.avatarUrl||""})}catch(i){console.error("Error sending notification:",i)}},q3=(t,e)=>{const n=tt(Pe(le,Pl),dt("recipientId","==",t),Wr("createdAt","desc"),No(20));return ri(n,s=>{const r=s.docs.map(i=>({id:i.id,...i.data()}));e(r)})},H3=async t=>{try{await hn(He(le,Pl,t),{read:!0})}catch(e){console.error("Error marking notification read:",e)}},G3=async(t,e)=>{try{const n=Q1(le),s=e.filter(r=>!r.read);if(s.length===0)return;s.forEach(r=>{const i=He(le,Pl,r.id);n.update(i,{read:!0})}),await n.commit()}catch(n){console.error("Error marking all read:",n)}},Hc=async(t,e,n,s)=>{try{let r=tt(Pe(le,Pl),dt("recipientId","==",t),dt("senderId","==",e),dt("type","==",n));s&&(r=tt(r,dt("targetId","==",s)));let i=await ht(r);i.empty&&(await new Promise(c=>setTimeout(c,1e3)),i=await ht(r));const a=Q1(le);i.docs.forEach(c=>{a.delete(c.ref)}),await a.commit()}catch(r){console.error("Error removing notification:",r)}},W3=({score:t})=>{const e=t??80;let n="text-blue-400 bg-blue-500/10 border-blue-500/20",s=tn,r="Verified";return e>=90?(n="text-yellow-400 bg-green-500/20 border-green-500/50 shadow-[0_0_10px_rgba(34,197,94,0.3)]",s=Zb,r="Vouched"):e<70&&(n="text-red-500 bg-red-500/10 border-red-500/50",s=fo,r="Flagged"),o.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold border transition-all ${n}`,title:`Trust Score: ${e}/100 (${r})`,children:[o.jsx(s,{className:"w-3 h-3 fill-current opacity-80"}),o.jsx("span",{children:e})]})},K3=({userId:t})=>{const[e,n]=A.useState(null),[s,r]=A.useState(!0);if(ml.useEffect(()=>{(async()=>{if(t==="anonymous"){r(!1);return}try{const u=await Uo(He(le,"users",t));u.exists()&&n({id:u.id,...u.data()})}catch(u){console.error("Failed to fetch RSVP user",u)}finally{r(!1)}})()},[t]),s)return o.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 animate-pulse"});const i=(e==null?void 0:e.displayName)||"Unknown User",a=(e==null?void 0:e.avatarUrl)||`https://ui-avatars.com/api/?name=${i.charAt(0)}`;return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:a,className:"w-8 h-8 rounded-full object-cover",alt:i}),o.jsxs("span",{className:"text-sm text-slate-200",children:["@",(e==null?void 0:e.handle)||"user"]})]})},wg=({post:t,onUpdatePost:e,onDeletePost:n,onUserClick:s,onPlaceClick:r,isPlaceFollowed:i,onToggleFollow:a,isUserFollowed:c,onToggleUserFollow:u,onRequestEdit:d,currentUser:f})=>{var Se;if(!t||!t.user)return console.error("PostCard received invalid post data:",t),null;const[m,p]=A.useState(""),[y,T]=A.useState(!1),[C,P]=A.useState(!1),[b,E]=A.useState(null),[S,R]=A.useState(""),L=((Se=Ye.currentUser)==null?void 0:Se.uid)===t.user.id,[U,N]=A.useState(!1),[x,v]=A.useState(!1),[_,k]=A.useState(!1),[j,I]=A.useState(!1),[ee,ne]=A.useState(null),[Ne,de]=A.useState(!1),$=new Date(t.visitDate)<new Date,J=[Ue.WILL_JOIN,Ue.INTERESTED,Ue.MAYBE],H=t.rsvps||{},ue=Object.values(H).filter(B=>J.includes(B)).length,me=t.userReaction,je=(B,Z)=>{E(B),R(Z)},Te=async B=>{if(S.trim())try{const Z=await kv(S);if(!Z.safe){Kn("Edit Comment",new Error(Z.reason),un.DATA_INVALID_TYPE);return}const Q=t.comments.map(M=>M.id===B?{...M,text:S}:M);e({id:t.id,comments:Q}),E(null),R("")}catch(Z){Kn("Save Comment",Z,un.NET_FIRESTORE_WRITE)}};A.useEffect(()=>{const Z=new URLSearchParams(window.location.search).get("undo");if(Z){const[Q,M,se]=Z.split(":");if(Q==="undo-comment-delete"&&M===t.id){K(se);const q=new URL(window.location.href);q.searchParams.delete("undo"),window.history.replaceState({},document.title,q.toString())}}},[t.id]),A.useEffect(()=>{const Z=new URLSearchParams(window.location.search).get("undo");if(Z){const[Q,M,se]=Z.split(":");if(Q==="undo-comment-delete"&&M===t.id){K(se);const q=new URL(window.location.href);q.searchParams.delete("undo"),window.history.replaceState({},document.title,q.toString())}}},[t.id]);const ae=B=>{var ie;if($)return;const Z=((ie=Ye.currentUser)==null?void 0:ie.uid)||"anonymous",Q=t.rsvps||{},se=Q[Z]===B,q={...Q};se?delete q[Z]:q[Z]=B,e({id:t.id,rsvps:q}),se?Hc(t.user.id,Z,"rsvp",t.id):((B===Ue.WILL_JOIN||B===Ue.MAYBE)&&ne(B),ya(t.user.id,Z,"rsvp",`is ${B} for your drop at ${t.location.name}`,t.id))},O=B=>{var q;const Z=(q=Ye.currentUser)==null?void 0:q.uid;if(!Z){alert("Please sign in to react.");return}const Q={...t.reactions||{}},M=Q[Z]===B||!t.reactions&&t.userReaction===B;M?delete Q[Z]:Q[Z]=B;const se=Object.keys(Q).length;e({id:t.id,likes:se,reactions:Q,userReaction:M?void 0:B}),M?Hc(t.user.id,Z,"like",t.id):ya(t.user.id,Z,"like",`reacted ${B==="heart"?"":B==="fire"?"":""} to your vibe`,t.id)},K=B=>{const Z=t.comments.map(Q=>Q.id===B?{...Q,deleted:!1}:Q);e({id:t.id,comments:Z})},te=async B=>{var M,se;if(!window.confirm("Delete this comment?"))return;const Z=t.comments.map(q=>q.id===B?{...q,deleted:!0}:q);e({id:t.id,comments:Z});const Q=t.comments.find(q=>q.id===B);Q&&t.user.id!==Q.userId&&Hc(t.user.id,Q.userId,"comment",t.id),ya(((M=Ye.currentUser)==null?void 0:M.uid)||"anonymous",((se=Ye.currentUser)==null?void 0:se.uid)||"anonymous","system","Comment deleted. Tap to undo.",`undo-comment-delete:${t.id}:${B}`)},xe=async()=>{var se;if(!m)return;T(!0);const B=await kv(m);if(!B.safe){Kn("Post Comment",new Error(B.reason),un.DATA_INVALID_TYPE),T(!1);return}const Z=((se=Ye.currentUser)==null?void 0:se.uid)||"anonymous",Q={id:Date.now().toString(),userId:Z,userName:f!=null&&f.handle?`@${f.handle}`:"Anonymous",text:m,timestamp:new Date().toISOString(),isInfluencer:(f==null?void 0:f.isInfluencer)||!1},M=[...t.comments,Q];e({id:t.id,comments:M}),ya(t.user.id,Z,"comment",`commented: "${m.substring(0,30)}${m.length>30?"...":""}"`,t.id),p(""),T(!1)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-xl mb-6 relative",children:[o.jsxs("div",{className:"p-4 flex items-center justify-between relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:t.user.avatarUrl,alt:t.user.displayName,className:"w-10 h-10 rounded-full border border-slate-700 object-cover cursor-pointer",onClick:()=>s==null?void 0:s(t.user)}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-white font-bold text-sm cursor-pointer hover:underline",onClick:()=>s==null?void 0:s(t.user),children:["@",t.user.handle||"user"]}),u&&c!==void 0&&!L&&o.jsx("div",{onClick:B=>B.stopPropagation(),children:o.jsx(To,{isFollowing:c,onToggle:B=>{B.stopPropagation(),u()},size:"sm"})}),o.jsx(W3,{score:t.user.trustScore}),t.user.isInfluencer&&o.jsx(en,{className:"w-3 h-3 text-amber-500 fill-amber-500 ml-1"})]}),o.jsxs("div",{className:"text-xs text-slate-400 mt-0.5",children:[new Date(t.visitDate).toLocaleDateString(void 0,{month:"short",day:"numeric"}),"  ",$3(t.visitDate)]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>N(!U),className:"text-slate-400 hover:text-white p-2 rounded-full hover:bg-slate-800 transition",children:o.jsx(IT,{className:"w-5 h-5"})}),U&&o.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-slate-900 border border-slate-700 rounded-xl shadow-2xl p-1 z-50 min-w-[150px] animate-fade-in",children:[L&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>{d==null||d(t),N(!1)},className:"w-full text-left px-3 py-2 text-slate-300 hover:bg-slate-800 rounded-lg text-sm flex items-center gap-2 transition",children:[o.jsx(Tx,{className:"w-4 h-4"})," Edit Post"]}),o.jsxs("button",{onClick:()=>{n==null||n(t.id),N(!1)},className:"w-full text-left px-3 py-2 text-red-400 hover:bg-red-500/10 rounded-lg text-sm flex items-center gap-2 transition",children:[o.jsx(Lf,{className:"w-4 h-4"})," Delete"]}),o.jsx("div",{className:"h-px bg-slate-800 my-1"})]}),o.jsxs("button",{onClick:()=>{k(!0),N(!1)},className:"w-full text-left px-3 py-2 text-slate-300 hover:bg-slate-800 rounded-lg text-sm flex items-center gap-2 transition",children:[o.jsx(Xi,{className:"w-4 h-4"})," Share"]}),o.jsxs("button",{onClick:()=>{v(!0),N(!1)},className:"w-full text-left px-3 py-2 text-slate-300 hover:bg-slate-800 rounded-lg text-sm flex items-center gap-2 transition",children:[o.jsx(AT,{className:"w-4 h-4"})," Report"]})]})]})]}),o.jsxs("div",{className:"px-4 pb-2",children:[t.type!=="poll"&&o.jsx("div",{className:"flex items-center gap-1 mb-3",children:o.jsxs("div",{onClick:()=>r==null?void 0:r(t.location.address&&t.location.address!=="Unknown"?`${t.location.name}, ${t.location.address}`:t.location.name),className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-brand-900/50 border border-brand-500/30 rounded-full text-brand-200 text-xs font-medium cursor-pointer hover:bg-brand-900 transition",children:[o.jsx(Ve,{className:"w-3 h-3"}),t.location.name,a&&i!==void 0&&o.jsx("div",{className:"ml-1",onClick:B=>B.stopPropagation(),children:o.jsx(To,{isFollowing:i,onToggle:B=>{B.stopPropagation(),a()},size:"sm"})}),t.location.shortLocation?`, ${t.location.shortLocation}`:B3(t.location.address)]})}),(()=>{var B,Z;if(t.type==="poll"&&t.pollData){const{pollData:Q}=t,M=Q.totalVotes||0,se=(B=Ye.currentUser)!=null&&B.uid?(Z=Q.voters)==null?void 0:Z[Ye.currentUser.uid]:null,q=ie=>{if(se||!Ye.currentUser)return;const we={...Q.voters||{},[Ye.currentUser.uid]:ie},pe=Q.options.map(Oe=>Oe.id===ie?{...Oe,voteCount:(Oe.voteCount||0)+1}:Oe);e({id:t.id,pollData:{...Q,options:pe,voters:we,totalVotes:M+1}})};return o.jsxs("div",{className:"mt-2 mb-4",children:[o.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:Q.question}),o.jsx("div",{className:"space-y-2",children:Q.options.map(ie=>{const we=M>0?Math.round(ie.voteCount/M*100):0,pe=se===ie.id;return o.jsxs("button",{onClick:()=>q(ie.id),disabled:!!se,className:`relative w-full text-left p-3 rounded-xl overflow-hidden border transition-all ${pe?"border-brand-500":"border-slate-700 hover:border-slate-500"}`,children:[se&&o.jsx("div",{className:"absolute inset-y-0 left-0 bg-brand-900/50 transition-all duration-1000",style:{width:`${we}%`}}),o.jsxs("div",{className:"relative z-10 flex justify-between items-center",children:[o.jsx("span",{className:`font-medium ${pe?"text-brand-300":"text-slate-200"}`,children:ie.text}),se&&o.jsxs("span",{className:"text-xs font-bold text-slate-400",children:[we,"%"]})]})]},ie.id)})}),o.jsxs("div",{className:"mt-2 text-xs text-slate-500 font-medium",children:[M," votes  ",new Date(Q.expiresAt)<new Date?"Ended":"Ends soon"]})]})}else{const Q=t.description.match(/^\[(.*?)\]\s*(.*)/s),M=Q?Q[1]:null,se=Q?Q[2]:t.description;return o.jsxs(o.Fragment,{children:[M&&o.jsx("div",{className:"mb-2",children:o.jsx("span",{className:"inline-block bg-brand-500/20 text-brand-300 text-xs font-bold px-2 py-1 rounded-md border border-brand-500/30",children:M})}),o.jsx("p",{className:"text-slate-200 whitespace-pre-wrap text-sm leading-relaxed",children:z3(se)})]})}})()]}),t.imageUrl&&o.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-slate-700/50 cursor-zoom-in",onClick:()=>I(!0),children:o.jsx("img",{src:t.imageUrl,alt:"Post attachment",className:"w-full h-auto max-h-96 object-cover hover:scale-105 transition-transform duration-500"})}),!$&&t.type!=="poll"&&o.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-3 mb-4 flex flex-col gap-3 mx-4",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("span",{className:"text-xs text-slate-400 uppercase font-bold tracking-widest pl-1",children:"You in? "})}),o.jsx("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:gap-2",children:[Ue.WILL_JOIN,Ue.INTERESTED,Ue.MAYBE,Ue.NOT_THIS_TIME].map(B=>{var se;const Z=((se=Ye.currentUser)==null?void 0:se.uid)||"anonymous",Q=t.rsvps&&t.rsvps[Z]===B;Ue.MAYBE,Ue.NOT_THIS_TIME,Ue.INTERESTED;const M=Object.values(t.rsvps).filter(q=>q===B).length;return o.jsxs("button",{onClick:()=>ae(B),className:`px-3 py-2 rounded-lg text-[10px] sm:text-xs font-medium flex items-center justify-between gap-1.5 transition-all flex-1 whitespace-nowrap ${Q?"bg-brand-600 text-white shadow-lg shadow-brand-600/20":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[B===Ue.WILL_JOIN&&o.jsx(o.Fragment,{children:"Locked in "}),B===Ue.INTERESTED&&o.jsx(o.Fragment,{children:"Low-key curious "}),B===Ue.MAYBE&&o.jsx(o.Fragment,{children:"Vibes TBD "}),B===Ue.NOT_THIS_TIME&&o.jsx(o.Fragment,{children:"Out this time "})]}),o.jsx("span",{className:`text-[10px] font-bold ${Q?"text-white/80":"text-slate-500"}`,children:M})]},B)})})]}),$&&ue>0&&o.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-3 mb-4 flex items-center justify-between opacity-70 mx-4",children:[o.jsx("span",{className:"text-xs text-slate-500 uppercase font-bold tracking-widest",children:"Event Ended"}),o.jsxs("button",{onClick:()=>de(!0),className:"text-xs text-slate-400 font-medium flex items-center gap-1",children:[o.jsx(Xt,{className:"w-3 h-3"})," ",ue," attended"]})]}),o.jsxs("div",{className:"flex items-center gap-4 border-t border-slate-800/50 pt-3 px-4 pb-4",children:[o.jsxs("div",{className:"flex items-center bg-slate-800/50 rounded-full px-2 py-1",children:[o.jsx("button",{onClick:()=>O("heart"),className:`p-1.5 rounded-full transition-transform active:scale-90 hover:bg-slate-700 ${me==="heart"?"text-pink-500":"text-slate-400"}`,children:o.jsx(up,{className:`w-5 h-5 ${me==="heart"?"fill-current":""}`})}),o.jsx("button",{onClick:()=>O("fire"),className:`p-1.5 rounded-full transition-transform active:scale-90 hover:bg-slate-700 ${me==="fire"?"text-orange-500":"text-slate-400"}`,children:o.jsx(el,{className:`w-5 h-5 ${me==="fire"?"fill-current":""}`})}),o.jsx("button",{onClick:()=>O("party"),className:`p-1.5 rounded-full transition-transform active:scale-90 hover:bg-slate-700 ${me==="party"?"text-yellow-500":"text-slate-400"}`,children:o.jsx(oS,{className:`w-5 h-5 ${me==="party"?"fill-current":""}`})}),o.jsx("span",{className:"text-sm font-bold text-slate-300 ml-2 mr-1",children:Math.max(0,t.likes)})]}),o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[o.jsxs("button",{onClick:()=>P(!C),className:"flex items-center gap-2 text-sm text-slate-400 hover:text-brand-400 transition-colors",children:[o.jsx(mr,{className:"w-5 h-5"}),o.jsxs("span",{className:"hidden sm:inline",children:[t.comments.length," Comments"]}),o.jsx("span",{className:"sm:hidden",children:t.comments.length})]}),o.jsx("button",{onClick:()=>k(!0),className:"flex items-center gap-2 text-sm text-slate-400 hover:text-brand-400 transition-colors",children:o.jsx(Xi,{className:"w-5 h-5"})})]})]}),C&&o.jsxs("div",{className:"mt-0 pt-4 border-t border-slate-800/50 animate-fade-in px-4 pb-4",children:[t.comments.length>0?o.jsx("div",{className:"space-y-3 mb-4",children:t.comments.filter(B=>!B.deleted).map(B=>{var M;const Q=((M=Ye.currentUser)==null?void 0:M.uid)===B.userId||L;return o.jsx("div",{className:"bg-slate-900/30 p-3 rounded-lg text-sm group relative",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("span",{className:"font-bold text-brand-400 mr-2 flex items-center gap-1",children:[B.userName,B.isInfluencer&&o.jsx(en,{className:"w-3 h-3 text-amber-500 fill-amber-500"})]}),b===B.id?o.jsxs("div",{className:"mt-1",children:[o.jsx("input",{value:S,onChange:se=>R(se.target.value),className:"w-full bg-slate-950 border border-slate-700 rounded p-1 text-white focus:border-brand-500 mb-1",autoFocus:!0}),o.jsxs("div",{className:"flex gap-2 text-xs",children:[o.jsx("button",{onClick:()=>Te(B.id),className:"text-brand-400 font-bold hover:underline",children:"Save"}),o.jsx("button",{onClick:()=>E(null),className:"text-slate-500 hover:text-white",children:"Cancel"})]})]}):o.jsx("span",{className:"text-slate-300",children:B.text})]}),Q&&!b&&o.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity ml-2",children:[o.jsx("button",{onClick:()=>je(B.id,B.text),className:"text-slate-500 hover:text-brand-400",children:o.jsx(Tx,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>te(B.id),className:"text-slate-500 hover:text-red-400",children:o.jsx(Lf,{className:"w-3 h-3"})})]})]})},B.id)})}):o.jsx("p",{className:"text-slate-500 text-sm mb-4 italic",children:"No comments yet. Be the first!"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Add a comment...",value:m,onChange:B=>p(B.target.value),className:"flex-1 bg-slate-900/50 border border-slate-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-brand-600 text-white"}),o.jsx("button",{onClick:xe,disabled:y,className:"bg-brand-600 hover:bg-brand-700 p-2 rounded-lg text-white disabled:opacity-50 min-w-[40px] flex items-center justify-center",children:y?o.jsx(jo,{className:"w-5 h-5 animate-spin"}):o.jsx(dp,{className:"w-4 h-4"})})]})]})]}),j&&t.imageUrl&&o.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-0 bg-black/95 animate-fade-in",onClick:()=>I(!1),children:[o.jsx("button",{onClick:()=>I(!1),className:"absolute top-4 right-4 text-white hover:text-brand-400 z-10 p-2 bg-black/20 rounded-full transition-colors",children:o.jsx($e,{className:"w-8 h-8"})}),o.jsx("img",{src:t.imageUrl,alt:"Full screen",className:"max-w-full max-h-screen object-contain",onClick:B=>B.stopPropagation()})]}),x&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative text-center",children:[o.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsx(fo,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Report Post?"}),o.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:"Are you sure you want to report this post? Our AI moderation team will review it for guidelines violations."}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-slate-800 hover:bg-slate-700 py-2.5 rounded-xl font-medium text-slate-300 transition",children:"Cancel"}),o.jsx("button",{onClick:()=>{alert("Reported"),v(!1)},className:"flex-1 bg-red-600 hover:bg-red-700 py-2.5 rounded-xl font-medium text-white transition",children:"Report"})]})]})}),_&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Xi,{className:"w-5 h-5 text-brand-400"})," Share Post"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>{const B=window.location.href;navigator.clipboard.writeText(B),alert("Link copied to clipboard!"),k(!1)},className:"w-full bg-slate-800 hover:bg-slate-700 p-3 rounded-xl flex items-center justify-between text-left transition group",children:[o.jsx("span",{className:"text-slate-200",children:"Copy Link"}),o.jsx($T,{className:"w-5 h-5 text-slate-400 group-hover:text-white"})]}),o.jsxs("button",{onClick:()=>{const B=`Check out this vibe by @${t.user.handle}: ${t.description}`,Z=`https://wa.me/?text=${encodeURIComponent(B)}`;window.open(Z,"_blank"),k(!1)},className:"w-full bg-slate-800 hover:bg-slate-700 p-3 rounded-xl flex items-center justify-between text-left transition group",children:[o.jsx("span",{className:"text-slate-200",children:"Share via WhatsApp"}),o.jsx(mr,{className:"w-5 h-5 text-green-500"})]})]})]})}),ee&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>ne(null),className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Book a Spot?"}),o.jsxs("p",{className:"text-slate-300 mb-6",children:["You're marked as ",o.jsxs("span",{className:"font-bold text-white",children:['"',ee,'"']}),". Reserve a table now to secure your vibe?"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>{alert("Redirecting to booking..."),ne(null)},className:"w-full bg-brand-600 hover:bg-brand-500 py-3 rounded-xl font-bold text-white flex items-center justify-center gap-2",children:[o.jsx(NS,{className:"w-4 h-4"})," Book Table"]}),o.jsx("button",{onClick:()=>ne(null),className:"w-full bg-slate-800 hover:bg-slate-700 py-3 rounded-xl font-bold text-white",children:"No, thanks"})]})]})}),Ne&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-md p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>de(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})," Who's Going"]}),o.jsxs("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:[Object.entries(t.rsvps).length===0&&o.jsx("p",{className:"text-slate-400 italic",children:"No RSVPs yet."}),[Ue.WILL_JOIN,Ue.INTERESTED,Ue.MAYBE].map(B=>{const Z=Object.entries(t.rsvps).filter(([Q,M])=>M===B);return Z.length?o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 border-b border-slate-800 pb-1",children:B}),o.jsx("div",{className:"space-y-2",children:Z.map(([Q,M],se)=>o.jsx(K3,{userId:Q},Q))})]},B):null})]})]})})]})},Q3=t=>{if(!t||t==="Unknown"||t==="Unknown Address")return"Trending Now";const e=t.split(",").map(n=>n.trim());return e.length>0?e[0]:"Trending Now"},nE=async()=>{try{const t=Pe(le,"posts"),e=tt(t,Wr("visitDate","desc"),No(100)),n=await ht(e),s={};n.docs.forEach(i=>{const a=i.data(),c=a.location.name,u=a.location.shortLocation||Q3(a.location.address);s[u]||(s[u]={areaName:u,places:{}});let d="dining";const f=c.toLowerCase();f.includes("bar")||f.includes("pub")||f.includes("brew")||f.includes("social")?d="bar":f.includes("cafe")||f.includes("coffee")||f.includes("starbucks")?d="cafe":(f.includes("club")||f.includes("lounge")||f.includes("night"))&&(d="club"),s[u].places[c]||(s[u].places[c]={count:0,category:d,sampleAddress:a.location.address}),s[u].places[c].count++});const r=Object.values(s).map(i=>{const a=Object.entries(i.places).map(([c,u])=>({name:c,count:u.count,category:u.category,trend:u.count>2?"up":"stable"}));return a.sort((c,u)=>u.count-c.count),{area:i.areaName,places:a.slice(0,5)}});return r.sort((i,a)=>{const c=i.places.reduce((d,f)=>d+f.count,0);return a.places.reduce((d,f)=>d+f.count,0)-c}),r.length>0?r:[{area:"Trending Now",places:[]}]}catch(t){return console.error("Error fetching trending places:",t),[]}},Y3=async t=>new Promise(e=>{if(!window.google||!window.google.maps||!window.google.maps.places){console.warn("Google Maps Places library not loaded."),e(null);return}const n=document.createElement("div"),s=new window.google.maps.places.PlacesService(n),r={query:t,fields:["name","formatted_address","photos","rating","user_ratings_total","geometry"]};s.findPlaceFromQuery(r,(i,a)=>{var c,u;if(a===window.google.maps.places.PlacesServiceStatus.OK&&i&&i[0]){const d=i[0],f=(u=(c=d.photos)==null?void 0:c[0])==null?void 0:u.getUrl({maxWidth:800});e({...d,photos:f?[f]:[]})}else console.warn("Place not found:",a),e(null)})}),X3=async(t,e)=>{const n=new Array(24).fill(0);e.forEach(d=>{const m=new Date(d.visitDate).getHours();n[m]++});const r=75+e.reduce((d,f)=>d+(f.likes||0),0)/10+e.length*2,i=Math.min(Math.floor(r),99),a=new Date,c=new Date(a.getTime()-2*60*60*1e3),u=e.filter(d=>{const f=new Date(d.visitDate);return f>c&&f<=a}).length;return{busyTimes:n,vibeScore:i,liveCount:u}},J3=({onPlaceClick:t,followedPlaces:e,onToggleFollow:n,hotSpots:s})=>{const[r,i]=A.useState(0);if(!s||s.length===0)return null;const a=s[r],c=()=>{i(d=>(d+1)%s.length)},u=d=>{switch(d){case"pub":return"https://images.unsplash.com/photo-1572116469696-95872127f635?auto=format&fit=crop&q=80&w=200";case"bar":return"https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?auto=format&fit=crop&q=80&w=200";case"club":return"https://images.unsplash.com/photo-1566737236500-c8ac43014a67?auto=format&fit=crop&q=80&w=200";case"dining":return"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&q=80&w=200";case"cafe":return"https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&q=80&w=200";default:return"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&q=80&w=200"}};return o.jsxs("div",{className:"w-full overflow-hidden mb-5",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[o.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[o.jsx(Xn,{className:"w-3 h-3 text-brand-400"})," ",a.area]}),o.jsxs("button",{onClick:c,className:"text-[10px] text-slate-500 hover:text-white flex items-center gap-1 transition",children:["Next ",o.jsx(Vf,{className:"w-3 h-3"})]})]}),o.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide px-1",children:a.places.map((d,f)=>{const m=e.includes(d.name);return o.jsxs("div",{onClick:()=>t(`${d.name}, ${a.area} `),className:"min-w-[120px] w-[120px] h-[140px] bg-slate-900 border border-slate-800 rounded-xl flex flex-col justify-end shadow-md flex-shrink-0 relative overflow-hidden group cursor-pointer hover:border-brand-500/50 transition active:scale-95",children:[o.jsx("img",{src:u(d.category),alt:d.name,className:"absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-50 transition-opacity"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent"}),o.jsx("div",{className:"absolute top-1.5 right-1.5 bg-brand-900/80 backdrop-blur text-brand-200 text-[9px] font-bold px-1.5 py-0.5 rounded border border-brand-500/30",children:d.count}),o.jsxs("div",{className:"relative z-10 p-2 w-full flex flex-col h-full justify-end",children:[o.jsx("div",{className:"text-[11px] font-bold text-white truncate leading-tight mb-0.5",children:d.name}),o.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[d.trend==="up"&&o.jsx(Xn,{className:"w-2.5 h-2.5 text-green-400"}),d.trend==="down"&&o.jsx(Xn,{className:"w-2.5 h-2.5 text-red-400 rotate-180"}),d.trend==="stable"&&o.jsx("div",{className:"w-1 h-1 bg-slate-400 rounded-full"}),o.jsx("span",{className:`text - [9px] font - medium ${d.trend==="up"?"text-green-400":d.trend==="down"?"text-red-400":"text-slate-400"} `,children:d.trend==="up"?"Rising":d.trend==="down"?"Quiet":"Stable"})]}),o.jsx("div",{className:"absolute top-2 right-2 z-20",onClick:p=>p.stopPropagation(),children:o.jsx(To,{isFollowing:m,onToggle:p=>{p.stopPropagation(),n(d.name)},size:"sm"})})]})]},f)})})]})},jv=({onPlaceClick:t,onUserClick:e,currentUser:n,followedPlaces:s=[],followingUsers:r=[],onTogglePlaceFollow:i,onToggleUserFollow:a,posts:c,onUpdatePost:u,onDeletePost:d,initialTab:f="inner-circle"})=>{const[m,p]=A.useState(f),[y,T]=A.useState(!1),[C,P]=A.useState(""),[b,E]=A.useState(!1),[S,R]=A.useState([]),[L,U]=A.useState(""),[N,x]=A.useState(!1);A.useEffect(()=>{(async()=>{const Ee=await nE();R(Ee)})()},[c]);const[v,_]=A.useState({});A.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(G=>{const{latitude:Ee,longitude:Me}=G.coords,be=window.google;be&&be.maps&&_({location:new be.maps.LatLng(Ee,Me),radius:5e4})},G=>console.log("Feed Geo error:",G))},[]);const{ready:k,value:j,suggestions:{status:I,data:ee},setValue:ne,clearSuggestions:Ne}=ho({requestOptions:v,debounce:300}),{suggestions:{status:de,data:$},setValue:J,clearSuggestions:H}=ho({requestOptions:v,debounce:300}),[ue,me]=A.useState({users:[],places:[]});A.useEffect(()=>{const Ee=setTimeout(async()=>{const Me=C.trim();if(!Me){me({users:[],places:[]});return}const be=Me.startsWith("@"),Sn=be?Me.substring(1).toLowerCase():Me.toLowerCase();let ft=[];if(be)try{const Un=Pe(le,"users");ft=(await ht(Un)).docs.map(bi=>bi.data()).filter(bi=>{var Fl;const Dd=((Fl=bi.handle)==null?void 0:Fl.toLowerCase())||"",As=bi.displayName.toLowerCase();return Dd.includes(Sn)||As.includes(Sn)}).slice(0,5)}catch(Un){console.error("Feed User Search Error:",Un)}let wi=[];be||($.length>0?wi=$.slice(0,5):wi=S.flatMap($n=>$n.places).filter($n=>$n.name.toLowerCase().includes(Sn)).slice(0,5)),me({users:ft,places:wi})},300);return()=>clearTimeout(Ee)},[C,$]);const[je,Te]=A.useState("regular"),[ae,O]=A.useState(""),[K,te]=A.useState(""),[xe,Se]=A.useState(""),[B,Z]=A.useState(null),[Q,M]=A.useState(null),[se,q]=A.useState(""),[ie,we]=A.useState(["",""]),[pe,Oe]=A.useState("24h"),[Ge,Tn]=A.useState(null),lt=A.useRef(null),Ml=["Dancing","Chilling","Partying","Networking","Dating"],[$t,Cr]=A.useState("posted"),[Ar,Cs]=A.useState([]);A.useEffect(()=>{(async()=>{try{const Ee=tt(Pe(le,"users"),dt("isInfluencer","==",!0)),be=(await ht(Ee)).docs.map(Sn=>({id:Sn.id,...Sn.data()}));Cs(be)}catch(Ee){console.error("Failed to fetch influencers",Ee)}})()},[]);const Ol=n?U3(c,n,Ar,m,$t):[],Vl=m==="inner-circle"?Ar.filter(G=>{var Ee;return((Ee=n==null?void 0:n.following)==null?void 0:Ee.includes(G.id))||G.isFounder}).sort((G,Ee)=>G.isFounder?-1:1):[],Ll=G=>{ne(G.target.value)},jr=(G,Ee,Me,be)=>{ne(Ee,!1),Se(Me||G),U(be),Ne()},vi=G=>{var Me;const Ee=(Me=G.target.files)==null?void 0:Me[0];if(Ee){const be=new FileReader;be.onloadend=()=>{Z(be.result)},be.readAsDataURL(Ee)}},zo=async()=>{if(je==="regular"){if(!j||!ae||!K){Kn("Post Validation",new Error("Missing required fields"),un.DATA_MISSING_FIELDS);return}}else if(!se.trim()||ie.length<2||ie.some(be=>!be.trim())){Kn("Poll Validation",new Error("Poll needs a question and at least 2 options."),un.DATA_MISSING_FIELDS);return}let G="";je==="regular"&&j&&xe&&(G=await tE(j,xe));let Me={...{visitDate:ae||new Date().toISOString(),rsvps:{},comments:[],likes:0,imageUrl:B||null,type:je}};if(je==="regular")Me={...Me,location:{name:j,address:xe||"Unknown Address",shortLocation:G,placeId:L},description:Q?`[${Q}] ${K} `:K};else{const be=new Date;be.setHours(be.getHours()+(pe==="1h"?1:pe==="6h"?6:24)),Me={...Me,location:{name:"Vibe Poll",address:"Digital",shortLocation:"Poll"},description:se,pollData:{question:se,options:ie.map((Sn,ft)=>({id:`opt_${ft} `,text:Sn,voteCount:0})),voters:{},expiresAt:be.toISOString(),totalVotes:0}}}if(n)try{Ge?await vg(Ge,Me):await eE({...Me,user:{id:n.id,displayName:n.displayName,handle:n.handle||"vibemap_user",avatarUrl:n.avatarUrl,isConnected:!0,isInfluencer:n.isInfluencer||!1,trustScore:n.trustScore||0}})}catch(be){Kn(Ge?"Update Post":"Create Post",be,un.NET_FIRESTORE_WRITE)}else{Kn("Auth",new Error("You must be logged in to post."),un.AUTH_NOT_LOGGED_IN);return}T(!1),ne(""),Se(""),O(""),te(""),Z(null),M(null),Tn(null),q(""),we(["",""]),Te("regular")},cs=G=>{Tn(G.id);const Ee=G.description.match(/^\[(.*?)\]\s*(.*)/s),Me=Ee?Ee[1]:null,be=Ee?Ee[2]:G.description;ne(G.location.name),Se(G.location.address),O(G.visitDate),te(be),M(Me),Z(G.imageUrl||null),T(!0)};return o.jsxs("div",{className:"space-y-6 relative pb-20",children:[o.jsx("div",{className:"sticky top-0 z-30 pt-2 pb-2 bg-slate-950/80 backdrop-blur-md -mx-4 px-4 border-b border-white/5",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-3 flex items-center pointer-events-none",children:o.jsx(ti,{className:"w-4 h-4 text-slate-400"})}),o.jsx("input",{type:"text",placeholder:"Use @ to search people (e.g. @nightriot), or type name for places",value:C,onChange:G=>{P(G.target.value),J(G.target.value)},onFocus:()=>E(!0),onBlur:()=>setTimeout(()=>E(!1),200),className:"w-full bg-slate-900 border border-slate-700 rounded-full py-2.5 pl-10 pr-4 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-brand-500 focus:ring-1 focus:ring-brand-500 transition-all shadow-lg"}),b&&C&&o.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-slate-900 border border-brand-800 rounded-xl shadow-2xl p-2 z-40 animate-fade-in max-h-60 overflow-y-auto",children:!$.length&&ue.users.length===0?o.jsx("div",{className:"p-3 text-center text-slate-500 text-sm italic",children:"No matches found."}):o.jsxs(o.Fragment,{children:[de==="OK"&&!C.startsWith("@")&&$.map(G=>o.jsxs("div",{onClick:()=>{console.log("Selected Place:",G),t(G.structured_formatting.main_text),P(G.structured_formatting.main_text),H()},className:"flex items-center gap-3 p-2 hover:bg-slate-800 rounded-lg cursor-pointer transition",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-900/50 flex items-center justify-center border border-brand-800",children:o.jsx(Ve,{className:"w-4 h-4 text-brand-400"})}),o.jsxs("div",{className:"overflow-hidden",children:[o.jsx("div",{className:"text-sm font-bold text-slate-200 truncate",children:G.structured_formatting.main_text}),o.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:G.structured_formatting.secondary_text})]})]},G.place_id)),ue.users.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest px-2 mb-1",children:"People"}),ue.users.map(G=>o.jsxs("div",{onClick:()=>e(G),className:"flex items-center gap-2 p-2 hover:bg-slate-800 rounded-lg cursor-pointer transition",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:G.avatarUrl,className:"w-12 h-12 rounded-full object-cover border border-slate-700",alt:""}),G.isInfluencer&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-[1px] border border-slate-900",children:o.jsx(en,{className:"w-2 h-2 text-black fill-current"})})]}),o.jsx("div",{children:o.jsxs("div",{className:"text-sm font-bold text-slate-200 flex items-center gap-1",children:[G.handle?`@${G.handle}`:G.displayName,G.isInfluencer&&o.jsx(en,{className:"w-3 h-3 text-amber-500 fill-amber-500"})]})})]},G.id))]})]})})]})}),o.jsx("div",{className:"w-full",children:o.jsxs("div",{className:"grid grid-cols-4 bg-brand-900 border border-brand-800 rounded-lg p-1 gap-1",children:[o.jsxs("button",{onClick:()=>p("inner-circle"),className:`py-2 rounded px-1 text-xs sm:text-sm font-medium flex items-center justify-center gap-1 sm:gap-2 transition whitespace-nowrap overflow-hidden ${m==="inner-circle"?"bg-amber-500 text-black shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(en,{className:"w-4 h-4 shrink-0"})," ",o.jsx("span",{children:"Inner Circle"})]}),o.jsxs("button",{onClick:()=>p("trend"),className:`py-2 rounded px-1 text-xs sm:text-sm font-medium flex items-center justify-center gap-1 sm:gap-2 transition whitespace-nowrap overflow-hidden ${m==="trend"?"bg-brand-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(Xn,{className:"w-4 h-4 shrink-0"})," ",o.jsx("span",{children:"Trending"})]}),o.jsxs("button",{onClick:()=>p("places"),className:`py-2 rounded px-1 text-xs sm:text-sm font-medium flex items-center justify-center gap-1 sm:gap-2 transition whitespace-nowrap overflow-hidden ${m==="places"?"bg-brand-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(Ve,{className:"w-4 h-4 shrink-0"})," ",o.jsx("span",{children:"Places"})]}),o.jsxs("button",{onClick:()=>p("polls"),className:`py-2 rounded px-1 text-xs sm:text-sm font-medium flex items-center justify-center gap-1 sm:gap-2 transition whitespace-nowrap overflow-hidden ${m==="polls"?"bg-brand-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(vu,{className:"w-4 h-4 shrink-0"})," ",o.jsx("span",{children:"Polls"})]})]})}),o.jsx("div",{className:"flex flex-col gap-2 mt-4 px-1",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[m==="inner-circle"&&o.jsx(en,{className:"w-5 h-5 text-amber-500 shrink-0"}),m==="trend"&&o.jsx(Xn,{className:"w-5 h-5 text-brand-400 shrink-0"}),m==="places"&&o.jsx(Ve,{className:"w-5 h-5 text-brand-400 shrink-0"}),m==="polls"&&o.jsx(vu,{className:"w-5 h-5 text-brand-400 shrink-0"}),m==="inner-circle"?"Inner Circle":m==="trend"?"Trending":m==="polls"?"Polls":"Places"]}),(m==="inner-circle"||m==="trend"||m==="polls")&&o.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-lg p-0.5 flex",children:[o.jsx("button",{onClick:()=>Cr("posted"),className:`px-2 py-1 text-[10px] font-bold rounded ${$t==="posted"?"bg-slate-700 text-white":"text-slate-500 hover:text-white"}`,children:"Shared on"}),o.jsx("button",{onClick:()=>Cr("visited"),className:`px-2 py-1 text-[10px] font-bold rounded ${$t==="visited"?"bg-slate-700 text-white":"text-slate-500 hover:text-white"}`,children:"Going on"})]})]}),o.jsxs("button",{onClick:()=>T(!0),className:"bg-brand-600 hover:bg-brand-700 px-4 py-2 rounded-lg font-medium transition text-sm flex items-center gap-2 whitespace-nowrap shadow-lg shadow-brand-600/20",children:[o.jsx(Za,{className:"w-4 h-4"}),"Share"]})]})}),m==="inner-circle"&&o.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 scrollbar-hide mb-2",children:Vl.map(G=>o.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center gap-2 group cursor-pointer",onClick:()=>e==null?void 0:e(G),children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:G.avatarUrl,className:`w-14 h-14 rounded-full border-2 ${G.isFounder?"border-amber-400":"border-slate-700"} object-cover`,alt:""}),G.isFounder&&o.jsx("div",{className:"absolute -bottom-1 -right-1 bg-amber-500 rounded-full p-1 border-2 border-slate-900",children:o.jsx(sd,{className:"w-2.5 h-2.5 text-white fill-white"})})]}),o.jsx("span",{className:`text-[10px] font-bold tracking-wider ${G.isFounder?"text-amber-400":"text-slate-400"}`,children:G.handle?`@${G.handle}`:G.displayName.split(" ")[0]})]},G.id))}),y&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-lg p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>T(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsx("h3",{className:"text-xl font-bold mb-4",children:"Share your plan or check-in"}),o.jsxs("div",{className:"flex bg-slate-950 rounded-lg p-1 mb-4",children:[o.jsx("button",{onClick:()=>Te("regular"),className:`flex - 1 py - 2 rounded text - sm font - bold transition ${je==="regular"?"bg-brand-600 text-white shadow":"text-slate-500 hover:text-white"} `,children:"Post"}),o.jsxs("button",{onClick:()=>Te("poll"),className:`flex - 1 py - 2 rounded text - sm font - bold transition flex items - center justify - center gap - 2 ${je==="poll"?"bg-brand-600 text-white shadow":"text-slate-500 hover:text-white"} `,children:[o.jsx("span",{className:"w-4 h-4 border border-current rounded-sm flex items-center justify-center text-[8px]",children:"In"})," Poll"]})]}),je==="regular"?o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-xl font-bold mb-4",children:Ge?"Edit Vibe":"Share your plan or check-in"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Current Vibe:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Ml.map(G=>o.jsx("button",{onClick:()=>M(Q===G?null:G),className:`px - 3 py - 1.5 rounded - full text - xs font - bold border transition
                            ${Q===G?"bg-brand-500 border-brand-500 text-white shadow-[0_0_15px_rgba(168,85,247,0.4)]":"bg-transparent border-slate-700 text-slate-400 hover:border-brand-500 hover:text-white"} `,children:G},G))})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"Where?"}),o.jsxs("div",{className:"flex items-center bg-slate-950 border border-slate-800 rounded-xl px-3",children:[o.jsx(Ve,{className:"text-slate-500 w-5 h-5 mr-2"}),o.jsx("input",{type:"text",placeholder:"e.g. Open Tap, Gurgaon",className:"w-full bg-transparent py-3 text-white focus:outline-none",value:j,onChange:Ll,disabled:!k})]}),I==="OK"&&o.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-slate-900 border border-brand-700 rounded-xl shadow-xl z-20 max-h-48 overflow-y-auto",children:ee.map(({place_id:G,description:Ee,structured_formatting:{main_text:Me,secondary_text:be}})=>o.jsxs("button",{onClick:()=>jr(Ee,Me,be,G),className:"w-full text-left px-4 py-2 hover:bg-brand-900/50 text-sm text-slate-200 border-b border-slate-800 last:border-0",children:[o.jsx("div",{className:"font-bold",children:Me}),o.jsx("div",{className:"text-xs text-slate-500 truncate",children:be})]},G))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"When?"}),o.jsxs("div",{className:"flex items-center bg-slate-950 border border-slate-800 rounded-xl px-3",children:[o.jsx(Yi,{className:"text-slate-500 w-5 h-5 mr-2"}),o.jsx("input",{type:"datetime-local",className:"w-full bg-transparent py-3 text-white focus:outline-none [color-scheme:dark]",value:ae,onChange:G=>O(G.target.value)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"What's the vibe?"}),o.jsx("textarea",{placeholder:"Describe your plan... use @ to tag friends and #hashtags",className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:outline-none h-24 resize-none",value:K,onChange:G=>te(G.target.value)})]}),o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"Add Photo"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{onClick:()=>{var G;return(G=lt.current)==null?void 0:G.click()},className:"flex-1 border-2 border-dashed border-slate-700 rounded-xl p-4 flex flex-col items-center justify-center cursor-pointer hover:border-brand-500 hover:bg-slate-900/50 transition relative overflow-hidden h-32",children:[B?o.jsx("img",{src:B,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover"}):o.jsxs(o.Fragment,{children:[o.jsx(VT,{className:"text-slate-500 w-8 h-8 mb-2"}),o.jsx("span",{className:"text-sm text-slate-500",children:"Upload"})]}),o.jsx("input",{type:"file",ref:lt,className:"hidden",accept:"image/*",onChange:vi})]}),o.jsxs("div",{className:"flex-1 md:hidden border-2 border-dashed border-slate-700 rounded-xl p-4 flex flex-col items-center justify-center cursor-pointer hover:border-brand-500 hover:bg-slate-900/50 transition h-32 relative",children:[o.jsx("input",{type:"file",accept:"image/*",capture:"environment",className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full",onChange:vi}),o.jsx(Za,{className:"text-slate-500 w-8 h-8 mb-2"}),o.jsx("span",{className:"text-sm text-slate-500",children:"Camera"})]})]})]})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-xl font-bold mb-4",children:"Create a Poll"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"Question"}),o.jsx("input",{type:"text",placeholder:"e.g. Where should we go tonight?",value:se,onChange:G=>q(G.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:outline-none focus:border-brand-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"Options"}),o.jsxs("div",{className:"space-y-2",children:[ie.map((G,Ee)=>o.jsx("input",{type:"text",placeholder:`Option ${Ee+1} `,value:G,onChange:Me=>{const be=[...ie];be[Ee]=Me.target.value,we(be)},className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-2 text-white focus:outline-none focus:border-brand-500"},Ee)),ie.length<4&&o.jsxs("button",{onClick:()=>we([...ie,""]),className:"text-brand-400 text-sm hover:underline flex items-center gap-1",children:[o.jsx(pr,{className:"w-4 h-4"})," Add Option"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-1",children:"Duration"}),o.jsx("div",{className:"flex gap-2",children:["1h","6h","24h"].map(G=>o.jsx("button",{onClick:()=>Oe(G),className:`px - 3 py - 1 rounded - lg text - sm border ${pe===G?"bg-brand-600 border-brand-600 text-white":"border-slate-700 text-slate-400"} `,children:G},G))})]})]}),o.jsxs("button",{onClick:async()=>{x(!0),await zo(),x(!1)},disabled:N||(je==="regular"?!j||!ae||!K:!se||ie.length<2),className:"w-full bg-brand-600 hover:bg-brand-500 py-3 rounded-xl font-bold text-white shadow-lg shadow-brand-600/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[N?o.jsx(jo,{className:"w-5 h-5 animate-spin"}):o.jsx(dp,{className:"w-5 h-5"}),N?"Posting...":"Post Update"]})]})}),Ol.length===0&&o.jsxs("div",{className:"text-center py-20 px-6",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-800 mb-4 animate-bounce",children:o.jsx(Xn,{className:"w-8 h-8 text-slate-500"})}),o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No vibes here yet!"}),o.jsx("p",{className:"text-slate-400 max-w-xs mx-auto mb-6",children:"It looks a bit quiet. Be the first to start the party or try searching for something else."}),o.jsx("button",{onClick:()=>T(!0),className:"bg-brand-600 hover:bg-brand-500 px-6 py-3 rounded-xl font-bold text-white transition shadow-lg shadow-brand-600/20",children:"Start the Vibe"})]}),Ol.map((G,Ee)=>{var Me,be;return o.jsxs(ml.Fragment,{children:[Ee===1&&o.jsx(J3,{onPlaceClick:t,followedPlaces:s,onToggleFollow:i,hotSpots:S}),o.jsx(wg,{post:G,onUpdatePost:u,onDeletePost:d,onUserClick:e,onPlaceClick:t,isPlaceFollowed:(Me=n==null?void 0:n.followedPlaces)==null?void 0:Me.includes(G.location.name),onToggleFollow:()=>i(G.location.name),onRequestEdit:cs,isUserFollowed:(be=n==null?void 0:n.following)==null?void 0:be.includes(G.user.id),onToggleUserFollow:()=>a(G.user.id),currentUser:n},G.id)]},G.id)})]})},sE=({onBack:t})=>o.jsxs("div",{className:"relative h-[calc(100vh-80px)] md:h-screen w-full overflow-hidden flex items-center justify-center p-4",children:[t&&o.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-50 bg-slate-950/80 backdrop-blur-md p-3 rounded-full text-white border border-white/20 hover:bg-white/20 transition shadow-2xl",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("div",{className:"absolute inset-0 z-0",children:[o.jsx("img",{src:"/Vibe_Origin.jpeg?v=1",alt:"Roots Vibe",className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/20 to-transparent"})]}),o.jsx("div",{className:"relative z-10 w-full max-w-lg animate-fade-in-up",children:o.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/10 rounded-[2.5rem] p-6 shadow-2xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute -top-20 -right-20 w-64 h-64 bg-amber-500/20 rounded-full blur-[80px]"}),o.jsx("div",{className:"absolute -bottom-20 -left-20 w-64 h-64 bg-purple-500/20 rounded-full blur-[80px]"}),o.jsxs("div",{className:"flex justify-between items-start mb-6 relative",children:[o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:"https://ui-avatars.com/api/?name=Chief+Viber&background=000&color=fff",className:"w-16 h-16 rounded-full border-2 border-amber-500 shadow-xl object-cover",alt:"Chief Viber"}),o.jsx("div",{className:"absolute -bottom-1 -right-1 bg-amber-500 rounded-full p-1 border-2 border-slate-900",children:o.jsx(en,{className:"w-3 h-3 text-black fill-black"})})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black italic tracking-tighter text-amber-500",children:"ChiefViber"}),o.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold text-slate-400 uppercase tracking-widest mt-1",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Z3,{className:"w-3 h-3"})," 250,000"]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Ve,{className:"w-3 h-3"})," 0.1KM"]})]})]})]}),o.jsxs("button",{className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-2.5 rounded-xl font-black text-xs uppercase tracking-widest transition shadow-lg hover:shadow-amber-500/20 flex items-center gap-2",children:[o.jsx(eD,{className:"w-4 h-4"})," Join Tribe"]})]}),o.jsxs("div",{className:"relative rounded-3xl overflow-hidden mb-6 aspect-video group cursor-pointer",children:[o.jsx("img",{src:"/Vibe_Origin.jpeg?v=1",alt:"Chief Viber",className:"w-full h-full object-cover transition duration-700 group-hover:scale-110"}),o.jsxs("div",{className:"absolute top-4 left-4 bg-amber-500 text-black text-[10px] font-black uppercase px-3 py-1.5 rounded-full flex items-center gap-1.5 shadow-lg",children:[o.jsx(sd,{className:"w-3 h-3 fill-black"})," Official Vibe"]}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition duration-500"})]}),o.jsx("div",{className:"space-y-4 mb-6 relative",children:o.jsx("div",{className:"pl-4 border-l-4 border-purple-500",children:o.jsx("p",{className:"text-lg font-medium text-slate-200 italic leading-relaxed",children:'"The night it all clicked. Vibes locked, moments made, memories lived. This is just the beginningnext drop incoming. "'})})}),o.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-4",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("button",{className:"flex items-center gap-2 text-pink-500 font-bold text-sm tracking-wide hover:text-pink-400 transition",children:[o.jsx(tD,{className:"w-5 h-5 fill-current"})," 42,080"]}),o.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-bold text-slate-400 uppercase tracking-widest",children:[o.jsx(Ve,{className:"w-4 h-4 text-purple-500"})," Vibe HQ Lab"]})]}),o.jsx("button",{className:"p-3 rounded-full bg-slate-800/50 hover:bg-slate-700 text-slate-300 transition backdrop-blur-md",children:o.jsx(Xi,{className:"w-5 h-5"})})]})]})})]}),Z3=({className:t})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),o.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),eD=({className:t})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),o.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]}),tD=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:o.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),nD=t=>{let e=0;return t.id&&(e+=50),t.bio&&t.bio.length>10&&(e+=20),t.avatarUrl&&!t.avatarUrl.includes("ui-avatars")&&(e+=10),t.isConnected&&(e+=10),t.isInfluencer&&(e+=20),Math.min(e,100)},Dl="admin_privileges",mm="cagautam86@gmail.com",rE=async t=>{var e;if(!t)return null;if(((e=Ye.currentUser)==null?void 0:e.email)===mm)return{uid:t,email:mm,assignedBy:"system",assignedAt:new Date().toISOString(),roles:["SUPER_ADMIN"]};try{const n=He(le,Dl,t),s=await Uo(n);if(s.exists())return s.data()}catch(n){console.error("Error checking admin status:",n)}return null},sD=async(t,e)=>{const n=Ye.currentUser;if(!n)throw new Error("Not authenticated");const s=await rE(n.uid);if(!(n.email===mm||(s==null?void 0:s.roles.includes("SUPER_ADMIN"))))throw new Error("Insufficient permissions: Super Admin required.");const i=Pe(le,"users");let a;const c=t.startsWith("@"),u=t.replace("@","");if(c)a=tt(i,dt("handle","==",u));else if(t.includes("@"))a=tt(i,dt("email","==",t));else{const m=He(le,"users",t),p=await Uo(m);if(p.exists()){const y=p.data();return await Eo(He(le,Dl,t),{uid:t,email:y.email||"no-email",assignedBy:n.uid,assignedAt:new Date().toISOString(),roles:e}),{uid:t,roles:e}}a=tt(i,dt("handle","==",t))}const d=await ht(a);if(d.empty){if(c||!t.includes("@")){const m=u,p=[m.toLowerCase(),m.charAt(0).toUpperCase()+m.slice(1).toLowerCase(),m.toUpperCase()];for(const y of p){if(y===m)continue;const T=tt(i,dt("handle","==",y)),C=await ht(T);if(!C.empty)return await Rv(C.docs[0],e,n.uid)}}throw new Error(`User not found with this identifier: ${t}. Try searching by Email or User ID.`)}const f=d.docs[0];return await Rv(f,e,n.uid)},Rv=async(t,e,n)=>{const s=t.data(),r={uid:t.id,email:s.email||"unknown",assignedBy:n,assignedAt:new Date().toISOString(),roles:e};return await Eo(He(le,Dl,t.id),r),r},rD=async()=>{try{const t=tt(Pe(le,Dl));return(await ht(t)).docs.map(n=>n.data())}catch(t){return console.error("Failed to fetch admins",t),[]}},iD=async(t,e)=>{const n=He(le,Dl,t);await hn(n,{roles:e})},oD=async(t,e)=>{const n=He(le,"users",t);await hn(n,{isInfluencer:e})},bg=async()=>{try{const t=tt(Pe(le,"reports"),dt("status","==","pending"));return(await ht(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error fetching reports:",t),[]}},_g=async(t,e)=>{const n=He(le,"reports",t);await hn(n,{status:"reviewed",resolution:e,resolvedAt:new Date().toISOString()})},aD=async()=>{try{const t=tt(Pe(le,"outlet_applications"));return(await ht(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error fetching applications:",t),[]}},lD=async(t,e)=>{const n=He(le,"outlet_applications",t);await hn(n,{status:e})},iE=()=>{const[t,e]=A.useState(null),[n,s]=A.useState(!0);A.useEffect(()=>{const i=z5(Ye,async a=>{if(a)try{const c=await rE(a.uid);e(c)}catch(c){console.error("Failed to check admin status",c),e(null)}else e(null);s(!1)});return()=>i()},[]);const r=i=>t?t.roles.includes("SUPER_ADMIN")?!0:t.roles.includes(i):!1;return{adminPrivileges:t,isAdminLoading:n,hasRole:r,isSuperAdmin:r("SUPER_ADMIN")}},bc=43200,Pv=1440,Dv=Symbol.for("constructDateFrom");function Ng(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Dv in t?t[Dv](e):t instanceof Date?new t.constructor(e):new Date(e)}function Nr(t,e){return Ng(t,t)}let cD={};function uD(){return cD}function Mv(t){const e=Nr(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Eg(t,...e){const n=Ng.bind(null,t||e.find(s=>typeof s=="object"));return e.map(n)}function Gc(t,e){const n=+Nr(t)-+Nr(e);return n<0?-1:n>0?1:n}function dD(t){return Ng(t,Date.now())}function hD(t,e,n){const[s,r]=Eg(n==null?void 0:n.in,t,e),i=s.getFullYear()-r.getFullYear(),a=s.getMonth()-r.getMonth();return i*12+a}function fD(t){return e=>{const s=(t?Math[t]:Math.trunc)(e);return s===0?0:s}}function mD(t,e){return+Nr(t)-+Nr(e)}function pD(t,e){const n=Nr(t);return n.setHours(23,59,59,999),n}function gD(t,e){const n=Nr(t),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}function xD(t,e){const n=Nr(t);return+pD(n)==+gD(n)}function yD(t,e,n){const[s,r,i]=Eg(n==null?void 0:n.in,t,t,e),a=Gc(r,i),c=Math.abs(hD(r,i));if(c<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*c);let u=Gc(r,i)===-a;xD(s)&&c===1&&Gc(s,i)===1&&(u=!1);const d=a*(c-+u);return d===0?0:d}function vD(t,e,n){const s=mD(t,e)/1e3;return fD(n==null?void 0:n.roundingMethod)(s)}const wD={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bD=(t,e,n)=>{let s;const r=wD[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Fh(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const _D={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ND={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ED={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ID={date:Fh({formats:_D,defaultWidth:"full"}),time:Fh({formats:ND,defaultWidth:"full"}),dateTime:Fh({formats:ED,defaultWidth:"full"})},TD={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},SD=(t,e,n,s)=>TD[t];function la(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,c=n!=null&&n.width?String(n.width):a;r=t.formattingValues[c]||t.formattingValues[a]}else{const a=t.defaultWidth,c=n!=null&&n.width?String(n.width):t.defaultWidth;r=t.values[c]||t.values[a]}const i=t.argumentCallback?t.argumentCallback(e):e;return r[i]}}const kD={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},CD={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},jD={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},RD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},PD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},DD=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},MD={ordinalNumber:DD,era:la({values:kD,defaultWidth:"wide"}),quarter:la({values:CD,defaultWidth:"wide",argumentCallback:t=>t-1}),month:la({values:AD,defaultWidth:"wide"}),day:la({values:jD,defaultWidth:"wide"}),dayPeriod:la({values:RD,defaultWidth:"wide",formattingValues:PD,defaultFormattingWidth:"wide"})};function ca(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(r);if(!i)return null;const a=i[0],c=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(c)?VD(c,m=>m.test(a)):OD(c,m=>m.test(a));let d;d=t.valueCallback?t.valueCallback(u):u,d=n.valueCallback?n.valueCallback(d):d;const f=e.slice(a.length);return{value:d,rest:f}}}function OD(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function VD(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function LD(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],i=e.match(t.parsePattern);if(!i)return null;let a=t.valueCallback?t.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const c=e.slice(r.length);return{value:a,rest:c}}}const FD=/^(\d+)(th|st|nd|rd)?/i,UD=/\d+/i,$D={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},zD={any:[/^b/i,/^(a|c)/i]},BD={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qD={any:[/1/i,/2/i,/3/i,/4/i]},HD={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},GD={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},WD={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},KD={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},QD={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},YD={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},XD={ordinalNumber:LD({matchPattern:FD,parsePattern:UD,valueCallback:t=>parseInt(t,10)}),era:ca({matchPatterns:$D,defaultMatchWidth:"wide",parsePatterns:zD,defaultParseWidth:"any"}),quarter:ca({matchPatterns:BD,defaultMatchWidth:"wide",parsePatterns:qD,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ca({matchPatterns:HD,defaultMatchWidth:"wide",parsePatterns:GD,defaultParseWidth:"any"}),day:ca({matchPatterns:WD,defaultMatchWidth:"wide",parsePatterns:KD,defaultParseWidth:"any"}),dayPeriod:ca({matchPatterns:QD,defaultMatchWidth:"any",parsePatterns:YD,defaultParseWidth:"any"})},JD={code:"en-US",formatDistance:bD,formatLong:ID,formatRelative:SD,localize:MD,match:XD,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ZD(t,e,n){const s=uD(),r=(n==null?void 0:n.locale)??s.locale??JD,i=2520,a=Gc(t,e);if(isNaN(a))throw new RangeError("Invalid time value");const c=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[u,d]=Eg(n==null?void 0:n.in,...a>0?[e,t]:[t,e]),f=vD(d,u),m=(Mv(d)-Mv(u))/1e3,p=Math.round((f-m)/60);let y;if(p<2)return n!=null&&n.includeSeconds?f<5?r.formatDistance("lessThanXSeconds",5,c):f<10?r.formatDistance("lessThanXSeconds",10,c):f<20?r.formatDistance("lessThanXSeconds",20,c):f<40?r.formatDistance("halfAMinute",0,c):f<60?r.formatDistance("lessThanXMinutes",1,c):r.formatDistance("xMinutes",1,c):p===0?r.formatDistance("lessThanXMinutes",1,c):r.formatDistance("xMinutes",p,c);if(p<45)return r.formatDistance("xMinutes",p,c);if(p<90)return r.formatDistance("aboutXHours",1,c);if(p<Pv){const T=Math.round(p/60);return r.formatDistance("aboutXHours",T,c)}else{if(p<i)return r.formatDistance("xDays",1,c);if(p<bc){const T=Math.round(p/Pv);return r.formatDistance("xDays",T,c)}else if(p<bc*2)return y=Math.round(p/bc),r.formatDistance("aboutXMonths",y,c)}if(y=yD(d,u),y<12){const T=Math.round(p/bc);return r.formatDistance("xMonths",T,c)}else{const T=y%12,C=Math.trunc(y/12);return T<3?r.formatDistance("aboutXYears",C,c):T<9?r.formatDistance("overXYears",C,c):r.formatDistance("almostXYears",C+1,c)}}function ci(t,e){return ZD(t,dD(t),e)}const eM=({onSelect:t})=>{const{ready:e,value:n,setValue:s,suggestions:{status:r,data:i},clearSuggestions:a}=ho({requestOptions:{},debounce:300}),c=async u=>{s(u,!1),a();try{const d=await Qb({address:u}),{lat:f,lng:m}=await Yb(d[0]);t(u,f,m)}catch(d){console.error("Error: ",d)}};return o.jsxs("div",{className:"relative w-full",children:[o.jsx("input",{value:n,onChange:u=>s(u.target.value),disabled:!e,className:"w-full bg-black/40 border border-white/20 rounded-xl px-4 py-2 text-white placeholder-slate-500 focus:outline-none focus:border-brand-500",placeholder:"Search places..."}),r==="OK"&&o.jsx("ul",{className:"absolute z-50 w-full bg-slate-900 border border-slate-700 rounded-xl mt-1 overflow-hidden shadow-xl max-h-60 overflow-y-auto",children:i.map(({place_id:u,description:d})=>o.jsx("li",{onClick:()=>c(d),className:"px-4 py-3 hover:bg-slate-800 cursor-pointer text-sm text-slate-300 border-b border-slate-800/50 last:border-0",children:d},u))})]})},tM=({onClose:t})=>{const{adminPrivileges:e,isSuperAdmin:n,hasRole:s}=iE(),[r,i]=A.useState("users"),[a,c]=A.useState(""),[u,d]=A.useState([]),[f,m]=A.useState([]),[p,y]=A.useState(!1),[T,C]=A.useState(!1),[P,b]=A.useState("");A.useEffect(()=>{r==="users"&&n&&E()},[r,n]);const E=async()=>{C(!0);const x=await rD();m(x),C(!1)},S=x=>{u.includes(x)?d(v=>v.filter(_=>_!==x)):d(v=>[...v,x])},R=async()=>{if(n){if(u.length===0){b("Error: Please select at least one role.");return}y(!0),b("");try{await sD(a,u),b("Success! Privileges updated."),c(""),d([]),E()}catch(x){b(`Error: ${x.message}`)}y(!1)}},L=async(x,v,_)=>{if(confirm("Are you sure you want to remove this role?"))try{const k=_.filter(j=>j!==v);await iD(x,k),E()}catch{alert("Failed to update roles")}},U=["INFLUENCER_MANAGER","OUTLET_ONBOARDING","SAFETY_MANAGER","POST_MODERATOR","COMMENT_MODERATOR"];if(!e)return null;const N=()=>{switch(r){case"users":return o.jsx(Ov,{isSuperAdmin:n,targetEmail:a,setTargetEmail:c,selectedRoles:u,handleToggleRoleSelection:S,isGranting:p,handleGrantRole:R,message:P,isLoadingList:T,existingAdmins:f,handleRevokeRole:L,AVAILABLE_ROLES:U});case"influencers":return o.jsx(nM,{});case"safety":return o.jsx(sM,{});case"onboarding":return o.jsx(rM,{});case"posts":return o.jsx(iM,{});case"comments":return o.jsx(oM,{});default:return o.jsx(Ov,{isSuperAdmin:n,targetEmail:a,setTargetEmail:c,selectedRoles:u,handleToggleRoleSelection:S,isGranting:p,handleGrantRole:R,message:P,isLoadingList:T,existingAdmins:f,handleRevokeRole:L,AVAILABLE_ROLES:U})}};return o.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-950 flex flex-col animate-fade-in",children:[o.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-brand-900/50 backdrop-blur-md",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-amber-500/20 p-2 rounded-lg",children:o.jsx(tn,{className:"w-6 h-6 text-amber-500"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:"Admin Command"}),o.jsx("span",{className:"text-xs text-slate-400 font-mono uppercase tracking-widest hidden sm:inline-block",children:e.roles.join("  ")})]})]}),o.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-full transition",children:o.jsx($e,{className:"w-6 h-6 text-slate-300"})})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsxs("div",{className:"w-20 md:w-64 border-r border-white/10 bg-black/20 p-4 space-y-2 flex flex-col items-center md:items-stretch",children:[o.jsxs("button",{onClick:()=>i("users"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="users"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"User Management",children:[o.jsx(Xt,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"User Management"})]}),(s("INFLUENCER_MANAGER")||n)&&o.jsxs("button",{onClick:()=>i("influencers"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="influencers"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"Influencer Manager",children:[o.jsx(en,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"Influencers"})]}),(s("SAFETY_MANAGER")||n)&&o.jsxs("button",{onClick:()=>i("safety"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="safety"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"Safety Center",children:[o.jsx(fo,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"Safety Center"})]}),(s("OUTLET_ONBOARDING")||n)&&o.jsxs("button",{onClick:()=>i("onboarding"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="onboarding"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"Outlet Onboarding",children:[o.jsx(Ve,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"Onboarding"})]}),(s("POST_MODERATOR")||n)&&o.jsxs("button",{onClick:()=>i("posts"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="posts"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"Post Moderation",children:[o.jsx(cp,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"Post Mod"})]}),(s("COMMENT_MODERATOR")||n)&&o.jsxs("button",{onClick:()=>i("comments"),className:`w-full flex items-center gap-3 p-3 rounded-xl transition ${r==="comments"?"bg-brand-600 text-white":"text-slate-400 hover:bg-white/5"}`,title:"Comment Moderation",children:[o.jsx(vu,{className:"w-5 h-5 flex-shrink-0"})," ",o.jsx("span",{className:"hidden md:block",children:"Comment Mod"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 bg-black/40",children:N()})]})]})},Ov=({isSuperAdmin:t,targetEmail:e,setTargetEmail:n,selectedRoles:s,handleToggleRoleSelection:r,isGranting:i,handleGrantRole:a,message:c,isLoadingList:u,existingAdmins:d,handleRevokeRole:f,AVAILABLE_ROLES:m})=>o.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[t&&o.jsxs("div",{className:"bg-slate-900/80 border border-brand-500/30 rounded-2xl p-6 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:o.jsx(tn,{className:"w-32 h-32 text-brand-500"})}),o.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[o.jsx(pr,{className:"w-5 h-5 text-brand-400"})," Grant Privileges"]}),o.jsx("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:o.jsx("input",{type:"text",placeholder:"Enter user email or handle (@user)...",value:e,onChange:p=>n(p.target.value),className:"flex-1 bg-black/40 border border-white/20 rounded-xl px-4 py-3 text-white focus:border-brand-500 outline-none placeholder:text-slate-600"})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:m.map(p=>o.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition ${s.includes(p)?"bg-brand-500/20 border-brand-500":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:[o.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${s.includes(p)?"bg-brand-500 border-brand-500":"border-slate-500"}`,children:s.includes(p)&&o.jsx(Ao,{className:"w-3 h-3 text-black"})}),o.jsx("span",{className:"text-xs font-mono font-bold text-slate-300",children:p.replace("_"," ")}),o.jsx("input",{type:"checkbox",className:"hidden",checked:s.includes(p),onChange:()=>r(p)})]},p))}),o.jsx("button",{onClick:a,disabled:i||!e||s.length===0,className:"bg-brand-600 hover:bg-brand-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold px-8 py-3 rounded-xl transition flex items-center justify-center gap-2 w-full md:w-auto",children:i?"Processing...":"Grant Selected Roles"}),c&&o.jsx("div",{className:`mt-4 p-3 rounded-lg text-sm font-medium animate-fade-in ${c.startsWith("Success")?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:c})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})," Active Administrators"]}),u?o.jsx("div",{className:"text-slate-500 italic",children:"Loading personnel..."}):o.jsxs("div",{className:"grid gap-4",children:[d.map(p=>o.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-xl p-4 flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-brand-500 rounded-full flex items-center justify-center text-white font-bold",children:p.email[0].toUpperCase()}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-bold text-white",children:p.email}),o.jsxs("p",{className:"text-xs text-slate-500",children:["Assigned ",ci(new Date(p.assignedAt),{addSuffix:!0})]})]})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:p.roles.map(y=>o.jsxs("span",{className:"flex items-center gap-1 bg-slate-800 text-slate-300 text-[10px] px-2 py-1 rounded-lg border border-slate-700",children:[y.replace("_"," "),t&&y!=="SUPER_ADMIN"&&o.jsx("button",{onClick:()=>f(p.uid,y,p.roles),className:"hover:text-red-400 ml-1",children:o.jsx($e,{className:"w-3 h-3"})})]},y))})]},p.uid)),d.length===0&&o.jsx("div",{className:"text-slate-500 text-sm p-4 text-center border border-dashed border-slate-800 rounded-xl",children:"No other administrators found."})]})]})]}),nM=()=>{const[t,e]=A.useState(""),[n,s]=A.useState([]),[r,i]=A.useState(!1);A.useEffect(()=>{(async()=>{i(!0);const d=tt(Pe(le,"users"),dt("isInfluencer","==",!0)),m=(await ht(d)).docs.map(p=>({id:p.id,...p.data()}));s(m),i(!1)})()},[]);const a=async()=>{if(t){i(!0);try{const u=Pe(le,"users"),d=await ht(u),f=t.toLowerCase().replace("@","").trim(),m=d.docs.map(y=>({id:y.id,...y.data()}));console.log(`Admin Search: Scanned ${m.length} users.`);const p=m.filter(y=>y.handle&&y.handle.toLowerCase().includes(f)||y.displayName&&y.displayName.toLowerCase().includes(f)||y.email&&y.email.toLowerCase().includes(f)||y.id&&y.id.toLowerCase().includes(f));p.length===0&&console.log("No matches found. Sample handles:",m.slice(0,5).map(y=>y.handle)),s(p)}catch(u){console.error(u)}i(!1)}},c=async(u,d)=>{await oD(u,!d),s(f=>f.map(m=>m.id===u?{...m,isInfluencer:!d}:m))};return o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("h3",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[o.jsx(en,{className:"w-6 h-6 text-brand-400"})," Influencer Management"]}),o.jsxs("div",{className:"bg-slate-900/50 border border-white/10 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(ti,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Search by handle, name, email or ID...",value:t,onChange:u=>e(u.target.value),onKeyDown:u=>u.key==="Enter"&&a(),className:"w-full bg-black/40 border border-white/10 rounded-xl pl-10 pr-4 py-3 text-white focus:outline-none focus:border-brand-500 transition"})]}),o.jsx("button",{onClick:a,disabled:r,className:"bg-brand-600 hover:bg-brand-500 text-white px-6 rounded-xl font-bold transition disabled:opacity-50",children:r?o.jsx(jo,{className:"w-5 h-5 animate-spin"}):"Search"})]}),n.length>0&&o.jsxs("div",{className:"text-xs text-slate-500 mb-4 px-1",children:["Found ",n.length," matches"]}),o.jsxs("div",{className:"space-y-4",children:[n.map(u=>o.jsxs("div",{className:"bg-slate-800/50 p-4 rounded-xl flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("img",{src:u.avatarUrl,className:"w-10 h-10 rounded-full",alt:""}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-white",children:u.displayName}),o.jsxs("div",{className:"text-xs text-slate-500",children:["@",u.handle]})]})]}),o.jsx("button",{onClick:()=>c(u.id,u.isInfluencer),className:`px-4 py-2 rounded-lg text-xs font-bold transition ${u.isInfluencer?"bg-amber-500 text-black":"bg-slate-700 text-slate-300"}`,children:u.isInfluencer?"Active Influencer":"Promote to Influencer"})]},u.id)),n.length===0&&!r&&o.jsx("div",{className:"text-slate-500 text-center",children:"Search for a user to manage their status"})]})]})]})},sM=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!1);A.useEffect(()=>{r()},[]);const r=async()=>{s(!0);const a=await bg();e(a),s(!1)},i=async(a,c)=>{await _g(a,c),e(u=>u.filter(d=>d.id!==a))};return o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("h3",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[o.jsx(fo,{className:"w-6 h-6 text-brand-400"})," Safety Operations"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-slate-900/50 border border-white/10 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h4",{className:"font-bold text-white",children:"Live Reports"}),t.length>0&&o.jsxs("span",{className:"bg-red-500/20 text-red-400 text-xs px-2 py-1 rounded-full font-bold",children:[t.length," New"]})]}),n?o.jsx("div",{className:"text-slate-500 p-4",children:"Loading reports..."}):o.jsxs("div",{className:"space-y-4",children:[t.map(a=>o.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex gap-3",children:[o.jsx("div",{className:"w-2 h-full bg-red-500 rounded-full"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-xs font-bold text-red-400 capitalize",children:a.type}),o.jsx("span",{className:"text-[10px] text-slate-500",children:ci(new Date(a.timestamp),{addSuffix:!0})})]}),o.jsx("p",{className:"text-sm text-slate-300 mt-1 line-clamp-2",children:a.reason}),o.jsxs("div",{className:"flex gap-2 mt-2",children:[o.jsx("button",{onClick:()=>i(a.id,"ban_user"),className:"text-xs bg-red-900/40 hover:bg-red-900/60 text-red-200 px-3 py-1 rounded-lg",children:"Ban User"}),o.jsx("button",{onClick:()=>i(a.id,"dismiss"),className:"text-xs bg-slate-800 hover:bg-slate-700 px-3 py-1 rounded-lg text-white",children:"Dismiss"})]})]})]},a.id)),t.length===0&&o.jsx("div",{className:"text-center py-8 text-slate-500",children:o.jsx("p",{children:"All clear. No pending reports."})})]})]}),o.jsxs("div",{className:"bg-slate-900/50 border border-white/10 rounded-2xl p-6",children:[o.jsx("h4",{className:"font-bold text-white mb-4",children:"Banned Users"}),o.jsxs("div",{className:"text-center py-8 text-slate-500",children:[o.jsx(Ao,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),o.jsx("p",{children:"No active bans"})]})]})]})]})},rM=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!1),[r,i]=A.useState(!1),[a,c]=A.useState(""),[u,d]=A.useState(""),[f,m]=A.useState(""),[p,y]=A.useState(null);A.useEffect(()=>{T()},[]);const T=async()=>{s(!0);const b=await aD();e(b),s(!1)},C=async(b,E)=>{await lD(b,E),e(E==="approved"?S=>S.map(R=>R.id===b?{...R,status:"approved"}:R):S=>S.filter(R=>R.id!==b))},P=async()=>{if(!(!a||!u))try{await Ts(Pe(le,"outlet_applications"),{name:a,address:u,description:f||"Manual Entry",submitterEmail:"admin@manual",timestamp:new Date().toISOString(),status:"approved",coordinates:p||{lat:0,lng:0}}),alert("Outlet manually added and approved."),i(!1),c(""),d(""),m(""),y(null),T()}catch(b){console.error("Manual Add Failed:",b),alert(`Failed to manual add: ${(b==null?void 0:b.message)||"Unknown error"}`)}};return o.jsxs("div",{className:"max-w-4xl mx-auto relative",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h3",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[o.jsx(Ve,{className:"w-6 h-6 text-brand-400"})," Outlet Applications"]}),o.jsxs("button",{onClick:()=>i(!0),className:"bg-brand-600 hover:bg-brand-500 text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2",children:[o.jsx(pr,{className:"w-4 h-4"})," Manual Onboard"]})]}),n?o.jsx("div",{className:"text-slate-500 text-center p-8",children:"Loading applications..."}):o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold text-white mb-4 border-b border-white/10 pb-2",children:"Pending Review"}),o.jsxs("div",{className:"grid gap-4",children:[t.filter(b=>b.status==="pending").map(b=>o.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-2xl p-6 flex flex-col md:flex-row items-center justify-between gap-6 group hover:border-brand-500/50 transition",children:[o.jsxs("div",{className:"flex items-center gap-6 w-full md:w-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-2xl flex items-center justify-center shrink-0",children:o.jsx(Ve,{className:"w-8 h-8 text-slate-500 group-hover:text-amber-400 transition"})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-lg font-bold text-white",children:b.name}),o.jsx("span",{className:"bg-amber-500/20 text-amber-500 text-[10px] px-2 py-0.5 rounded-full uppercase font-bold tracking-wider",children:"Pending"})]}),o.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:[b.address,"  ",b.description]}),o.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Submitted by ",b.submitterEmail,"  ",ci(new Date(b.timestamp),{addSuffix:!0})]})]})]}),o.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[o.jsx("button",{onClick:()=>C(b.id,"approved"),className:"flex-1 md:flex-none px-6 py-3 bg-green-500/10 text-green-400 border border-green-500/20 rounded-xl hover:bg-green-500/20 font-bold text-sm transition",children:"Approve"}),o.jsx("button",{onClick:()=>C(b.id,"rejected"),className:"flex-1 md:flex-none px-6 py-3 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl hover:bg-red-500/20 font-bold text-sm transition",children:"Reject"})]})]},b.id)),t.filter(b=>b.status==="pending").length===0&&o.jsx("div",{className:"text-center py-6 text-slate-500 border border-dashed border-slate-800 rounded-2xl bg-slate-900/50",children:o.jsx("p",{children:"No pending applications."})})]})]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"text-lg font-bold text-white mb-4 border-b border-white/10 pb-2 flex items-center gap-2",children:["Approved Outlets ",o.jsx("span",{className:"bg-green-500/20 text-green-400 text-xs px-2 py-0.5 rounded-full",children:t.filter(b=>b.status==="approved").length})]}),o.jsxs("div",{className:"grid gap-4",children:[t.filter(b=>b.status==="approved").map(b=>o.jsx("div",{className:"bg-slate-900 border border-green-500/10 rounded-2xl p-6 flex flex-col md:flex-row items-center justify-between gap-6 opacity-75 hover:opacity-100 transition",children:o.jsxs("div",{className:"flex items-center gap-6 w-full md:w-auto",children:[o.jsx("div",{className:"w-16 h-16 bg-slate-800 rounded-2xl flex items-center justify-center shrink-0",children:o.jsx(Ve,{className:"w-8 h-8 text-green-500"})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-lg font-bold text-white",children:b.name}),o.jsx("span",{className:"bg-green-500/20 text-green-500 text-[10px] px-2 py-0.5 rounded-full uppercase font-bold tracking-wider",children:"Active"})]}),o.jsx("p",{className:"text-sm text-slate-400 mt-1",children:b.address}),o.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Added ",ci(new Date(b.timestamp),{addSuffix:!0})]})]})]})},b.id)),t.filter(b=>b.status==="approved").length===0&&o.jsx("div",{className:"text-center py-6 text-slate-500 border border-dashed border-slate-800 rounded-2xl bg-slate-900/50",children:o.jsx("p",{children:"No approved outlets yet."})})]})]})]}),r&&o.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-2xl w-full max-w-md p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>i(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Manual Outlet Onboarding"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block mb-1",children:"Outlet Name"}),o.jsx("input",{value:a,onChange:b=>c(b.target.value),className:"w-full bg-black/40 border border-white/20 rounded-xl px-4 py-2 text-white",placeholder:"e.g. The Vibe Bar"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block mb-1",children:"Location Search"}),o.jsx(eM,{onSelect:(b,E,S)=>{d(b),a||c(b.split(",")[0]),y({lat:E,lng:S})}})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block mb-1",children:"Selected Address"}),o.jsx("input",{value:u,onChange:b=>d(b.target.value),className:"w-full bg-black/40 border border-brand-500/50 rounded-xl px-4 py-2 text-white",placeholder:"Address from search..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block mb-1",children:"Description"}),o.jsx("input",{value:f,onChange:b=>m(b.target.value),className:"w-full bg-black/40 border border-white/20 rounded-xl px-4 py-2 text-white",placeholder:"Category, vibe, etc."})]}),o.jsx("button",{onClick:P,disabled:!a||!u,className:"w-full bg-brand-600 hover:bg-brand-500 text-white font-bold py-3 rounded-xl mt-2 disabled:opacity-50",children:"Create & Approve"})]})]})})]})},iM=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!1);A.useEffect(()=>{r()},[]);const r=async()=>{s(!0);const a=await bg();e(a.filter(c=>c.type==="post")),s(!1)},i=async(a,c)=>{await _g(a,c),e(u=>u.filter(d=>d.id!==a))};return o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("h3",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[o.jsx(cp,{className:"w-6 h-6 text-brand-400"})," Post Moderation Queue"]}),n?o.jsx("div",{className:"text-slate-500",children:"Loading..."}):o.jsxs("div",{className:"space-y-4",children:[t.map(a=>{var c;return o.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-xl p-4",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("span",{className:"bg-red-500/20 text-red-400 text-xs px-2 py-1 rounded font-bold uppercase",children:a.reason}),o.jsx("span",{className:"text-slate-500 text-xs",children:ci(new Date(a.timestamp),{addSuffix:!0})})]}),o.jsx("div",{className:"bg-black/30 p-3 rounded-lg mb-4 text-slate-300 text-sm",children:((c=a.details)==null?void 0:c.text)||"Content snippet unavailable"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>i(a.id,"dismiss"),className:"text-xs bg-slate-800 hover:bg-slate-700 px-3 py-2 rounded-lg text-white",children:"Mark Safe"}),o.jsx("button",{onClick:()=>i(a.id,"delete_content"),className:"text-xs bg-red-900/40 hover:bg-red-900/60 text-red-200 px-3 py-2 rounded-lg",children:"Delete Post"}),o.jsx("button",{onClick:()=>i(a.id,"ban_user"),className:"text-xs bg-red-950 text-red-500 border border-red-900/50 hover:bg-red-900/20 px-3 py-2 rounded-lg",children:"Ban User"})]})]},a.id)}),t.length===0&&o.jsx("div",{className:"text-slate-500 text-center py-8",children:"Queue empty. Good vibes only!"})]})]})},oM=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!1);A.useEffect(()=>{r()},[]);const r=async()=>{s(!0);const a=await bg();e(a.filter(c=>c.type==="comment")),s(!1)},i=async(a,c)=>{await _g(a,c),e(u=>u.filter(d=>d.id!==a))};return o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("h3",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[o.jsx(vu,{className:"w-6 h-6 text-brand-400"})," Comment Moderation Queue"]}),n?o.jsx("div",{className:"text-slate-500",children:"Loading..."}):o.jsxs("div",{className:"space-y-4",children:[t.map(a=>{var c;return o.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-xl p-4",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("span",{className:"bg-red-500/20 text-red-400 text-xs px-2 py-1 rounded font-bold uppercase",children:a.reason}),o.jsx("span",{className:"text-slate-500 text-xs",children:ci(new Date(a.timestamp),{addSuffix:!0})})]}),o.jsxs("div",{className:"bg-black/30 p-3 rounded-lg mb-4 text-slate-300 text-sm italic",children:['"',((c=a.details)==null?void 0:c.text)||"Content snippet unavailable",'"']}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>i(a.id,"dismiss"),className:"text-xs bg-slate-800 hover:bg-slate-700 px-3 py-2 rounded-lg text-white",children:"Mark Safe"}),o.jsx("button",{onClick:()=>i(a.id,"delete_content"),className:"text-xs bg-red-900/40 hover:bg-red-900/60 text-red-200 px-3 py-2 rounded-lg",children:"Delete Comment"}),o.jsx("button",{onClick:()=>i(a.id,"ban_user"),className:"text-xs bg-red-950 text-red-500 border border-red-900/50 hover:bg-red-900/20 px-3 py-2 rounded-lg",children:"Ban User"})]})]},a.id)}),t.length===0&&o.jsx("div",{className:"text-slate-500 text-center py-8",children:"No flagged comments."})]})]})},Uh=({userId:t})=>{const[e,n]=A.useState(null),[s,r]=A.useState(!1);return ml.useEffect(()=>{(async()=>{try{const a=await Uo(He(le,"users",t));a.exists()?n({id:a.id,...a.data()}):r(!0)}catch(a){console.error(a),r(!0)}})()},[t]),s?null:e?o.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-slate-800/50 rounded-lg transition",children:[o.jsx("img",{src:e.avatarUrl,className:"w-10 h-10 rounded-full object-cover",alt:""}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-bold text-white",children:["@",e.handle]}),o.jsxs("div",{className:"text-xs text-slate-400",children:["@",e.handle||"user"]})]})]}):o.jsx("div",{className:"h-12 bg-slate-800/50 rounded-lg animate-pulse"})},aM=({user:t,currentUser:e,onUpdateUser:n,posts:s,onMessage:r,onNavigate:i,onToggleFollow:a,onUpdatePost:c})=>{var je,Te,ae,O,K,te,xe,Se,B,Z,Q,M,se;const[u,d]=A.useState(t.bio||""),[f,m]=A.useState(!1),[p,y]=A.useState(!1),[T,C]=A.useState(!1),[P,b]=A.useState(!1),[E,S]=A.useState(!1),[R,L]=A.useState(!1),[U,N]=A.useState(!1),[x,v]=A.useState(!1),[_,k]=A.useState(!1),[j,I]=A.useState(!1),ee=A.useRef(null),[ne,Ne]=A.useState(!1),[de,$]=A.useState(!1),{adminPrivileges:J}=iE(),H=t.id===e.id,ue=()=>{H&&(n({bio:u}),m(!1))},me=q=>{var we;if(!H)return;const ie=(we=q.target.files)==null?void 0:we[0];if(ie){const pe=new FileReader;pe.onloadend=()=>{n({avatarUrl:pe.result})},pe.readAsDataURL(ie)}};return o.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 animate-fade-in relative pb-20",children:[o.jsxs("div",{className:"bg-brand-800/50 p-6 rounded-3xl border border-brand-700/50 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-600/10 to-transparent pointer-events-none"}),o.jsx("div",{className:"flex gap-6 relative z-10 w-full",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[o.jsxs("div",{className:"relative group shrink-0",children:[o.jsx("img",{src:t.avatarUrl,className:"w-20 h-20 rounded-full border-2 border-brand-500 shadow-xl object-cover",alt:t.displayName}),H&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>{var q;return(q=ee.current)==null?void 0:q.click()},className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:o.jsx(Za,{className:"w-8 h-8 text-white"})}),o.jsx("input",{type:"file",ref:ee,className:"hidden",accept:"image/*",onChange:me})]})]}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[H?t.displayName:`@${t.handle}`,t.isInfluencer&&o.jsx(en,{className:"w-5 h-5 text-amber-500 fill-amber-500"})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("span",{className:"text-brand-300 font-medium text-sm",children:H&&t.handle?`@${t.handle}`:""}),(()=>{const q=nD(t);return o.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-md text-[10px] font-bold border ${q>=90?"text-green-400 bg-green-500/10 border-green-500/20":q<70?"text-red-400 bg-red-500/10 border-red-500/20":"text-blue-400 bg-blue-500/10 border-blue-500/20"}`,title:"Trust Score",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{children:q})]})})()]})]})]}),o.jsx("div",{className:"w-full",children:f&&H?o.jsxs("div",{className:"space-y-2",children:[o.jsx("textarea",{value:u,onChange:q=>d(q.target.value),placeholder:"Tell us about your vibe...",className:"w-full bg-slate-900/80 border border-brand-600 rounded-xl p-2 text-slate-200 focus:outline-none resize-none text-sm",rows:2}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:ue,className:"flex items-center gap-1 bg-brand-600 hover:bg-brand-500 text-white px-3 py-1 rounded-lg text-xs transition",children:[o.jsx(bh,{className:"w-3 h-3"})," Save"]}),o.jsx("button",{onClick:()=>{d(t.bio||""),m(!1)},className:"text-slate-400 hover:text-white px-3 py-1 text-xs",children:"Cancel"})]})]}):o.jsxs("div",{onClick:()=>H&&m(!0),className:`group relative min-h-[1.5rem] rounded-lg border border-transparent ${H?"cursor-pointer hover:bg-brand-900/30 hover:border-brand-800/50 px-2 -ml-2":""} transition`,children:[o.jsx("p",{className:"text-slate-300 text-sm italic leading-relaxed",children:t.bio||(H?"No bio yet. Tap to add your vibe.":"No bio yet.")}),H&&o.jsx(lS,{className:"w-3 h-3 text-brand-400 absolute top-1 right-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),!H&&o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsxs("button",{onClick:r,className:"bg-brand-600 hover:bg-brand-500 text-white px-4 py-1.5 rounded-full font-bold shadow-lg shadow-brand-600/20 transition flex items-center gap-2 text-xs",children:[o.jsx(mr,{className:"w-3 h-3"})," Message"]}),o.jsx(To,{isFollowing:((je=e.following)==null?void 0:je.includes(t.id))||!1,onToggle:q=>{q.stopPropagation(),a&&a()},className:"px-4 py-1.5 w-auto h-auto rounded-full text-xs font-bold gap-2"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-5 gap-1 px-1 sm:px-6 md:gap-2 pb-6",children:[o.jsxs("button",{onClick:()=>C(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((Te=t.vibes)==null?void 0:Te.length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Vibes"})]}),o.jsxs("button",{onClick:()=>y(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((ae=t.followers)==null?void 0:ae.filter(q=>{var ie;return(ie=t.following)==null?void 0:ie.includes(q)}).length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Friends"})]}),o.jsxs("button",{onClick:()=>v(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((O=t.followers)==null?void 0:O.length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Followers"})]}),o.jsxs("button",{onClick:()=>k(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((K=t.following)==null?void 0:K.length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Following"})]}),o.jsxs("button",{onClick:()=>L(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((te=t.followedPlaces)==null?void 0:te.length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Places"})]}),o.jsxs("button",{onClick:()=>N(!0),className:"bg-brand-900/40 py-2 sm:py-3 px-0.5 rounded-xl border border-brand-700/30 hover:bg-brand-800 transition flex flex-col items-center justify-center min-h-[60px]",children:[o.jsx("span",{className:"block text-base sm:text-xl font-bold text-white leading-tight",children:((xe=t.wishlist)==null?void 0:xe.length)||0}),o.jsx("span",{className:"text-[8px] sm:text-[10px] text-slate-400 uppercase tracking-tight sm:tracking-wider font-semibold mt-1 truncate w-full text-center",children:"Wishlist"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-xl font-bold px-2",children:"Vibe History"}),s.length>0?s.map(q=>o.jsx(wg,{post:q,onUpdatePost:c||(()=>{}),currentUser:e},q.id)):o.jsxs("div",{className:"text-center py-10 text-slate-500 bg-slate-900/30 rounded-2xl border border-slate-800",children:[o.jsx(Za,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"No vibes shared yet."})]})]}),H&&o.jsxs("div",{className:"grid gap-4",children:[o.jsxs("div",{className:"bg-brand-900/30 p-4 rounded-xl border border-brand-800 flex items-center justify-between text-slate-300 cursor-not-allowed opacity-75",children:[o.jsxs("span",{className:"flex items-center gap-3",children:[o.jsx(gS,{className:"w-5 h-5 text-brand-400"})," Account Settings"]}),o.jsx("span",{className:"text-xs bg-slate-800 text-slate-400 px-2 py-1 rounded",children:"Coming Soon"})]}),o.jsxs("div",{className:"bg-brand-900/30 p-4 rounded-xl border border-brand-800 flex items-center justify-between text-slate-300",children:[o.jsxs("span",{className:"flex items-center gap-3",children:[o.jsx(Ve,{className:"w-5 h-5 text-brand-400"})," Location History"]}),o.jsxs("span",{className:"text-xs bg-brand-900/80 text-brand-300 border border-brand-700 px-2 py-1 rounded flex items-center gap-1",children:[o.jsx(tn,{className:"w-3 h-3"})," Auto-Deletes 30d"]})]}),o.jsxs("div",{className:"bg-brand-900/30 p-4 rounded-xl border border-brand-800 flex items-center justify-between text-slate-300",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-indigo-500/20 p-1.5 rounded-lg",children:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-indigo-400",children:[o.jsx("path",{d:"M9 10h.01"}),o.jsx("path",{d:"M15 10h.01"}),o.jsx("path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"})]})}),"Ghost Mode"]}),o.jsx("button",{onClick:()=>I(!j),className:`w-10 h-5 rounded-full relative transition-colors ${j?"bg-indigo-500":"bg-slate-700"}`,children:o.jsx("div",{className:`absolute top-1 left-1 w-3 h-3 rounded-full bg-white transition-transform ${j?"translate-x-5":"translate-x-0"}`})})]}),o.jsxs("div",{onClick:()=>b(!0),className:"bg-brand-900/30 p-4 rounded-xl border border-brand-800 flex items-center justify-between text-slate-300 cursor-pointer hover:bg-brand-800 transition",children:[o.jsxs("span",{className:"flex items-center gap-3",children:[o.jsx(yu,{className:"w-5 h-5 text-brand-400"})," Your Activity"]}),o.jsx(Vf,{className:"w-4 h-4 text-slate-500"})]}),o.jsxs("div",{onClick:()=>i==null?void 0:i("safety"),className:"bg-brand-900/30 p-4 rounded-xl border border-brand-800 flex items-center justify-between text-slate-300 cursor-pointer hover:bg-brand-800 transition",children:[o.jsxs("span",{className:"flex items-center gap-3",children:[o.jsx(tn,{className:"w-5 h-5 text-brand-400"})," Safety Center"]}),o.jsx(Vf,{className:"w-4 h-4 text-slate-500"})]})]}),p&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>y(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})," Friends (Mutual)"]}),o.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto w-full",children:[(!t.followers||t.followers.filter(q=>{var ie;return(ie=t.following)==null?void 0:ie.includes(q)}).length===0)&&o.jsx("p",{className:"text-slate-400 text-sm",children:"No mutual friends yet."}),(Se=t.followers)==null?void 0:Se.filter(q=>{var ie;return(ie=t.following)==null?void 0:ie.includes(q)}).map(q=>o.jsxs("div",{className:"relative",children:[o.jsx(Uh,{userId:q}),o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-2 text-yellow-400 text-xs font-bold flex items-center gap-1",children:o.jsx(Xt,{className:"w-3 h-3"})})]},q))]})]})}),x&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})," Followers"]}),o.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto w-full",children:[(!t.followers||t.followers.length===0)&&o.jsx("p",{className:"text-slate-400 text-sm",children:"No followers yet."}),(B=t.followers)==null?void 0:B.map(q=>{var we;const ie=(we=t.following)==null?void 0:we.includes(q);return o.jsxs("div",{className:"relative",children:[o.jsx(Uh,{userId:q}),ie&&o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-2 text-yellow-400",title:"Mutual Friend",children:o.jsx(Xt,{className:"w-3 h-3"})})]},q)})]})]})}),_&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})," Following"]}),o.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto w-full",children:[(!t.following||t.following.length===0)&&o.jsx("p",{className:"text-slate-400 text-sm",children:"Not following anyone yet."}),(Z=t.following)==null?void 0:Z.map(q=>{var we;const ie=(we=t.followers)==null?void 0:we.includes(q);return o.jsxs("div",{className:"relative",children:[o.jsx(Uh,{userId:q}),ie&&o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-2 text-yellow-400",title:"Mutual Friend",children:o.jsx(Xt,{className:"w-3 h-3"})})]},q)})]})]})}),R&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>L(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(Ve,{className:"w-5 h-5 text-brand-400"})," Followed Places"]}),o.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[(!t.followedPlaces||t.followedPlaces.length===0)&&o.jsx("p",{className:"text-slate-400 text-sm",children:"No places followed yet."}),(Q=t.followedPlaces)==null?void 0:Q.map((q,ie)=>o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-500/20 flex items-center justify-center text-brand-400 shrink-0",children:o.jsx(Ve,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-white text-sm",children:q}),o.jsx("p",{className:"text-xs text-slate-500",children:"Followed Spot"})]})]},ie))]})]})}),U&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>N(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(bh,{className:"w-5 h-5 text-brand-400"})," Wishlist"]}),o.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[(!t.wishlist||t.wishlist.length===0)&&o.jsx("p",{className:"text-slate-400 text-sm",children:"No places saved yet."}),(M=t.wishlist)==null?void 0:M.map((q,ie)=>o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-500/20 flex items-center justify-center text-brand-400 shrink-0",children:o.jsx(bh,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-white text-sm",children:q}),o.jsx("p",{className:"text-xs text-slate-500",children:"Saved Vibe"})]})]},ie))]})]})}),E&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fade-in",children:o.jsxs("div",{className:"w-full max-w-4xl h-[90vh] relative bg-brand-950 rounded-3xl overflow-hidden border border-brand-500/30",children:[o.jsx("button",{onClick:()=>S(!1),className:"absolute top-4 right-4 z-50 text-slate-400 hover:text-white transition-colors p-2 bg-black/20 rounded-full",children:o.jsx($e,{className:"w-8 h-8"})}),o.jsx("div",{className:"w-full h-full",children:o.jsx(sE,{onBack:()=>S(!1)})})]})}),T&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>C(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(sd,{className:"w-5 h-5 text-brand-400"})," ",H?"Edit Your Vibes":"Vibes"]}),o.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[["Dancing","Partying","Chilling","Dining","Live Music","Deep House","Networking","Dating","Techno","Art","Fashion","Foodie"].map(q=>{var we;const ie=(we=t.vibes)==null?void 0:we.includes(q);return o.jsx("button",{onClick:()=>{if(!H)return;const pe=t.vibes||[],Oe=ie?pe.filter(Ge=>Ge!==q):[...pe,q];n({vibes:Oe})},disabled:!H&&!ie,className:`px-3 py-1.5 rounded-full text-xs font-bold border transition
                        ${ie?"bg-brand-500 border-brand-500 text-white shadow-[0_0_10px_rgba(168,85,247,0.4)]":H?"bg-transparent border-slate-700 text-slate-400 hover:border-brand-500 hover:text-white":"bg-transparent border-slate-800 text-slate-600 opacity-50 cursor-default hidden"} `,children:q},q)}),(se=t.vibes)==null?void 0:se.filter(q=>!["Dancing","Partying","Chilling","Dining","Live Music","Deep House","Networking","Dating","Techno","Art","Fashion","Foodie"].includes(q)).map(q=>o.jsx("button",{onClick:()=>{var we;if(!H)return;const ie=((we=t.vibes)==null?void 0:we.filter(pe=>pe!==q))||[];n({vibes:ie})},className:"px-3 py-1.5 rounded-full text-xs font-bold border bg-brand-500 border-brand-500 text-white shadow-[0_0_10px_rgba(168,85,247,0.4)]",children:q},q))]}),H&&o.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Select the vibes that match your energy."})]})}),P&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-md p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>b(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(yu,{className:"w-5 h-5 text-brand-400"})," Your Activity"]}),o.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:o.jsx("div",{className:"bg-slate-900/50 rounded-2xl p-4 border border-white/5",children:o.jsx("p",{className:"text-slate-500 text-sm text-center italic",children:"No activity to show."})})})]})}),H&&J&&o.jsx("div",{className:"mt-8 px-4 pb-8",children:o.jsxs("button",{onClick:()=>$(!0),className:"w-full bg-slate-900 border border-amber-500/30 hover:border-amber-500 hover:bg-amber-500/10 text-amber-500 font-bold py-4 rounded-2xl transition flex items-center justify-center gap-2 shadow-lg shadow-amber-900/10",children:[o.jsx(tn,{className:"w-5 h-5"}),"Access Admin Dashboard"]})}),de&&o.jsx(tM,{onClose:()=>$(!1)}),o.jsxs("div",{className:"mt-8 mb-8 text-center pb-8",children:[o.jsx("p",{className:"text-[10px] text-slate-600 font-mono uppercase tracking-widest",children:"VibeMap v0.2.0 (Alpha)"}),o.jsxs("p",{className:"text-[10px] text-slate-700 mt-1",children:["Build: ",new Date().toLocaleDateString()]})]})]})},lM=({initialQuery:t,followingIds:e,onToggleFollow:n,posts:s,currentUser:r})=>{const[i,a]=A.useState("reconnect"),[c,u]=A.useState({});A.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(M=>{const{latitude:se,longitude:q}=M.coords;u({location:new window.google.maps.LatLng(se,q),radius:5e4}),console.log(" Location Bias Applied:",se,q)},M=>{console.log("Location access denied/error:",M)})},[]);const{ready:d,value:f,suggestions:{status:m,data:p},setValue:y,clearSuggestions:T}=ho({requestOptions:c,debounce:300}),{ready:C,value:P,suggestions:{status:b,data:E},setValue:S,clearSuggestions:R}=ho({requestOptions:c,debounce:300}),[L,U]=A.useState(null),[N,x]=A.useState(""),[v,_]=A.useState(""),[k,j]=A.useState(""),[I,ee]=A.useState(!1),[ne,Ne]=A.useState("places");A.useEffect(()=>{t&&(a("reconnect"),y(t))},[t,y]);const de=async(M,se,q)=>{y(se,!1),T(),U({name:q,address:se,placeId:M});try{const we=await Qb({address:se}),{lat:pe,lng:Oe}=await Yb(we[0]);console.log(" Coordinates: ",{lat:pe,lng:Oe})}catch(we){console.error("Error: ",we)}},[$,J]=A.useState(""),[H,ue]=A.useState(""),[me,je]=A.useState(""),[Te,ae]=A.useState([]),[O,K]=A.useState([]),[te,xe]=A.useState(!1),[Se,B]=A.useState("people"),Z=()=>{ee(!0)},Q=async()=>{xe(!0),ae([]),K([]),await new Promise(we=>setTimeout(we,800));const M=$.toLowerCase().trim(),se=$.trim().startsWith("@"),q=se?$.trim().substring(1).toLowerCase():M,ie=P.toLowerCase();if(se){B("people");let we=[];try{const lt=Pe(le,"users");we=(await ht(lt)).docs.map($t=>$t.data()).filter($t=>{var Cs;const Cr=((Cs=$t.handle)==null?void 0:Cs.toLowerCase())||"",Ar=$t.displayName.toLowerCase();return r&&$t.id===r.id?!1:Cr.includes(q)||Ar.includes(q)})}catch(lt){console.error("Error searching users:",lt)}const pe=we.map(lt=>({user:lt})),Oe=pe.filter(lt=>lt.user.isConnected),Ge=pe.filter(lt=>!lt.user.isConnected&&lt.user.isInfluencer),Tn=pe.filter(lt=>!lt.user.isConnected&&!lt.user.isInfluencer);ae([...Oe,...Ge,...Tn])}else{B("places");const we=s.filter(Ge=>{var Tn;return(!M||Ge.location.name.toLowerCase().includes(M)||Ge.description.toLowerCase().includes(M))&&(!ie||((Tn=Ge.location.address)==null?void 0:Tn.toLowerCase().includes(ie)))});K(we);const pe=s.filter(Ge=>{const Tn=new Date(Ge.visitDate)>new Date,lt=!M||Ge.location.name.toLowerCase().includes(M);return Tn&&lt}).map(Ge=>({user:Ge.user,upcomingPlan:Ge})),Oe=Array.from(new Map(pe.map(Ge=>[Ge.user.id,Ge])).values());Oe.length>0&&ae(Oe)}xe(!1)};return o.jsxs("div",{className:"max-w-2xl mx-auto pb-24 animate-fade-in text-slate-100",children:[o.jsxs("div",{className:"mb-10 px-4 md:px-0",children:[o.jsx("h2",{className:"text-4xl font-black bg-gradient-to-r from-brand-400 via-accent to-pink-500 bg-clip-text text-transparent uppercase tracking-tighter italic",children:"Vibe Finder"}),o.jsx("p",{className:"text-slate-500 text-sm font-medium mt-2",children:"Find the tribe you crossed paths with or search by interests, venue, or time."}),o.jsxs("div",{className:"flex bg-slate-900/80 border border-slate-800 rounded-3xl p-1.5 mt-8 backdrop-blur-xl",children:[o.jsxs("button",{onClick:()=>a("reconnect"),className:`flex-1 flex items-center justify-center gap-3 py-4 rounded-2xl text-[11px] font-black uppercase tracking-widest transition ${i==="reconnect"?"bg-brand-600 text-white shadow-2xl shadow-brand-600/30":"text-slate-500 hover:text-white"}`,children:[o.jsx(Ve,{className:"w-4 h-4"})," Reconnect"]}),o.jsxs("button",{onClick:()=>a("discovery"),className:`flex-1 flex items-center justify-center gap-3 py-4 rounded-2xl text-[11px] font-black uppercase tracking-widest transition ${i==="discovery"?"bg-brand-600 text-white shadow-2xl shadow-brand-600/30":"text-slate-500 hover:text-white"}`,children:[o.jsx(Bi,{className:"w-4 h-4"})," Social Scene"]})]})]}),o.jsx("div",{className:"px-2 md:px-0",children:i==="reconnect"?o.jsxs("div",{className:"bg-brand-900/40 p-6 md:p-10 rounded-[2.5rem] md:rounded-[3rem] border border-brand-800/50 space-y-8 shadow-2xl backdrop-blur-md",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest px-1",children:"Location Scan"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Ve,{className:"absolute left-5 top-5 text-brand-400 w-5 h-5 z-10"}),o.jsx("input",{type:"text",value:f,onChange:M=>y(M.target.value),disabled:!d,placeholder:"Venue name...",className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-14 pr-6 py-4.5 text-white focus:border-brand-500 focus:outline-none transition disabled:opacity-50 relative z-0"}),m==="OK"&&o.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl z-50 overflow-hidden max-h-60 overflow-y-auto",children:p.map(({place_id:M,description:se,structured_formatting:{main_text:q,secondary_text:ie}})=>o.jsxs("button",{onClick:()=>de(M,se,q),className:"w-full text-left p-4 hover:bg-slate-800 transition border-b border-slate-800/50 last:border-none flex items-center justify-between group",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-white text-sm",children:q}),o.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:ie})]}),(L==null?void 0:L.placeId)===M&&o.jsx(Jb,{className:"w-5 h-5 text-brand-400"})]},M))})]}),o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsxs("div",{className:"space-y-2 flex-1",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest px-1",children:"Date"}),o.jsxs("div",{className:"relative",children:[o.jsx(Yi,{className:"absolute left-4 top-3.5 text-brand-400 w-4 h-4"}),o.jsx("input",{type:"date",value:N,onChange:M=>x(M.target.value),onClick:M=>M.currentTarget.showPicker(),className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-10 pr-2 py-3 text-white text-sm focus:border-brand-500 focus:outline-none [color-scheme:dark] cursor-pointer"})]})]}),o.jsxs("div",{className:"space-y-2 flex-1",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest px-1",children:"From"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ca,{className:"absolute left-4 top-3.5 text-brand-400 w-4 h-4"}),o.jsx("input",{type:"time",value:v,onChange:M=>_(M.target.value),onClick:M=>M.currentTarget.showPicker(),className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-10 pr-2 py-3 text-white text-sm focus:border-brand-500 focus:outline-none [color-scheme:dark] cursor-pointer"})]})]}),o.jsxs("div",{className:"space-y-2 flex-1",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest px-1",children:"Till"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ca,{className:"absolute left-4 top-3.5 text-brand-400 w-4 h-4"}),o.jsx("input",{type:"time",value:k,onChange:M=>j(M.target.value),onClick:M=>M.currentTarget.showPicker(),className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-10 pr-2 py-3 text-white text-sm focus:border-brand-500 focus:outline-none [color-scheme:dark] cursor-pointer"})]})]})]})]})]}),o.jsxs("button",{onClick:Z,disabled:!f||!N,className:"w-full bg-gradient-to-r from-brand-600 to-accent py-5 rounded-3xl font-black text-white shadow-2xl hover:scale-[1.02] active:scale-95 transition disabled:opacity-30 uppercase tracking-[0.2em] text-[12px] flex items-center justify-center gap-3",children:["Verify Crossed Paths ",o.jsx(Of,{className:"w-5 h-5"})]}),o.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/20 p-4 rounded-2xl mt-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("h3",{className:"text-sm font-bold text-brand-200 flex items-center gap-2",children:[o.jsx(Ve,{className:"w-4 h-4"})," Past Visits"]}),o.jsxs("div",{className:"flex bg-slate-900/50 rounded-lg p-0.5 border border-white/10",children:[o.jsx("button",{onClick:()=>Ne("places"),className:`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider transition ${ne==="places"?"bg-brand-600 text-white":"text-slate-400 hover:text-white"}`,children:"Places"}),o.jsx("button",{onClick:()=>Ne("users"),className:`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider transition ${ne==="users"?"bg-brand-600 text-white":"text-slate-400 hover:text-white"}`,children:"Users"})]})]}),o.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:s.filter(M=>!(new Date(M.visitDate)<new Date)||!(r?M.user.id===r.id||M.user.isConnected:!1)?!1:ne==="places"?M.user.id===(r==null?void 0:r.id):ne==="users"?M.user.id!==(r==null?void 0:r.id):!1).length===0?o.jsx("div",{className:"text-center p-3 text-slate-500 text-xs italic",children:"No recent visits found."}):s.filter(M=>{const se=new Date(M.visitDate)<new Date,q=r?M.user.id===r.id||M.user.isConnected:!1;return ne==="places"&&M.user.id!==(r==null?void 0:r.id)||ne==="users"&&M.user.id===(r==null?void 0:r.id)?!1:se&&q}).slice(0,5).map((M,se)=>o.jsxs("div",{className:"bg-black/20 p-2.5 rounded-xl flex items-center justify-between group hover:bg-black/40 transition border border-transparent hover:border-white/5",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-brand-400 group-hover:bg-brand-900/50 transition overflow-hidden",children:ne==="places"?o.jsx(Ve,{className:"w-4 h-4"}):o.jsx("img",{src:M.user.avatarUrl,className:"w-full h-full object-cover",alt:M.user.displayName})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-200 font-bold",children:ne==="places"?M.location.name:M.user.handle?`@${M.user.handle}`:M.user.displayName}),o.jsx("div",{className:"text-[10px] text-slate-500",children:ne==="places"?`${M.visitDate}  ${M.vibe||"Vibe"}`:M.location.name})]})]}),o.jsx("div",{className:"text-right",children:o.jsx("span",{className:"text-[10px] font-bold text-green-400 bg-green-500/10 px-2 py-1 rounded-full",children:ne==="places"?"+10":"Friend"})})]},se))})]})]}):o.jsxs("div",{className:"space-y-8 animate-fade-in",children:[o.jsx("div",{className:"bg-brand-900/40 p-6 md:p-8 rounded-[2.5rem] md:rounded-[3rem] border border-brand-800/50 space-y-6 shadow-2xl backdrop-blur-md",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-[10px] text-brand-300 italic mb-3 opacity-80",children:["Use ",o.jsx("span",{className:"text-white font-bold",children:"@"})," to search people (e.g. @nightriot), or type name for places."]}),o.jsxs("div",{className:"relative w-full",children:[o.jsx(Bi,{className:"absolute left-5 top-4 text-brand-400 w-5 h-5"}),o.jsx("input",{type:"text",value:$,onChange:M=>J(M.target.value),onKeyDown:M=>M.key==="Enter"&&Q(),placeholder:"Handle (@user)...",className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-14 pr-6 py-4 text-white focus:border-brand-500 focus:outline-none transition"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Ve,{className:"absolute left-4 top-3.5 text-slate-500 w-4 h-4 z-10"}),o.jsx("input",{type:"text",value:P,onChange:M=>S(M.target.value),disabled:!C,placeholder:"Where? (Optional)",className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-10 pr-4 py-3 text-sm text-white focus:border-brand-500 focus:outline-none relative z-0"}),b==="OK"&&o.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl z-50 overflow-hidden max-h-60 overflow-y-auto",children:E.map(({place_id:M,description:se,structured_formatting:{main_text:q,secondary_text:ie}})=>o.jsx("button",{onClick:()=>{S(se,!1),R()},className:"w-full text-left p-3 hover:bg-slate-800 transition border-b border-slate-800/50 last:border-none flex items-center justify-between group",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-white text-xs",children:q}),o.jsx("div",{className:"text-[9px] text-slate-500 uppercase tracking-wider",children:ie})]})},M))})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Yi,{className:"absolute left-3 top-3.5 text-slate-500 w-3.5 h-3.5"}),o.jsx("input",{type:"date",value:H,onChange:M=>ue(M.target.value),onClick:M=>M.currentTarget.showPicker(),className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-9 pr-2 py-3 text-xs text-white focus:border-brand-500 focus:outline-none [color-scheme:dark] cursor-pointer"})]}),o.jsxs("div",{className:"relative w-24",children:[o.jsx(Ca,{className:"absolute left-3 top-3.5 text-slate-500 w-3.5 h-3.5"}),o.jsx("input",{type:"time",value:me,onChange:M=>je(M.target.value),onClick:M=>M.currentTarget.showPicker(),className:"w-full bg-slate-950 border border-slate-800 rounded-2xl pl-9 pr-2 py-3 text-xs text-white focus:border-brand-500 focus:outline-none [color-scheme:dark] cursor-pointer"})]})]})]}),o.jsx("button",{onClick:Q,disabled:te,className:"w-full bg-brand-600 hover:bg-brand-500 py-4 rounded-2xl transition font-black text-[11px] uppercase tracking-widest shadow-xl flex items-center justify-center gap-2",children:te?o.jsx(jo,{className:"w-5 h-5 animate-spin"}):o.jsxs(o.Fragment,{children:["Find Vibers ",o.jsx(Of,{className:"w-4 h-4"})]})})]})}),o.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/20 p-4 rounded-2xl mt-4",children:[o.jsx("div",{className:"flex justify-between items-center mb-3",children:o.jsxs("h3",{className:"text-sm font-bold text-brand-200 flex items-center gap-2",children:[o.jsx(Yi,{className:"w-4 h-4"})," Your Upcoming Plans"]})}),o.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:s.filter(M=>{const se=new Date(M.visitDate)>new Date,q=r?M.user.id===r.id||M.rsvps&&M.rsvps[r.id]===Ue.WILL_JOIN:!1;return se&&q}).length===0?o.jsx("div",{className:"text-center p-3 text-slate-500 text-xs italic",children:"No upcoming plans."}):s.filter(M=>{const se=new Date(M.visitDate)>new Date,q=r?M.user.id===r.id||M.rsvps&&M.rsvps[r.id]===Ue.WILL_JOIN:!1;return se&&q}).slice(0,5).map((M,se)=>o.jsx("div",{className:"bg-black/20 p-2.5 rounded-xl flex items-center justify-between group hover:bg-black/40 transition border border-transparent hover:border-white/5",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-brand-400 group-hover:bg-brand-900/50 transition",children:o.jsx(Ve,{className:"w-4 h-4"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-200 font-bold",children:M.location.name}),o.jsxs("div",{className:"text-[10px] text-slate-500",children:[M.visitDate,"  ",M.vibe||"Vibe"]})]})]})},se))})]}),o.jsxs("div",{className:"grid gap-4",children:[Te.length>0&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest px-2",children:Se==="people"?"Matches":"People Going"}),Te.map(M=>{var se,q;return o.jsxs("div",{className:"bg-brand-900/30 border border-brand-800/50 p-5 rounded-3xl flex items-center justify-between group hover:border-brand-600 transition backdrop-blur-md",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:M.user.avatarUrl,className:"w-12 h-12 rounded-full border border-brand-700 object-cover shadow-lg",alt:""}),M.user.isInfluencer&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-0.5 border-2 border-slate-900",children:o.jsx(en,{className:"w-2.5 h-2.5 text-white"})})]}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-white text-base",children:M.user.handle?`@${M.user.handle}`:M.user.displayName}),M.upcomingPlan&&o.jsxs("div",{className:"flex items-center text-[10px] text-brand-300 mt-1",children:[o.jsx(Ve,{className:"w-3 h-3 mr-1"}),M.upcomingPlan.location.name,"  ",M.upcomingPlan.visitDate.split("T")[0]]}),!M.upcomingPlan&&M.user.interests&&o.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:M.user.interests.slice(0,2).map(ie=>o.jsxs("span",{className:"text-[9px] text-slate-400",children:["#",ie]},ie))})]})]}),o.jsx(To,{isFollowing:e.has(M.user.id),isFollower:(se=r==null?void 0:r.followers)==null?void 0:se.includes(M.user.id),isFriend:e.has(M.user.id)&&((q=r==null?void 0:r.followers)==null?void 0:q.includes(M.user.id)),onToggle:ie=>{ie.stopPropagation(),n(M.user.id)},className:e.has(M.user.id)?"shadow-indigo-500/20":""})]},M.user.id)})]}),O.length>0&&o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest px-2",children:"Places"}),O.map(M=>o.jsx("div",{className:"bg-brand-900/30 border border-brand-800/50 p-5 rounded-3xl flex items-center justify-between group hover:border-brand-600 transition backdrop-blur-md",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center text-brand-500",children:o.jsx(Ve,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-white text-base",children:M.location.name}),o.jsx("div",{className:"text-[10px] text-slate-400",children:M.location.address||"Unknown Location"})]})]})},M.id))]}),Te.length===0&&O.length===0&&!te&&o.jsxs("div",{className:"text-center py-12 opacity-50 space-y-2",children:[o.jsx(PT,{className:"w-12 h-12 mx-auto text-slate-600"}),o.jsxs("p",{className:"text-slate-500 text-sm font-medium",children:["Use filters to find your ",Se==="people"?"tribe":"places","."]})]})]})]})})]})},cM=t=>{const[e,n]=A.useState([]),[s,r]=A.useState(!0),[i,a]=A.useState(null);return A.useEffect(()=>{if(!t){n([]),r(!1);return}const c=tt(Pe(le,"conversations"),dt("participants","array-contains",t.id),Wr("updatedAt","desc")),u=ri(c,async d=>{const f=new Set,m=d.docs.map(C=>{var S,R,L,U,N,x,v;const P=C.data();if((S=P.hiddenFor)!=null&&S.includes(t.id))return null;const b=((U=(L=(R=P.lastMessageAt)==null?void 0:R.toDate)==null?void 0:L.call(R))==null?void 0:U.toISOString())||((v=(x=(N=P.updatedAt)==null?void 0:N.toDate)==null?void 0:x.call(N))==null?void 0:v.toISOString())||new Date().toISOString(),E=P.participants.find(_=>_!==t.id);return E&&f.add(E),{id:C.id,...P,lastMessageAt:b}}).filter(Boolean),p=Array.from(f),y=new Map;if(p.length>0)try{for(let C=0;C<p.length;C+=10){const P=p.slice(C,C+10),b=tt(Pe(le,"users"),dt(am(),"in",P));(await ht(b)).forEach(S=>{y.set(S.id,{id:S.id,...S.data()})})}}catch(C){console.error("Failed to batch fetch inbox users:",C)}const T=m.map(C=>{var E;let P;if(C.type==="group")P={id:C.id,displayName:C.groupName||"Unnamed Group",avatarUrl:C.groupPhotoUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(C.groupName||"Group")}`,isConnected:!0,handle:"group"};else{const S=C.participants.find(R=>R!==t.id);P={id:S||"unknown",displayName:"Unknown User",avatarUrl:"https://ui-avatars.com/api/?name=Unknown",isConnected:!1},S&&y.has(S)&&(P=y.get(S))}const b=((E=C.unreadCount)==null?void 0:E[t.id])??0;return{...C,recipientUser:P,unreadCount:b}});n(T),r(!1)},d=>{console.error("Error fetching inbox:",d),a(d),r(!1)});return()=>u()},[t==null?void 0:t.id]),{conversations:e,isLoading:s,error:i}},uM=async(t,e,n,s)=>{try{const r=[t.id,...e.map(u=>u.id)].filter(Boolean),i={type:"group",groupName:n,groupPhotoUrl:s||`https://ui-avatars.com/api/?name=${encodeURIComponent(n)}&background=random`,participants:r,adminIds:[t.id],createdBy:t.id,createdAt:cr(),updatedAt:cr(),lastMessage:`@${t.handle} created the group "${n}"`,lastMessageAt:new Date().toISOString(),unreadCount:r.reduce((u,d)=>({...u,[d]:1}),{})},a=await Ts(Pe(le,"conversations"),i),c=Pe(le,"messages");return await Ts(c,{text:`@${t.handle} created the group "${n}"`,senderId:"system",system:!0,createdAt:cr(),conversationId:a.id}),a.id}catch(r){throw console.error("Error creating group:",r),r}},dM=async(t,e)=>{try{const n=He(le,"conversations",t);await hn(n,{hiddenFor:ng(e)})}catch(n){throw console.error("Error deleting conversation:",n),n}},hM=async(t,e,n)=>{try{const s=He(le,"conversations",t),r=e.map(c=>c.id),i=e.map(c=>`@${c.handle}`).join(", ");await hn(s,{participants:ng(...r),updatedAt:cr()});const a=Pe(le,"messages");await Ts(a,{text:`@${n.handle} added ${i}`,senderId:"system",system:!0,createdAt:cr(),conversationId:t})}catch(s){throw console.error("Error adding participants:",s),s}},fM=async(t,e,n,s)=>{try{const r=He(le,"conversations",t);await hn(r,{participants:cm(e),adminIds:cm(e),updatedAt:cr()});const i=Pe(le,"messages");await Ts(i,{text:`@${s.handle} removed ${n}`,senderId:"system",system:!0,createdAt:cr(),conversationId:t})}catch(r){throw console.error("Error removing participant:",r),r}},mM=({currentUser:t,onSelectConversation:e})=>{const{conversations:n,isLoading:s,error:r}=cM(t),[i,a]=A.useState(""),[c,u]=A.useState([]),[d,f]=A.useState(!1),[m,p]=A.useState(!1),[y,T]=A.useState(""),[C,P]=A.useState([]),[b,E]=A.useState(""),[S,R]=A.useState([]);A.useEffect(()=>{const v=setTimeout(async()=>{if(!b.trim()){R([]);return}const _=b.toLowerCase(),k=Pe(le,"users"),ee=(await ht(k)).docs.map(ne=>({id:ne.id,...ne.data()})).filter(ne=>{var Ne;return ne.id===(t==null?void 0:t.id)?!1:ne.displayName.toLowerCase().includes(_)||((Ne=ne.handle)==null?void 0:Ne.toLowerCase().includes(_))}).slice(0,5);R(ee)},300);return()=>clearTimeout(v)},[b,t]);const L=async()=>{if(!(!t||!y.trim()||C.length===0))try{const x=await uM(t,C,y);p(!1),T(""),P([])}catch(x){console.error("Group Creation Error:",x),alert(`Failed to create group: ${x.message||"Unknown error"}`)}},U=x=>{C.find(v=>v.id===x.id)?P(v=>v.filter(_=>_.id!==x.id)):P(v=>[...v,x])};A.useEffect(()=>{const v=setTimeout(async()=>{const _=i.trim().toLowerCase();if(!_){u([]);return}try{const k=_.startsWith("@")?_.substring(1):_,j=Pe(le,"users"),ne=(await ht(j)).docs.map(H=>H.data()).filter(H=>{var je;if(H.id===(t==null?void 0:t.id))return!1;const ue=((je=H.handle)==null?void 0:je.toLowerCase())||"",me=H.displayName.toLowerCase();return ue.includes(k)||me.includes(k)}),Ne=new Set(n.map(H=>H.recipientUser.id)),de=new Set((t==null?void 0:t.following)||[]),$=new Set((t==null?void 0:t.followers)||[]),J=H=>Ne.has(H.id)?100:de.has(H.id)||$.has(H.id)?50:0;ne.sort((H,ue)=>J(ue)-J(H)),u(ne.slice(0,5))}catch(k){console.error("Inbox Search Error:",k)}},300);return()=>clearTimeout(v)},[i,t,n]);const N=x=>{const v=new Date(x),_=new Date,k=_.getTime()-v.getTime();return k<1e3*60*60*24&&v.getDate()===_.getDate()?v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):k<1e3*60*60*48&&v.getDate()===_.getDate()-1?"Yesterday":v.toLocaleDateString()};return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-140px)] bg-slate-900 border border-brand-800 rounded-2xl overflow-hidden animate-fade-in",children:[o.jsxs("div",{className:"bg-brand-900/90 backdrop-blur-md p-4 border-b border-brand-800 z-10 flex justify-between items-center",children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:"Messages"}),o.jsxs("button",{onClick:()=>p(!0),className:"text-xs bg-brand-800/50 hover:bg-brand-700 text-slate-300 px-3 py-1.5 rounded-full transition flex items-center gap-1 cursor-pointer hover:text-white",children:[o.jsx("span",{className:"font-bold",children:"+"})," Group"]})]}),o.jsx("div",{className:"px-4 py-2 bg-slate-900/50 backdrop-blur-sm border-b border-brand-800/50 sticky top-0 z-20",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-3 flex items-center pointer-events-none",children:o.jsx(ti,{className:"w-4 h-4 text-slate-500"})}),o.jsx("input",{type:"text",placeholder:"Use @ to search people...",value:i,onChange:x=>{a(x.target.value),f(!!x.target.value)},className:"w-full bg-slate-950 border border-slate-700 rounded-xl py-2 pl-9 pr-8 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-brand-500 focus:ring-1 focus:ring-brand-500 transition-all"}),i&&o.jsx("button",{onClick:()=>{a(""),f(!1)},className:"absolute inset-y-0 right-3 flex items-center text-slate-500 hover:text-white",children:o.jsx($e,{className:"w-4 h-4"})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-2 scrollbar-thin scrollbar-thumb-brand-800 scrollbar-track-slate-900",children:d?o.jsx("div",{className:"space-y-1",children:c.length===0?o.jsx("div",{className:"text-center text-slate-500 py-8 text-sm",children:"No matches found."}):c.map(x=>{var I,ee;const v=n.some(ne=>ne.recipientUser.id===x.id),_=(I=t==null?void 0:t.following)==null?void 0:I.includes(x.id),k=(ee=t==null?void 0:t.followers)==null?void 0:ee.includes(x.id);let j=null;return v?j=o.jsx("span",{className:"text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded",children:"Chatting"}):_&&k?j=o.jsx("span",{className:"text-[10px] bg-brand-900/50 text-brand-300 px-1.5 py-0.5 rounded",children:"Friend"}):_&&(j=o.jsx("span",{className:"text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded",children:"Following"})),o.jsxs("button",{onClick:()=>{e(x),a(""),f(!1)},className:"w-full flex items-center gap-3 p-3 hover:bg-slate-800/50 rounded-xl transition group text-left",children:[o.jsx("img",{src:x.avatarUrl,alt:"",className:"w-10 h-10 rounded-full border border-slate-700"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-bold text-slate-200 truncate group-hover:text-brand-300 transition",children:x.handle?`@${x.handle}`:x.displayName}),j]}),o.jsx("div",{className:"text-xs text-slate-500 truncate",children:"Viber"})]})]},x.id)})}):s?o.jsx("div",{className:"text-center text-slate-500 py-10",children:"Loading messages..."}):r?o.jsxs("div",{className:"p-4 text-center",children:[o.jsx("p",{className:"text-red-400 text-xs mb-2",children:"Inbox Sync Error"}),o.jsx("div",{className:"text-red-500 text-xs break-all",children:r.message.split(/(https?:\/\/[^\s]+)/g).map((x,v)=>x.match(/^https?:\/\//)?o.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-red-400 font-bold block mt-2 p-2 bg-red-500/10 rounded",children:"Create Missing Inbox Index"},v):null)})]}):n.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 space-y-4 opacity-50",children:[o.jsx(mr,{className:"w-12 h-12"}),o.jsx("p",{children:"No messages yet. Start vibing!"})]}):o.jsx("div",{className:"space-y-1",children:n.map(x=>{const v=x.recipientUser;return o.jsxs("button",{onClick:()=>e(v),className:"w-full flex items-center gap-3 p-3 hover:bg-slate-800/50 rounded-xl transition group text-left",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:v.avatarUrl,alt:"",className:"w-12 h-12 rounded-full border border-slate-700 group-hover:border-brand-500/50 transition"}),o.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-slate-900"})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex justify-between items-baseline mb-0.5",children:[o.jsx("h3",{className:"font-bold text-slate-200 truncate pr-2 group-hover:text-brand-300 transition",children:v.handle==="group"?v.displayName:v.handle?`@${v.handle}`:v.displayName}),o.jsx("span",{className:"text-[10px] text-slate-500 whitespace-nowrap",children:N(x.lastMessageAt)})]}),o.jsx("p",{className:`text-sm text-slate-400 truncate group-hover:text-slate-300 flex items-center gap-1 ${x.unreadCount>0?"font-bold text-slate-200":""}`,children:x.lastMessage})]}),x.unreadCount>0&&o.jsx("div",{className:"bg-brand-500 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center shadow-lg shadow-brand-500/20",children:x.unreadCount})]},x.id)})})}),m&&o.jsxs("div",{className:"absolute inset-0 bg-slate-900 z-50 flex flex-col animate-fade-in p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-white",children:"Cancel"}),o.jsx("h3",{className:"font-bold text-white",children:"New Group"}),o.jsx("button",{onClick:L,disabled:!y.trim()||C.length===0,className:"text-brand-400 font-bold disabled:opacity-50",children:"Create"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-500 tracking-widest block mb-2",children:"Group Name"}),o.jsx("input",{type:"text",placeholder:"e.g. Weekend Vibes",value:y,onChange:x=>T(x.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-xl p-3 text-white focus:outline-none focus:border-brand-500"})]}),C.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:C.map(x=>o.jsxs("span",{className:"bg-brand-900 border border-brand-700 text-brand-200 text-xs px-2 py-1 rounded-full flex items-center gap-1",children:["@",x.handle,o.jsx("button",{onClick:()=>U(x),children:o.jsx($e,{className:"w-3 h-3"})})]},x.id))}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-slate-500 tracking-widest block mb-2",children:"Add Member"}),o.jsxs("div",{className:"relative",children:[o.jsx(ti,{className:"absolute left-3 top-3 w-4 h-4 text-slate-500"}),o.jsx("input",{type:"text",placeholder:"Search people...",value:b,onChange:x=>E(x.target.value),className:"w-full bg-slate-800 border-b border-slate-700 p-3 pl-10 text-white focus:outline-none"})]}),o.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto space-y-1",children:S.map(x=>{const v=C.some(_=>_.id===x.id);return o.jsxs("div",{onClick:()=>U(x),className:"flex items-center justify-between p-2 hover:bg-slate-800 rounded-lg cursor-pointer",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[o.jsx("img",{src:x.avatarUrl,className:"w-8 h-8 rounded-full",alt:""}),o.jsx("div",{className:"min-w-0",children:o.jsxs("div",{className:"text-sm font-bold text-slate-200 truncate",children:["@",x.handle]})})]}),o.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center shrink-0 ${v?"bg-brand-500 border-brand-500":"border-slate-600"}`,children:v&&o.jsx(Ao,{className:"w-3 h-3 text-white"})})]},x.id)})})]})]})]})]})},pM=(t,e)=>{const[n,s]=A.useState([]),[r,i]=A.useState(!0),[a,c]=A.useState(!1),[u,d]=A.useState(null),[f,m]=A.useState(null),[p,y]=A.useState(!0),T=t?e.handle==="group"?e.id:[t.id,e.id].sort().join("_"):null;A.useEffect(()=>{if(!t||!T)return;i(!0);const E=tt(Pe(le,"messages"),dt("conversationId","==",T),Wr("createdAt","desc"),No(20)),S=ri(E,R=>{console.log(`[useChat] Snapshot update for ${T}. Docs: ${R.docs.length}, Metadata:`,R.metadata);const L=R.docs,U=L.map(N=>{var x;return{id:N.id,...N.data(),timestamp:((x=N.data().createdAt)==null?void 0:x.toDate().toISOString())||new Date().toISOString()}}).reverse();s(U),i(!1),L.length>0&&m(L[L.length-1])},R=>{console.error(`[useChat] Snapshot ERROR for ${T}:`,R),d(`Sync Error: ${R.message}`),i(!1)});return C(),()=>S()},[t==null?void 0:t.id,e.id,T]);const C=async()=>{if(T&&t){const E=He(le,"conversations",T),S=`unreadCount.${t.id}`;try{await Eo(E,{[S]:0},{merge:!0})}catch(R){console.error("Failed to mark as read",R)}}};return{messages:n,sendMessage:async E=>{if(!t||!E.trim()||a)return;c(!0),d(null);const S={text:E,senderId:t.id,receiverId:e.id,conversationId:T,createdAt:ze.now()};try{if(await Ts(Pe(le,"messages"),S),T){const R=He(le,"conversations",T),L=await Uo(R);if(L.exists()){const N=L.data().participants||[t.id,e.id],x={lastMessage:E,lastMessageAt:ze.now(),updatedAt:ze.now(),hiddenFor:C4()};N.forEach(v=>{v!==t.id&&(x[`unreadCount.${v}`]=A4(1))}),e.handle!=="group"&&(x.participants=[t.id,e.id]),await hn(R,x)}}}catch(R){console.error("Error sending message:",R),d("Failed to send. Please try again.")}finally{c(!1)}},isLoading:r,isSending:a,sendError:u,loadMore:async()=>{if(!f||!T||r)return;tt(Pe(le,"messages"),dt("conversationId","==",T),Wr("createdAt","asc"),_4(20));const E=tt(Pe(le,"messages"),dt("conversationId","==",T),Wr("createdAt","desc"),N4(f),No(20)),S=await ht(E);if(S.empty){y(!1);return}const R=S.docs.map(L=>{var U;return{id:L.id,...L.data(),timestamp:((U=L.data().createdAt)==null?void 0:U.toDate().toISOString())||new Date().toISOString()}});s(L=>[...R.reverse(),...L]),m(S.docs[S.docs.length-1])},hasMore:p,conversationId:T}},gM=({currentUser:t,recipient:e,onBack:n})=>{var ae;const{messages:s,sendMessage:r,isLoading:i,isSending:a,sendError:c,loadMore:u,hasMore:d,conversationId:f}=pM(t,e),[m,p]=A.useState(""),y=A.useRef(null),[T,C]=A.useState({});A.useEffect(()=>{(async()=>{if(e.handle!=="group"||s.length===0)return;const K=Array.from(new Set(s.map(te=>te.senderId))).filter(te=>te!==(t==null?void 0:t.id)&&!T[te]);if(K.length!==0)try{for(let te=0;te<K.length;te+=10){const xe=K.slice(te,te+10),Se=tt(Pe(le,"users"),dt(am(),"in",xe)),B=await ht(Se),Z={};B.forEach(Q=>{Z[Q.id]=Q.data()}),C(Q=>({...Q,...Z}))}}catch(te){console.error("Failed to fetch group senders",te)}})()},[s,e.handle,t==null?void 0:t.id]),A.useEffect(()=>{var O;(O=y.current)==null||O.scrollIntoView({behavior:"smooth"})},[s.length]);const P=()=>{m.trim()&&(r(m),p(""))},[b,E]=A.useState(!1),S=O=>new Date(O).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),R=async()=>{if(!(!t||!f)&&confirm("Are you sure you want to delete this conversation? It will be hidden until a new message is sent.")){try{await dM(f,t.id)}catch{alert("Failed to delete chat.")}n()}},[L,U]=A.useState(!1),[N,x]=A.useState(null),[v,_]=A.useState([]),[k,j]=A.useState(!1),[I,ee]=A.useState(""),[ne,Ne]=A.useState([]),[de,$]=A.useState(null),J=O=>{const K=O.target.value;p(K);const te=K.split(/\s+/).pop();te&&te.startsWith("@")&&te.length>1?$(te.slice(1).toLowerCase()):$(null)},H=O=>{const K=m.split(/\s+/);K.pop();const te=K.join(" ")+(K.length>0?" ":"")+`@${O} `;p(te),$(null)},ue=de?v.filter(O=>{var K;return((K=O.handle)==null?void 0:K.toLowerCase().includes(de))||O.displayName.toLowerCase().includes(de)}).slice(0,5):[];A.useEffect(()=>{if(e.handle==="group"&&f){const O=ri(He(le,"conversations",f),async K=>{var te;if(K.exists()){const xe={id:K.id,...K.data()};if(x(xe),((te=xe.participants)==null?void 0:te.length)>0)try{const Se=tt(Pe(le,"users"),dt(am(),"in",xe.participants.slice(0,10))),Z=(await ht(Se)).docs.map(Q=>({id:Q.id,...Q.data()}));_(Z)}catch(Se){console.error("Failed to fetch group members",Se)}}});return()=>O()}},[f,e.handle]),A.useEffect(()=>{const K=setTimeout(async()=>{if(!I.trim()){Ne([]);return}const te=I.toLowerCase(),xe=Pe(le,"users"),Z=(await ht(xe)).docs.map(Q=>({id:Q.id,...Q.data()})).filter(Q=>{var M;return N!=null&&N.participants.includes(Q.id)?!1:Q.displayName.toLowerCase().includes(te)||((M=Q.handle)==null?void 0:M.toLowerCase().includes(te))}).slice(0,5);Ne(Z)},300);return()=>clearTimeout(K)},[I,N]);const me=async O=>{if(!(!t||!f))try{await hM(f,[O],t),j(!1),ee("")}catch{alert("Failed to add member.")}},je=async(O,K)=>{if(!(!t||!f)&&confirm(`Remove ${K} from the group?`))try{await fM(f,O,K,t)}catch{alert("Failed to remove member.")}},Te=(ae=N==null?void 0:N.adminIds)==null?void 0:ae.includes((t==null?void 0:t.id)||"");return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-140px)] bg-slate-900 border border-brand-800 rounded-2xl overflow-hidden animate-fade-in relative",children:[o.jsxs("div",{className:"bg-brand-900/90 backdrop-blur-md p-4 flex items-center justify-between border-b border-brand-800 absolute top-0 w-full z-20 shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:n,className:"text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition",children:o.jsx(Mf,{className:"w-6 h-6"})}),o.jsx("div",{className:"relative group cursor-pointer",onClick:()=>e.handle==="group"&&U(!0),children:o.jsx("img",{src:e.avatarUrl,alt:"",className:"w-10 h-10 rounded-full border-2 border-brand-600 object-cover"})}),o.jsxs("div",{className:"cursor-pointer",onClick:()=>e.handle==="group"&&U(!0),children:[o.jsx("h3",{className:"font-bold text-white leading-tight",children:e.handle==="group"?e.displayName||"Group Chat":`@${e.handle}`}),e.handle==="group"&&o.jsx("span",{className:"text-[10px] text-slate-400 block",children:"Tap for info"})]})]}),o.jsxs("div",{className:"flex gap-1 relative",children:[o.jsx("button",{onClick:()=>E(!b),className:"text-slate-400 hover:text-white p-2 rounded-full hover:bg-slate-800 transition",children:o.jsx(NT,{className:"w-5 h-5"})}),b&&o.jsxs("div",{className:"absolute top-10 right-0 bg-slate-900 border border-slate-700 rounded-xl shadow-xl z-50 overflow-hidden min-w-[160px] animate-fade-in",children:[e.handle==="group"&&o.jsxs("button",{onClick:()=>{U(!0),E(!1)},className:"w-full text-left px-4 py-3 text-slate-300 hover:bg-slate-800 text-sm font-bold flex items-center gap-2 transition border-b border-slate-800",children:[o.jsx(Xt,{className:"w-4 h-4"})," Group Info"]}),o.jsxs("button",{onClick:R,className:"w-full text-left px-4 py-3 text-red-400 hover:bg-red-500/10 hover:text-red-300 text-sm font-bold flex items-center gap-2 transition",children:[o.jsx(Lf,{className:"w-4 h-4"})," Delete Chat"]})]})]})]}),L&&o.jsxs("div",{className:"absolute inset-0 z-50 bg-slate-900 animate-slide-in-right flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-brand-800 flex items-center gap-3 bg-brand-900/50",children:[o.jsx("button",{onClick:()=>U(!1),className:"text-slate-400 hover:text-white",children:o.jsx(Mf,{className:"w-6 h-6"})}),o.jsx("h3",{className:"font-bold text-lg text-white",children:"Group Info"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx("img",{src:e.avatarUrl,className:"w-20 h-20 rounded-full border-2 border-brand-500",alt:""}),o.jsx("h2",{className:"text-xl font-bold text-white",children:e.displayName}),o.jsxs("p",{className:"text-slate-400 text-sm",children:[v.length," members"]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"text-xs font-bold text-slate-500 tracking-widest",children:"Members"}),Te&&o.jsxs("button",{onClick:()=>j(!0),className:"text-xs bg-brand-600 hover:bg-brand-500 text-white px-2 py-1 rounded-full flex items-center gap-1 transition",children:[o.jsx(e_,{className:"w-3 h-3"})," Add"]})]}),k&&o.jsxs("div",{className:"mb-4 bg-slate-800 rounded-xl p-3 animate-fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-sm font-bold text-white",children:"Add Members"}),o.jsx("button",{onClick:()=>j(!1),children:o.jsx($e,{className:"w-4 h-4 text-slate-400"})})]}),o.jsx("input",{type:"text",placeholder:"Search friends...",value:I,onChange:O=>ee(O.target.value),className:"w-full bg-slate-900 border border-slate-700 rounded-lg p-2 text-sm text-white focus:outline-none focus:border-brand-500 mb-2"}),o.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:ne.map(O=>o.jsxs("button",{onClick:()=>me(O),className:"w-full flex items-center gap-2 p-2 hover:bg-slate-700/50 rounded-lg transition text-left",children:[o.jsx("img",{src:O.avatarUrl,className:"w-6 h-6 rounded-full",alt:""}),o.jsxs("span",{className:"text-sm text-slate-200 truncate flex-1",children:["@",O.handle]}),o.jsx(pr,{className:"w-4 h-4 text-brand-400"})]},O.id))})]}),o.jsx("div",{className:"space-y-2",children:v.map(O=>{var K;return o.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-slate-800/50 rounded-xl transition",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:O.avatarUrl,className:"w-10 h-10 rounded-full",alt:""}),o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:"text-sm font-bold text-slate-200",children:["@",O.handle,((K=N==null?void 0:N.adminIds)==null?void 0:K.includes(O.id))&&o.jsx("span",{className:"text-[10px] text-brand-400 ml-2 bg-brand-900/50 px-1 py-0.5 rounded",children:"Admin"})]}),o.jsx("span",{className:"text-xs text-slate-500",children:"Member"})]})]}),Te&&O.id!==(t==null?void 0:t.id)&&o.jsx("button",{onClick:()=>je(O.id,`@${O.handle}`),className:"text-slate-500 hover:text-red-400 p-2 transition",title:"Remove",children:o.jsx(vT,{className:"w-4 h-4"})})]},O.id)})})]})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto pt-24 pb-4 px-4 space-y-1 scrollbar-thin scrollbar-thumb-brand-800 scrollbar-track-slate-900",children:[i&&s.length===0&&o.jsx("div",{className:"text-center text-slate-500 text-sm py-4",children:"Loading conversation..."}),d&&!i&&o.jsx("div",{className:"text-center py-2",children:o.jsx("button",{onClick:u,className:"text-xs text-brand-400 hover:text-brand-300",children:"Load Older Messages"})}),s.map((O,K)=>{var B,Z,Q,M,se,q,ie,we;const te=O.senderId===(t==null?void 0:t.id),xe=s[K+1],Se=!xe||xe.senderId!==O.senderId;return o.jsxs("div",{className:`flex w-full ${te?"justify-end":"justify-start"} ${Se?"mb-4":"mb-1"}`,children:[!te&&o.jsxs("div",{className:`w-8 mr-2 flex-shrink-0 flex items-end ${!Se&&"invisible"}`,children:[o.jsx("img",{src:e.handle==="group"?((B=T[O.senderId])==null?void 0:B.avatarUrl)||"https://ui-avatars.com/api/?name=?":e.avatarUrl,className:"w-8 h-8 rounded-full border border-slate-700",alt:"",title:e.handle==="group"?(Z=T[O.senderId])!=null&&Z.handle?`@${(Q=T[O.senderId])==null?void 0:Q.handle}`:(M=v.find(pe=>pe.id===O.senderId))!=null&&M.handle?`@${(se=v.find(pe=>pe.id===O.senderId))==null?void 0:se.handle}`:"User":e.handle?`@${e.handle}`:"User"}),(e.handle==="group"?(q=T[O.senderId])==null?void 0:q.isInfluencer:e.isInfluencer)&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-[1px] border border-slate-900",children:o.jsx(en,{className:"w-2 h-2 text-black fill-current"})})]}),o.jsxs("div",{className:"flex flex-col max-w-[70%]",children:[o.jsxs("div",{className:`px-4 py-2.5 shadow-sm text-sm break-words relative group ${te?`bg-brand-600 text-white ${Se?"rounded-2xl rounded-tr-sm":"rounded-2xl border-r-2 border-brand-600"}`:`bg-slate-800 text-slate-200 ${Se?"rounded-2xl rounded-tl-sm":"rounded-2xl border-l-2 border-slate-800"}`}`,children:[o.jsx("p",{className:"leading-relaxed",children:O.text}),o.jsx("span",{className:"text-[9px] opacity-0 group-hover:opacity-100 transition-opacity absolute -bottom-5 right-0 text-slate-500 whitespace-nowrap px-1",children:S(O.timestamp)})]}),!te&&e.handle==="group"&&Se&&o.jsxs("span",{className:"text-[10px] text-slate-500 ml-1 mt-1",children:["@",((ie=T[O.senderId])==null?void 0:ie.handle)||((we=v.find(pe=>pe.id===O.senderId))==null?void 0:we.handle)||"User"]})]})]},O.id)}),o.jsx("div",{ref:y})]}),o.jsxs("div",{className:"p-3 bg-slate-900 border-t border-brand-800/50 backdrop-blur-sm z-10 relative",children:[de&&ue.length>0&&o.jsxs("div",{className:"absolute bottom-full left-4 mb-2 w-64 bg-slate-800 border border-slate-700 rounded-xl shadow-2xl overflow-hidden z-50",children:[o.jsx("div",{className:"p-2 bg-slate-900/50 text-[10px] text-slate-400 font-bold uppercase tracking-widest border-b border-slate-700/50",children:"Mention Member"}),ue.map(O=>o.jsxs("button",{onClick:()=>H(O.handle||"user"),className:"w-full text-left flex items-center gap-2 p-2 hover:bg-brand-900/50 transition",children:[o.jsx("img",{src:O.avatarUrl,className:"w-6 h-6 rounded-full",alt:""}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-bold text-slate-200",children:["@",O.handle]}),o.jsx("div",{className:"text-[10px] text-slate-500",children:"Member"})]})]},O.id))]}),o.jsxs("div",{className:"flex gap-2 items-center bg-slate-950 border border-slate-800 rounded-full px-2 pl-4 py-2 focus-within:border-brand-600/50 shadow-inner transition hover:border-slate-700",children:[o.jsx("input",{type:"text",value:m,onChange:J,onKeyDown:O=>{O.key==="Enter"&&P()},placeholder:`Message ${e.handle==="group"?e.displayName||"Group":`@${e.handle}`}...`,className:"flex-1 bg-transparent text-white placeholder-slate-600 focus:outline-none text-sm",disabled:a}),o.jsx("button",{onClick:P,disabled:!m.trim()||a,className:"bg-brand-600 text-white p-2 rounded-full hover:bg-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition transform active:scale-95 shadow-lg shadow-brand-600/20",children:a?o.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsx(dp,{className:"w-4 h-4 ml-0.5"})})]}),c&&o.jsx("div",{className:"text-red-500 text-xs mt-2 text-center break-all px-4",children:c.split(/(https?:\/\/[^\s]+)/g).map((O,K)=>O.match(/^https?:\/\//)?o.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-red-400 font-bold",children:"Create Index (Click Here)"},K):O)})]})]})},xM=[{title:"Respect the Vibe",description:"VibeMap is about positive energy. Harassment, hate speech, and bullying are strictly prohibited. Keep interactions respectful and inclusive."},{title:"Authenticity Matters",description:"Be yourself. Impersonation, fake profiles, and spamming compromise the trust of the community. We prioritize real connections."},{title:"Safety First",description:"Do not share private information (yours or others). Report any suspicious activity or content that makes you feel unsafe immediately."},{title:"Zero Tolerance",description:"We have a zero-tolerance policy for illegal activities, violence, or sexually explicit content. Such accounts will be banned permanently."},{title:"Vibe Check",description:"Our community thrives on trust. Users with low Trust Scores due to negative reports may face restricted access to features."}],yM=({onBack:t})=>{const[e,n]=A.useState(!1);return A.useEffect(()=>{window.scrollTo(0,0)},[]),o.jsxs("div",{className:"min-h-screen bg-slate-950 px-4 pt-4 pb-24 text-white animate-fade-in relative",children:[o.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6",children:[o.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[o.jsx(tn,{className:"w-8 h-8 text-brand-500"}),"Safety Center"]}),o.jsx("button",{onClick:t,className:"bg-slate-900 p-2 rounded-full text-slate-400 hover:text-white transition",children:o.jsx($e,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-brand-900 to-slate-900 border border-brand-800 p-6 rounded-2xl relative overflow-hidden",children:[o.jsxs("div",{className:"relative z-10",children:[o.jsx("h2",{className:"text-xl font-bold mb-2",children:"How VibeMap Keeps You Safe"}),o.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Your safety is our top priority. We use advanced AI and community-driven features to ensure VibeMap remains a secure space for authentic connections."})]}),o.jsx(tn,{className:"absolute -bottom-4 -right-4 w-32 h-32 text-brand-500/10 rotate-12"})]}),o.jsxs("div",{className:"grid gap-4",children:[o.jsx("div",{className:"bg-slate-900/50 border border-white/5 p-5 rounded-xl",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"bg-blue-500/20 p-3 rounded-full",children:o.jsx(Jb,{className:"w-6 h-6 text-blue-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-lg mb-1",children:"Vibe Trust Score"}),o.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:"Every user has a dynamic Trust Score based on verified interactions, endorsements, and community feedback. A high score means a trusted viber."})]})]})}),o.jsx("div",{className:"bg-slate-900/50 border border-white/5 p-5 rounded-xl",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"bg-purple-500/20 p-3 rounded-full",children:o.jsx(GT,{className:"w-6 h-6 text-purple-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-lg mb-1",children:"Privacy First"}),o.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:'You control who sees your location. Use "Ghost Mode" to go invisible or limit visibility to your "Inner Circle" only. Your data is encrypted and never sold.'})]})]})}),o.jsx("div",{className:"bg-slate-900/50 border border-white/5 p-5 rounded-xl",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"bg-emerald-500/20 p-3 rounded-full",children:o.jsx(ST,{className:"w-6 h-6 text-emerald-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-lg mb-1",children:"Proactive Monitoring"}),o.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:"Our AI monitors for suspicious activity and harassment. Toxic behavior is flagged instantly, and repeated offenders are banned to keep the vibe positive."})]})]})})]}),o.jsxs("section",{className:"pt-4 border-t border-white/10",children:[o.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[o.jsx(cp,{className:"w-5 h-5 text-brand-400"})," Community Guidelines"]}),o.jsx("div",{className:"space-y-3",children:xM.map((s,r)=>o.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-white/5",children:[o.jsx("h4",{className:"font-bold text-slate-200 mb-1",children:s.title}),o.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:s.description})]},r))})]})]}),o.jsx("button",{onClick:()=>n(!0),className:"fixed bottom-24 right-5 z-[60] bg-red-500 hover:bg-red-600 text-white p-4 rounded-full shadow-2xl shadow-red-500/30 transition-transform active:scale-95 animate-bounce-slow",children:o.jsx(tn,{className:"w-6 h-6"})}),e&&o.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center sm:items-center p-4 bg-slate-950/80 backdrop-blur-sm animate-fade-in",onClick:()=>n(!1),children:o.jsxs("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-sm rounded-[2rem] p-6 space-y-4 shadow-2xl animate-in slide-in-from-bottom-10 sm:slide-in-from-bottom-0 sm:zoom-in-95 mb-20 sm:mb-0",onClick:s=>s.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx(tn,{className:"w-6 h-6 text-red-500"}),"Emergency Options"]}),o.jsx("button",{onClick:()=>n(!1),className:"p-2 bg-slate-800 rounded-full text-slate-400 hover:text-white",children:o.jsx($e,{className:"w-5 h-5"})})]}),o.jsxs("button",{className:"w-full bg-red-500 hover:bg-red-600 p-4 rounded-2xl flex items-center gap-4 group transition",children:[o.jsx("div",{className:"bg-red-600 rounded-xl p-3 group-hover:scale-110 transition",children:o.jsx(rS,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-bold text-white",children:"Report Incident / Emergency"}),o.jsx("div",{className:"text-[10px] text-red-200 mt-0.5",children:"Call 112 if in immediate danger"})]})]}),o.jsxs("button",{className:"w-full bg-slate-800 hover:bg-slate-700 p-4 rounded-2xl flex items-center gap-4 group transition",children:[o.jsx("div",{className:"bg-slate-700 rounded-xl p-3 group-hover:scale-110 transition",children:o.jsx(Xi,{className:"w-6 h-6 text-brand-400"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-bold text-white",children:"Share Live Location"}),o.jsx("div",{className:"text-[10px] text-slate-400 mt-0.5",children:"Send location to trusted contacts"})]})]})]})})]})},vM=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!0);return A.useEffect(()=>{(async()=>{s(!0);try{const i=await nE();e(i)}catch(i){console.error("Failed to load hotspots",i)}finally{s(!1)}})()},[]),{hotspots:t,isLoading:n}},wM=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.business.food_and_drink",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.business.food_and_drink",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],bM=({onPlaceClick:t,onToggleFollow:e,followedPlaces:n=[]})=>{const{hotspots:s}=vM(),[r,i]=A.useState("list"),[a,c]=A.useState(null),u=A.useRef(null),d=A.useRef(null),f=A.useRef([]);A.useEffect(()=>{r==="map"&&u.current&&window.google&&m()},[r]);const m=()=>{if(!u.current)return;const p={lat:28.4595,lng:77.0266},y=new window.google.maps.Map(u.current,{center:p,zoom:12,styles:wM,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1});d.current=y,s.forEach(T=>{if(T.coordinates){const C=T.places.some(R=>R.trend==="up");let P="#3b82f6";C?P="#ef4444":T.places.length>3&&(P="#f97316");const b=new window.google.maps.Marker({position:T.coordinates,map:y,title:T.area,icon:{path:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fillColor:P,fillOpacity:1,strokeWeight:1,strokeColor:"#ffffff",scale:1.5,anchor:new window.google.maps.Point(12,22)},animation:window.google.maps.Animation.DROP});let E=!0,S=1.5;setInterval(()=>{if(E?(S+=.05,S>=1.8&&(E=!1)):(S-=.05,S<=1.5&&(E=!0)),b.getIcon()){const R=b.getIcon();R.scale=S,b.setIcon(R)}},100),b.addListener("click",()=>{c(T),y.panTo(T.coordinates),y.setZoom(14)}),f.current.push(b)}})};return o.jsxs("div",{className:"max-w-2xl mx-auto space-y-4 pb-24 pt-4 px-4 animate-fade-in h-screen flex flex-col box-border transform-none",children:[o.jsxs("div",{className:"flex items-center justify-between shrink-0",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent flex items-center gap-2",children:[o.jsx(el,{className:"w-8 h-8 text-orange-500"})," Vibe Radar"]}),o.jsx("p",{className:"text-slate-400 text-xs",children:"Live Heatmap & Trends"})]}),o.jsxs("div",{className:"flex bg-slate-900 border border-brand-800 rounded-lg p-1",children:[o.jsx("button",{onClick:()=>i("map"),className:`p-2 rounded-md transition ${r==="map"?"bg-brand-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:o.jsx(Ve,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>i("list"),className:`p-2 rounded-md transition ${r==="list"?"bg-brand-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:o.jsx(BT,{className:"w-5 h-5"})})]})]}),r==="map"?o.jsxs("div",{className:"flex-1 bg-slate-950 border border-brand-900 rounded-3xl relative overflow-hidden shadow-2xl shadow-brand-900/20 group h-full",children:[o.jsx("div",{ref:u,className:"w-full h-full"}),o.jsx("div",{className:"absolute top-4 left-4 right-4 z-10",children:o.jsxs("div",{className:"bg-slate-900/90 backdrop-blur border border-white/10 rounded-xl flex items-center p-3 shadow-lg",children:[o.jsx(ti,{className:"w-5 h-5 text-slate-400"}),o.jsx("input",{type:"text",placeholder:"Search areas or vibes...",className:"bg-transparent border-none text-white text-sm ml-2 w-full focus:ring-0 placeholder-slate-500"})]})}),a&&o.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-slate-900/95 backdrop-blur-xl border border-brand-500/30 p-4 rounded-2xl animate-fade-in-up z-20 max-h-[45%] overflow-y-auto shadow-2xl",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg text-white flex items-center gap-2",children:[o.jsx(Ve,{className:"w-5 h-5 text-orange-500"})," ",a.area]}),o.jsx("p",{className:"text-xs text-orange-400 font-medium",children:"High Traffic  Trending Up"})]}),o.jsx("button",{onClick:()=>c(null),className:"text-slate-400 hover:text-white bg-slate-800 p-2 rounded-full transition-colors",children:o.jsx($e,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"space-y-2",children:a.places.map((p,y)=>o.jsxs("div",{className:"flex items-center justify-between bg-black/40 p-2 rounded-lg border border-white/5 hover:border-brand-500/30 transition",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-6 h-6 rounded bg-slate-800 text-slate-400 flex items-center justify-center text-xs font-bold",children:y+1}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold text-slate-200",children:p.name}),o.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:p.category})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-xs font-bold text-brand-400 flex items-center gap-1 justify-end",children:[p.count," ",o.jsx(Xt,{className:"w-3 h-3"})]}),p.trend==="up"&&o.jsxs("span",{className:"text-[10px] text-green-400 flex items-center justify-end gap-0.5",children:[o.jsx(Xn,{className:"w-2 h-2"})," Rising"]})]})]},y))})]})]}):o.jsxs("div",{className:"bg-gradient-to-br from-brand-900 to-slate-900 border border-brand-700/50 rounded-2xl p-5 shadow-2xl relative overflow-hidden flex-1 overflow-y-auto",children:[o.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-5",children:o.jsx(el,{className:"w-64 h-64 text-brand-500"})}),o.jsx("div",{className:"space-y-8 relative z-10",children:s.map((p,y)=>o.jsxs("div",{className:"animate-fade-in",style:{animationDelay:`${y*100}ms`},children:[o.jsxs("div",{className:"flex items-center justify-between mb-3 border-b border-white/5 pb-2",children:[o.jsxs("h4",{className:"text-sm font-bold text-brand-300 uppercase tracking-widest flex items-center gap-2",children:[o.jsx(Ve,{className:"w-4 h-4"})," ",p.area]}),o.jsxs("span",{className:"text-xs text-slate-500",children:[p.places.length," places active"]})]}),o.jsx("div",{className:"grid gap-3",children:p.places.map((T,C)=>o.jsxs("div",{onClick:()=>t==null?void 0:t(T.name),className:"flex items-center justify-between bg-slate-950/40 p-3 rounded-xl border border-slate-800 hover:border-brand-500/50 transition group cursor-pointer hover:bg-brand-900/20",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-800 flex items-center justify-center text-xl font-bold text-slate-600 group-hover:text-white transition",children:C+1}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-bold text-base text-slate-200 group-hover:text-brand-400 transition flex items-center gap-2",children:[T.name,e&&o.jsx("div",{onClick:P=>P.stopPropagation(),children:o.jsx(To,{isFollowing:n.includes(T.name),onToggle:P=>{P.stopPropagation(),e(T.name)},size:"sm"})})]}),o.jsx("span",{className:"text-[10px] bg-slate-800 text-slate-400 px-2 py-0.5 rounded-full uppercase tracking-wider",children:T.category})]})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("span",{className:"text-lg font-bold text-white",children:T.count}),o.jsx("span",{className:"text-[10px] text-slate-500 uppercase",children:"Going"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[T.trend==="up"&&o.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-0.5",children:[o.jsx(Xn,{className:"w-3 h-3"})," Rising"]}),T.trend==="down"&&o.jsxs("span",{className:"text-xs text-red-400 flex items-center gap-0.5",children:[o.jsx(Xn,{className:"w-3 h-3 rotate-180"})," Quiet"]}),T.trend==="stable"&&o.jsx("span",{className:"text-xs text-slate-500 flex items-center gap-0.5",children:"Stable"})]})]})]},C))})]},y))})]})]})},Ig=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(!0);return A.useEffect(()=>{const r=tt(Pe(le,"posts"),Wr("visitDate","desc"),No(50)),i=ri(r,a=>{const c=a.docs.map(u=>({id:u.id,...u.data()}));e(c),s(!1)},a=>{console.error("Error fetching posts:",a),s(!1)});return()=>i()},[]),{posts:t,isLoading:n,setPosts:e}},_M=({placeName:t,onBack:e,onDropVibe:n,currentUser:s,onUserClick:r,isFollowed:i,onToggleFollow:a,onUpdateUser:c})=>{var I;const{posts:u}=Ig(),[d,f]=A.useState(!0),[m,p]=A.useState(null),[y,T]=A.useState(null),[C,P]=A.useState([]),[b,E]=A.useState(!1),[S,R]=A.useState(!1);A.useEffect(()=>{var ee;(ee=s==null?void 0:s.wishlist)!=null&&ee.includes(t)?R(!0):R(!1)},[s,t]);const L=async()=>{if(!s)return;const ee=s.wishlist||[],ne=ee.includes(t),Ne=ne?ee.filter(de=>de!==t):[...ee,t];c({wishlist:Ne}),R(!ne)},U=async()=>{const ee=`${window.location.origin}?place=${encodeURIComponent(t)}`,ne={title:(m==null?void 0:m.name)||t,text:`Check out ${(m==null?void 0:m.name)||t} on VibeMap!`,url:ee};try{if(navigator.share&&navigator.canShare&&navigator.canShare(ne))await navigator.share(ne);else throw new Error("Share API unavailable")}catch{try{await navigator.clipboard.writeText(ee),E(!0),setTimeout(()=>E(!1),2e3)}catch(de){console.error("Clipboard failed",de),alert("Could not share this page.")}}},N=()=>{const ee=(m==null?void 0:m.formatted_address)||t,ne=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(ee)}`;window.open(ne,"_blank")},x=async ee=>{if(ee.id){P(ne=>ne.map(Ne=>Ne.id===ee.id?{...Ne,...ee}:Ne));try{await vg(ee.id,ee)}catch(ne){console.error("Failed to update post:",ne)}}};if(A.useEffect(()=>{(async()=>{f(!0);try{const ne=u.filter($=>$.location.name.toLowerCase()===t.toLowerCase()||$.location.name.toLowerCase().includes(t.toLowerCase()));P(ne);const Ne=await X3(t,ne);T(Ne);const de=await Y3(t);p(de)}catch(ne){console.error("Error loading place:",ne)}finally{f(!1)}})()},[t,u]),d)return o.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:o.jsx("div",{className:"animate-spin text-brand-500",children:o.jsx(tl,{})})});const v=((I=m==null?void 0:m.photos)==null?void 0:I[0])||"https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&q=80",_=(m==null?void 0:m.rating)||4.5,k=(m==null?void 0:m.user_ratings_total)||120,j=(y==null?void 0:y.vibeScore)||85;return o.jsxs("div",{className:"min-h-screen bg-slate-950 pb-24 animate-fade-in relative",children:[o.jsxs("div",{className:"relative h-72 w-full",children:[o.jsx("img",{src:v,alt:t,className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),o.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-20",children:[o.jsx("button",{onClick:e,className:"bg-black/40 backdrop-blur p-2 rounded-full text-white hover:bg-black/60 transition",children:o.jsx(Mf,{className:"w-6 h-6"})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:L,className:`bg-black/40 backdrop-blur p-2 rounded-full transition hover:bg-black/60 ${S?"text-brand-400":"text-white"}`,children:o.jsx(hT,{className:`w-6 h-6 ${S?"fill-current":""}`})}),o.jsxs("button",{onClick:a,className:`px-4 py-2 rounded-full transition font-bold text-sm flex items-center gap-2
                                ${i?"bg-slate-800/80 text-white border border-slate-600":"bg-brand-600 text-white hover:bg-brand-500 shadow-brand-500/20"}
                            `,children:[o.jsx(up,{className:`w-4 h-4 ${i?"fill-white":""}`}),i?"Following":"Follow"]}),o.jsxs("button",{onClick:U,className:"bg-black/40 backdrop-blur p-2 rounded-full text-white hover:bg-black/60 transition relative group",children:[o.jsx(Xi,{className:"w-6 h-6"}),b&&o.jsx("span",{className:"absolute top-full mt-2 right-0 bg-brand-600 text-white text-[10px] font-bold px-2 py-1 rounded shadow-lg whitespace-nowrap animate-fade-in-up",children:"Link Copied!"})]})]})]}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 z-20",children:o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-black text-white mb-2 leading-none tracking-tight",children:(m==null?void 0:m.name)||t}),o.jsxs("div",{className:"flex items-center gap-2 text-slate-300 text-sm",children:[o.jsx(Ve,{className:"w-4 h-4 text-brand-400"}),o.jsx("span",{children:(m==null?void 0:m.formatted_address)||"Location details unavailable"})]})]}),o.jsx("div",{className:"flex flex-col items-end gap-1",children:o.jsxs("div",{className:"flex items-center gap-1 bg-white/10 backdrop-blur px-2 py-1 rounded-lg border border-white/20",children:[o.jsx("span",{className:"text-amber-400 fill-amber-400",children:o.jsx(Zb,{className:"w-4 h-4 fill-amber-400"})}),o.jsx("span",{className:"font-bold text-white",children:_}),o.jsxs("span",{className:"text-xs text-slate-400",children:["(",k,")"]})]})})]})})]}),o.jsxs("div",{className:"px-4 py-6 space-y-6 max-w-4xl mx-auto",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-slate-900/50 border border-brand-800/30 rounded-2xl p-4 flex flex-col justify-between relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-brand-500/5 group-hover:bg-brand-500/10 transition"}),o.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[o.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Vibe Score"}),o.jsx(Xn,{className:"w-5 h-5 text-green-400"})]}),o.jsxs("div",{className:"relative z-10",children:[o.jsx("div",{className:"text-3xl font-black text-white",children:j}),o.jsx("div",{className:"text-xs text-green-400 font-medium",children:"Top 5% in City"})]})]}),o.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-2xl p-4 flex flex-col justify-between relative overflow-hidden",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Live Now"}),o.jsx(Xt,{className:"w-5 h-5 text-brand-400"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-black text-white",children:(y==null?void 0:y.liveCount)||0}),o.jsx("div",{className:"text-xs text-slate-400 font-medium",children:"Vibers checked in"})]})]})]}),o.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-5",children:[o.jsxs("h3",{className:"text-sm font-bold text-white mb-4 flex items-center gap-2",children:[o.jsx(Ca,{className:"w-4 h-4 text-brand-400"})," Vibe Timeline"]}),o.jsx("div",{className:"h-24 flex items-end gap-1",children:Array.from({length:24}).map((ee,ne)=>{var $;const Ne=(($=y==null?void 0:y.busyTimes)==null?void 0:$[ne])||Math.random()*20+5,de=new Date().getHours()===ne;return o.jsxs("div",{className:"flex-1 flex flex-col justify-end group relative",children:[o.jsx("div",{className:`w-full rounded-t-sm transition-all duration-500 ${de?"bg-brand-500 shadow-[0_0_10px_rgba(236,72,153,0.5)]":"bg-slate-800 group-hover:bg-slate-700"}`,style:{height:`${Math.min(Ne*3,100)}%`}}),de&&o.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-[9px] font-bold bg-brand-600 px-1.5 py-0.5 rounded text-white whitespace-nowrap z-10",children:"NOW"})]},ne)})}),o.jsxs("div",{className:"flex justify-between text-[10px] text-slate-500 mt-2 font-mono uppercase",children:[o.jsx("span",{children:"6 AM"}),o.jsx("span",{children:"12 PM"}),o.jsx("span",{children:"6 PM"}),o.jsx("span",{children:"12 AM"})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:n,className:"flex-1 py-3.5 bg-brand-600 hover:bg-brand-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition shadow-lg shadow-brand-900/40",children:[o.jsx(pr,{className:"w-5 h-5"})," Drop Vibe Check"]}),o.jsxs("button",{onClick:N,className:"flex-1 py-3.5 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition border border-slate-700",children:[o.jsx(tl,{className:"w-5 h-5"})," Get Directions"]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Community Vibes"}),C.length>0?o.jsx("div",{className:"space-y-4",children:C.map(ee=>o.jsx(wg,{post:ee,onUpdatePost:x,onUserClick:r,isPlaceFollowed:i,onToggleFollow:a,currentUser:s},ee.id))}):o.jsxs("div",{className:"text-center py-10 text-slate-500 bg-slate-900/30 rounded-2xl border border-dashed border-slate-800",children:[o.jsx("p",{children:"No vibes recorded yet."}),o.jsx("button",{onClick:n,className:"text-brand-400 font-bold mt-2 hover:underline",children:"Be the first!"})]})]})]})]})},NM=({onNavigate:t})=>{const[e,n]=A.useState("history"),[s,r]=A.useState("places"),[i,a]=A.useState(!1),[c,u]=A.useState(!1),{posts:d}=Ig(),f=Ye.currentUser,m=A.useMemo(()=>{if(!f)return[];const p=(f==null?void 0:f.uid)||"currentUser",y=[];return d.forEach(T=>{T.user.id===p&&y.push({id:`post-${T.id}`,type:"post",place:T.location.name,time:new Date(T.visitDate).toLocaleDateString(),description:`Posted a vibe: ${T.description.substring(0,20)}...`,points:"+50"});const C=T.rsvps[p];C&&(C===Ue.WILL_JOIN||C===Ue.INTERESTED)&&y.push({id:`rsvp-${T.id}`,type:"event",place:T.location.name,time:new Date(T.visitDate).toLocaleDateString(),description:`RSVP'd: ${C}`,points:"+20"}),T.comments.forEach(P=>{P.userId===p&&y.push({id:`comment-${P.id}`,type:"comment",place:T.location.name,time:new Date(P.timestamp).toLocaleDateString(),description:`Commented: "${P.text}"`,points:"+10"})})}),y.reverse()},[d,f]);return o.jsxs("div",{className:"pb-24 pt-4 px-4 min-h-screen relative",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[o.jsx(yu,{className:"text-brand-400"})," Activity"]}),o.jsx("p",{className:"text-slate-400 text-xs",children:"Your vibe footprint & radar."})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>u(!c),className:`px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1.5 transition ${c?"bg-indigo-500/20 text-indigo-300 border border-indigo-500/50":"bg-slate-800 text-slate-400 border border-slate-700"}`,children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M9 10h.01"}),o.jsx("path",{d:"M15 10h.01"}),o.jsx("path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"})]}),"Ghost Mode: ",c?"ON":"OFF"]}),o.jsxs("button",{onClick:()=>a(!0),className:"bg-red-500/10 text-red-400 border border-red-500/50 px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1 hover:bg-red-500/20 transition",children:[o.jsx(tn,{className:"w-3 h-3"})," Safety"]})]})]}),o.jsxs("div",{className:"flex p-1 bg-slate-900/50 rounded-xl mb-6 border border-white/5",children:[o.jsx("button",{onClick:()=>n("history"),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${e==="history"?"bg-brand-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Your Activity"}),o.jsxs("button",{onClick:()=>n("radar"),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${e==="radar"?"bg-brand-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:["Your Visits ",o.jsx("span",{className:"ml-1 bg-red-500 text-white text-[9px] px-1.5 rounded-full",children:"2"})]})]}),o.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e==="history"&&o.jsx(o.Fragment,{children:m.length===0?o.jsx("div",{className:"text-center py-10 text-slate-500 italic",children:"No activity yet. Start vibing!"}):m.map(p=>o.jsxs("div",{className:"bg-slate-900/40 border border-white/5 p-4 rounded-2xl flex items-center gap-4",children:[o.jsxs("div",{className:"w-10 h-10 rounded-full bg-brand-500/10 flex items-center justify-center border border-brand-500/20 text-brand-400",children:[p.type==="post"&&o.jsx(Ve,{className:"w-5 h-5"}),p.type==="event"&&o.jsx(Yi,{className:"w-5 h-5"}),p.type==="comment"&&o.jsx(mr,{className:"w-5 h-5"})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"text-white font-bold text-sm",children:p.place}),o.jsxs("p",{className:"text-xs text-slate-500 capitalize",children:[p.time,"  ",p.description]})]}),o.jsx("span",{className:"text-xs font-bold text-green-400 bg-green-500/10 px-2 py-1 rounded-full",children:p.points})]},p.id))}),e==="radar"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4 bg-slate-800/50 p-1.5 rounded-lg w-fit",children:[o.jsxs("button",{onClick:()=>r("places"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all flex items-center gap-2 ${s==="places"?"bg-brand-500 text-white shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(Ve,{className:"w-3 h-3"})," Places"]}),o.jsxs("button",{onClick:()=>r("users"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all flex items-center gap-2 ${s==="users"?"bg-brand-500 text-white shadow":"text-slate-400 hover:text-white"}`,children:[o.jsx(Xt,{className:"w-3 h-3"})," Users"]})]}),s==="places"&&o.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/20 p-4 rounded-2xl mb-4",children:[o.jsxs("h3",{className:"text-sm font-bold text-brand-200 mb-1 flex items-center gap-2",children:[o.jsx(tl,{className:"w-4 h-4"})," Visited Places"]}),o.jsx("p",{className:"text-slate-500 text-xs mt-2 italic",children:"No visited places recorded yet."})]}),s==="users"&&o.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/20 p-4 rounded-2xl mb-4",children:[o.jsxs("h3",{className:"text-sm font-bold text-brand-200 mb-1 flex items-center gap-2",children:[o.jsx(tl,{className:"w-4 h-4"})," Cross-Paths"]}),o.jsx("p",{className:"text-slate-500 text-xs mt-2 italic",children:"Radar is scanning... no run-ins detected."})]})]})]}),o.jsxs("button",{onClick:()=>a(!0),className:"fixed bottom-24 right-4 bg-red-600 hover:bg-red-500 text-white p-3 rounded-full shadow-lg shadow-red-600/30 z-40 transition-transform hover:scale-105 active:scale-95 flex items-center gap-2 pr-4",children:[o.jsx("div",{className:"bg-white/20 p-1.5 rounded-full",children:o.jsx(fo,{className:"w-4 h-4"})}),o.jsx("span",{className:"text-xs font-bold",children:"Safety"})]}),i&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:o.jsxs("div",{className:"bg-brand-900 border border-brand-800 rounded-2xl w-full max-w-sm p-6 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors p-2 bg-black/10 rounded-full",children:o.jsx($e,{className:"w-6 h-6"})}),o.jsxs("div",{className:"flex flex-col items-center mb-6",children:[o.jsx("div",{className:"bg-red-500/20 p-3 rounded-full mb-3",children:o.jsx(tn,{className:"w-8 h-8 text-red-500"})}),o.jsx("h2",{className:"text-xl font-bold text-white",children:"Safety Center"}),o.jsx("p",{className:"text-slate-400 text-center text-sm mt-1",children:"How can we help you right now?"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{className:"w-full bg-red-600 hover:bg-red-500 text-white p-3 rounded-xl font-bold flex items-center justify-center gap-2 transition",children:[o.jsx(fo,{className:"w-5 h-5"})," Emergency (SOS)"]}),o.jsxs("button",{className:"w-full bg-slate-800 hover:bg-slate-700 text-white p-3 rounded-xl font-medium flex items-center justify-center gap-2 transition",children:[o.jsx(tn,{className:"w-5 h-5"})," Report a User"]}),o.jsxs("button",{className:"w-full bg-slate-800 hover:bg-slate-700 text-white p-3 rounded-xl font-medium flex items-center justify-center gap-2 transition",children:[o.jsx(yu,{className:"w-5 h-5"})," Share Location"]}),o.jsxs("button",{onClick:()=>t==null?void 0:t("safety"),className:"w-full bg-brand-900/50 hover:bg-brand-900 text-brand-300 p-3 rounded-xl font-medium flex items-center justify-center gap-2 transition border border-brand-800",children:[o.jsx(FT,{className:"w-5 h-5"})," How VibeMap Keeps You Safe"]})]}),o.jsx("p",{className:"text-[10px] text-slate-500 text-center mt-6",children:"VibeMap prioritizes your safety. All reports are anonymous and reviewed instantly."})]})})]})},EM=({isOpen:t,onClose:e,notifications:n,onMarkAllRead:s,onNotificationClick:r})=>{if(!t)return null;const i=c=>{const[u,d,f]=c.split(":");if(u==="undo-comment-delete"&&d&&f){const m=new URL(window.location.href);m.searchParams.set("undo",c),window.history.pushState({},"",m.toString()),e()}},a=c=>{switch(c){case"system":return o.jsx(ka,{className:"w-4 h-4 text-slate-400"});case"like":return o.jsx(up,{className:"w-4 h-4 text-pink-500 fill-pink-500"});case"comment":return o.jsx(mr,{className:"w-4 h-4 text-blue-400"});case"follow":return o.jsx(e_,{className:"w-4 h-4 text-green-400"});case"rsvp":return o.jsx(Yi,{className:"w-4 h-4 text-amber-400"});default:return o.jsx(ka,{className:"w-4 h-4 text-slate-400"})}};return o.jsxs("div",{className:"absolute top-16 right-4 md:right-8 w-80 md:w-96 bg-brand-900 border border-brand-800 rounded-2xl shadow-2xl z-50 animate-fade-in overflow-hidden flex flex-col max-h-[80vh]",children:[o.jsxs("div",{className:"p-4 border-b border-brand-800 flex justify-between items-center bg-brand-900/95 backdrop-blur sticky top-0 z-10",children:[o.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:["Notifications",n.some(c=>!c.read)&&o.jsxs("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:[n.filter(c=>!c.read).length," new"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:s,className:"p-1.5 text-slate-400 hover:text-brand-400 hover:bg-white/5 rounded-lg transition",title:"Mark all read",children:o.jsx(Ao,{className:"w-4 h-4"})}),o.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition",children:o.jsx($e,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"overflow-y-auto flex-1 p-2 space-y-1 scrollbar-thin scrollbar-thumb-brand-700",children:n.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500 gap-3",children:[o.jsx(ka,{className:"w-8 h-8 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):n.map(c=>{var u;return o.jsxs("div",{onClick:()=>{var d;(d=c.targetId)!=null&&d.startsWith("undo-comment-delete:")||r(c)},className:`flex gap-3 p-3 rounded-xl cursor-pointer transition relative group ${c.read?"hover:bg-white/5":"bg-brand-800/30 hover:bg-brand-800/50"}`,children:[!c.read&&o.jsx("div",{className:"absolute left-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-brand-500 rounded-full"}),o.jsx("img",{src:c.senderAvatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${c.senderId}`,alt:"",className:"w-10 h-10 rounded-full border border-slate-700 mt-1 shrink-0 bg-slate-800"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("p",{className:"text-sm text-slate-200 line-clamp-2 leading-snug",children:[o.jsx("span",{className:"font-bold text-white mr-1",children:c.senderName}),c.message]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[a(c.type),((u=c.targetId)==null?void 0:u.startsWith("undo-comment-delete:"))&&o.jsx("button",{onClick:d=>{d.stopPropagation(),i(c.targetId)},className:"text-xs font-bold text-brand-400 hover:underline border-r border-slate-700 pr-2 mr-1",children:"Undo"}),o.jsx("span",{className:"text-[10px] text-slate-500",children:ci(new Date(c.createdAt),{addSuffix:!0})})]})]})]},c.id)})})]})};function IM(){const[t,e]=A.useState(null),[n,s]=A.useState("feed"),[r,i]=A.useState(!1),[a,c]=A.useState(""),[u,d]=A.useState(null),[f,m]=A.useState(null),[p,y]=A.useState(""),[T,C]=A.useState(null),[P,b]=A.useState(null),[E,S]=A.useState(!1),[R,L]=A.useState(!0),{posts:U,setPosts:N}=Ig(),x=async O=>{if(O.id){N(K=>K.map(te=>te.id===O.id?{...te,...O}:te));try{await vg(O.id,O)}catch(K){console.error("Failed to update post:",K)}}},v=async O=>{if(window.confirm("Delete this post?")){N(K=>K.filter(te=>te.id!==O));try{await O3(O)}catch(K){console.error("Failed to delete post:",K)}}};A.useEffect(()=>{let O;return(async()=>{try{const xe=(await O5(Ye)).user.uid;console.log("Auth: Signed in as",xe);const Se={id:xe,displayName:"Guest Vibe",handle:`user_${xe.substring(0,5).toLowerCase()}`,avatarUrl:"https://images.unsplash.com/photo-1511367461989-f85a21fda167?auto=format&fit=crop&w=150&q=80",isConnected:!0,isInfluencer:!1,followersCount:0,following:[],followedPlaces:[],wishlist:[],frequentPlaces:[],bio:"Ready to explore the vibe.",trustScore:10},B=He(le,"users",xe);O=ri(B,Z=>{if(Z.exists()){const Q={id:xe,...Z.data()};console.log("Firestore update received:",Q),e(Q)}else console.log("Creating new user profile for",xe),Eo(B,Se).catch(Q=>console.error("Create failed",Q)),e(Se);L(!1),i(!1)},Z=>{console.error("Firestore sync error:",Z),e(Se),L(!1)})}catch(te){console.error("Auth initialization failed:",te),e({id:"guest_fallback",displayName:"Guest Vibe",handle:"guest_user",avatarUrl:"https://images.unsplash.com/photo-1511367461989-f85a21fda167?auto=format&fit=crop&w=150&q=80",isConnected:!0,follows:[],followers:[],following:[],followedPlaces:[],wishlist:[],frequentPlaces:[],trustScore:0}),L(!1)}})(),()=>{O&&O()}},[]);const[_,k]=A.useState([]),[j,I]=A.useState(!1),[ee,ne]=A.useState(0);A.useEffect(()=>{if(!t){k([]),ne(0);return}const O=q3(t.id,xe=>{k(xe)}),K=tt(Pe(le,"conversations"),dt("participants","array-contains",t.id),No(50)),te=ri(K,xe=>{let Se=0;xe.docs.forEach(B=>{var M;const Q=((M=B.data().unreadCount)==null?void 0:M[t.id])||0;Se+=Q}),ne(Se)});return()=>{O(),te()}},[t==null?void 0:t.id]),A.useEffect(()=>{const K=new URLSearchParams(window.location.search).get("place");K&&(m(K),s("place"))},[]);const Ne=async()=>{await B5(Ye),e(null),s("feed")},de=O=>{O==="profile"&&d(null),s(O)},$=O=>{m(O),s("place")},J=O=>{t&&O.id===t.id?d(null):d(O),s("profile")},H=O=>{b(n),C(O),s("chat")},ue=async O=>{if(!t)return;const K=t.following||[],te=K.includes(O),xe=te?K.filter(Z=>Z!==O):[...K,O],Se={...t,following:xe};Te(Se);const B=He(le,"users",O);try{if(te?(await hn(B,{followers:cm(t.id)}),Hc(O,t.id,"follow")):(await hn(B,{followers:ng(t.id)}),ya(O,t.id,"follow","started following you")),u&&u.id===O){const Z=u.followers||[],Q=te?Z.filter(M=>M!==t.id):[...Z,t.id];d({...u,followers:Q})}}catch(Z){console.error("Failed to update follow status:",Z),alert(`Follow action failed: ${Z.message}`)}},me=O=>{if(!t)return;const K=t.followedPlaces||[],te=K.includes(O)?K.filter(xe=>xe!==O):[...K,O];Te({...t,followedPlaces:te})},je=O=>{y(O||""),S(!0)},Te=async O=>{if(!t)return;const K={...t,...O};e(K);try{await Eo(He(le,"users",t.id),K,{merge:!0})}catch(te){console.error("Failed to update user:",te)}},ae=()=>{var O;switch(n){case"chat":return T?o.jsx(gM,{currentUser:t,recipient:T,onBack:()=>{P&&P!=="chat"?(s(P),b(null)):C(null)}}):o.jsx(mM,{currentUser:t,onSelectConversation:xe=>{b("chat"),C(xe)}});case"search":return o.jsx(lM,{initialQuery:a,followingIds:new Set((t==null?void 0:t.following)||[]),onToggleFollow:ue,posts:U,currentUser:t});case"profile":const K=u||t,te=U.filter(xe=>xe.user.id===K.id);return o.jsx(aM,{user:K,currentUser:t,onUpdateUser:Te,posts:te,onMessage:()=>H(K),onNavigate:de,onToggleFollow:()=>ue(K.id),onUpdatePost:x});case"hotspots":return o.jsx(bM,{onPlaceClick:$,onToggleFollow:me,followedPlaces:t==null?void 0:t.followedPlaces});case"origin-roots":return o.jsx(sE,{onBack:async()=>{if(t!=null&&t.isNewUser)try{await hn(He(le,"users",t.id),{isNewUser:!1})}catch(xe){console.error("Failed to clear new user flag",xe)}de("feed")}});case"place":return f?o.jsx(_M,{placeName:f,onBack:()=>de("feed"),onDropVibe:()=>je(f),currentUser:t,onUserClick:J,isFollowed:((O=t==null?void 0:t.followedPlaces)==null?void 0:O.includes(f))||!1,onToggleFollow:()=>me(f),onUpdateUser:Te}):o.jsx(jv,{onPlaceClick:$,onUserClick:J,currentUser:t,followedPlaces:(t==null?void 0:t.followedPlaces)||[],followingUsers:(t==null?void 0:t.following)||[],onTogglePlaceFollow:me,onToggleUserFollow:ue,posts:U,onUpdatePost:x,onDeletePost:v,initialTab:!(t!=null&&t.following)||t.following.length===0?"trend":"inner-circle"});case"activity":return o.jsx(NM,{onNavigate:de});case"safety":return o.jsx(yM,{onBack:()=>de("profile")});case"feed":default:return o.jsx(jv,{onPlaceClick:$,onUserClick:J,currentUser:t,followedPlaces:(t==null?void 0:t.followedPlaces)||[],followingUsers:(t==null?void 0:t.following)||[],onTogglePlaceFollow:me,onToggleUserFollow:ue,posts:U,onUpdatePost:x,onDeletePost:v,initialTab:!(t!=null&&t.following)||t.following.length===0?"trend":"inner-circle"})}};return R?o.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-950 text-brand-500",children:o.jsx(jo,{className:"w-8 h-8 animate-spin"})}):!t&&!r?o.jsx(Av,{onComplete:O=>e(O)}):r?o.jsx(Av,{onComplete:O=>{e(O),i(!1),s("origin-roots")}}):o.jsx("div",{className:"bg-slate-950 min-h-screen",children:o.jsxs(F3,{user:t,onLogout:Ne,onDropVibe:()=>je(),isDropVibeOpen:E,setIsDropVibeOpen:S,onNavigate:de,currentPage:n,initialLocation:p,notifications:_,onOpenNotifications:()=>I(!0),unreadMessageCount:ee,children:[ae(),o.jsx(EM,{isOpen:j,onClose:()=>I(!1),notifications:_,onMarkAllRead:()=>G3((t==null?void 0:t.id)||"",_),onNotificationClick:O=>{H3(O.id),I(!1),O.type==="comment"||O.type==="like"||O.type==="rsvp"?s("feed"):O.type==="follow"&&s("profile")}})]})})}const oE=document.getElementById("root");if(!oE)throw new Error("Could not find root element to mount to");const TM=$h.createRoot(oE);TM.render(o.jsx(ml.StrictMode,{children:o.jsx(IM,{})}));
